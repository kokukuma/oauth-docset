<!DOCTYPE html>
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html --><html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<title>
  
    draft-fett-oauth-dpop-04
  
</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>
<!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.38.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.38.0/respond/dest/respond.min.js"></script>
    <![endif]-->
<link href="/feed/document-changes/draft-fett-oauth-dpop/" rel="alternate" title="Document changes" type="application/atom+xml"/>
<meta content="OAuth 2.0 Demonstration of Proof-of-Possession at the Application Layer (DPoP) (Internet-Draft, 2020)" name="description"/>
<script src="https://www.ietf.org/lib/dt/7.38.0/d3/d3.min.js"></script>
<script src="https://www.ietf.org/lib/dt/7.38.0/jquery/jquery.min.js"></script>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/ietf-icon-blue3.png" rel="shortcut icon"/>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/apple-touch-icon.png" rel="apple-touch-icon"/>
</head>
<body style="padding-top: 0;">
<div class="content" id="content">
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
<div class="rfcmarkup">
<div class="noprint" style="height: 6px;">
<div class="meta-info bgred" onclick="showLegend();" onmouseout="hideLegend()" onmouseover="this.style.cursor='pointer';" style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; " title="Click for colour legend."> </div>
<div class="meta-info noprint pre legend" id="legend" onmouseout="hideLegend();" onmouseover="showLegend();" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
</div>
</div>
<div class="noprint">
<pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.ietf.org/archive/id/draft-fett-oauth-dpop-04.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.ietf.org/archive/id/draft-fett-oauth-dpop-04.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.ietf.org/archive/id/draft-fett-oauth-dpop-04.xml" title="XML source for this document">xml</a>|<a href="https://tools.ietf.org/pdf/draft-fett-oauth-dpop-04.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/draft-fett-oauth-dpop/04/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/draft-fett-oauth-dpop/" title="Datatracker information for this document">Tracker</a>] [<a href="mailto:draft-fett-oauth-dpop@ietf.org?subject=draft-fett-oauth-dpop" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=draft-fett-oauth-dpop-04.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-fett-oauth-dpop-04.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-fett-oauth-dpop-04.txt" title="Run an idnits check of this document">Nits</a>]

Versions: <a href="/doc/html/draft-fett-oauth-dpop-00">00</a> <a href="/doc/html/draft-fett-oauth-dpop-01">01</a> <a href="/doc/html/draft-fett-oauth-dpop-02">02</a> <a href="/doc/html/draft-fett-oauth-dpop-03">03</a> <a href="/doc/html/draft-fett-oauth-dpop-04"><b>04</b></a> <a href="/doc/html/draft-ietf-oauth-dpop">draft-ietf-oauth-dpop</a>                          </pre>
</div>
<div class="draftcontent">
<pre>Web Authorization Protocol                                       D. Fett
Internet-Draft                                                   yes.com
Intended status: Standards Track                             B. Campbell
Expires: 5 September 2020                                  Ping Identity
                                                              J. Bradley
                                                                  Yubico
                                                          T. Lodderstedt
                                                                 yes.com
                                                                M. Jones
                                                               Microsoft
                                                                D. Waite
                                                           Ping Identity
                                                            4 March 2020


OAuth 2.0 Demonstration of Proof-of-Possession at the Application Layer
                                 (DPoP)
                        <a href="/doc/html/draft-fett-oauth-dpop-04">draft-fett-oauth-dpop-04</a>

Abstract

   This document describes a mechanism for sender-constraining OAuth 2.0
   tokens via a proof-of-possession mechanism on the application level.
   This mechanism allows for the detection of replay attacks with access
   and refresh tokens.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="/doc/html/bcp78">BCP 78</a> and <a href="/doc/html/bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 5 September 2020.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.




<span class="grey">Fett, et al.            Expires 5 September 2020                [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/</a>
   <a href="https://trustee.ietf.org/license-info">license-info</a>) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Simplified BSD License text
   as described in Section 4.e of the <a href="https://trustee.ietf.org/license-info">Trust Legal Provisions</a> and are
   provided without warranty as described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
     <a href="#section-1.1">1.1</a>.  Conventions and Terminology . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Main Objective  . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Concept . . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-4">4</a>.  DPoP Proof JWTs . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-4.1">4.1</a>.  Syntax  . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-4.2">4.2</a>.  Checking DPoP Proofs  . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-5">5</a>.  Token Request (Binding Tokens to a Public Key)  . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  Resource Access (Proof of Possession for Access Tokens) . . .   <a href="#page-8">8</a>
   <a href="#section-7">7</a>.  Public Key Confirmation . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-8">8</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-9">9</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-9.1">9.1</a>.  DPoP Proof Replay . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-9.2">9.2</a>.  Signed JWT Swapping . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-9.3">9.3</a>.  Signature Algorithms  . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-9.4">9.4</a>.  Message Integrity . . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-10">10</a>. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-10.1">10.1</a>.  OAuth Access Token Type Registration . . . . . . . . . .  <a href="#page-11">11</a>
     10.2.  JSON Web Signature and Encryption Type Values
            Registration . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#section-11">11</a>. Normative References  . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#section-12">12</a>. Informative References  . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#appendix-A">Appendix A</a>.  Document History . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.%20%20Introduction"></a></body></html><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   [<a id="ref-RFC8705">RFC8705</a>] describes methods to bind (sender-constrain) access tokens
   using mutual Transport Layer Security (TLS) authentication with X.509
   certificates.

   [<a id="ref-I-D.ietf-oauth-token-binding">I-D.ietf-oauth-token-binding</a>] provides mechanisms to sender-
   constrain access tokens using HTTP token binding.

   Due to a sub-par user experience of TLS client authentication in user
   agents and a lack of support for HTTP token binding, neither




<span class="grey">Fett, et al.            Expires 5 September 2020                [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   mechanism can be used if an OAuth client is a Single Page Application
   (SPA) running in a web browser.

   This document outlines an application-level sender-constraining for
   access and refresh tokens that can be used in cases where neither
   mTLS nor OAuth Token Binding are available.  It uses proof-of-
   possession based on a public/private key pair and application-level
   signing.

   DPoP can be used with public clients and, in case of confidential
   clients, can be combined with any client authentication method.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.1.%20%20Conventions%20and%20Terminology"></a></body></html><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Conventions and Terminology</span>

   The key words "<em>MUST</em>", "<em>MUST NOT</em>", "<em>REQUIRED</em>", "<em>SHALL</em>", "<em>SHALL NOT</em>",
   "<em>SHOULD</em>", "<em>SHOULD NOT</em>", "<em>RECOMMENDED</em>", "NOT <em>RECOMMENDED</em>", "<em>MAY</em>", and
   "<em>OPTIONAL</em>" in this document are to be interpreted as described in <a href="/doc/html/bcp14">BCP</a>
   <a href="/doc/html/bcp14">14</a> [<a href="/doc/html/rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="/doc/html/rfc8174" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

   This specification uses the terms "access token", "refresh token",
   "authorization server", "resource server", "authorization endpoint",
   "authorization request", "authorization response", "token endpoint",
   "grant type", "access token request", "access token response", and
   "client" defined by The OAuth 2.0 Authorization Framework [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>].

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.%20%20Main%20Objective"></a></body></html><a class="selflink" href="#section-2" id="section-2">2</a>.  Main Objective</span>

   Under the attacker model defined in [<a href="#ref-I-D.ietf-oauth-security-topics">I-D.ietf-oauth-security-topics</a>],
   the mechanism defined by this specification aims to prevent token
   replay at a different endpoint.

   More precisely, if an adversary is able to get hold of an access
   token or refresh token because it set up a counterfeit authorization
   server or resource server, the adversary is not able to replay the
   respective token at another authorization or resource server.

   Secondary objectives are discussed in <a href="#section-9">Section 9</a>.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.%20%20Concept"></a></body></html><a class="selflink" href="#section-3" id="section-3">3</a>.  Concept</span>

   The main data structure introduced by this specification is a DPoP
   proof JWT, described in detail below.  A client uses a DPoP proof JWT
   to prove the possession of a private key belonging to a certain
   public key.  Roughly speaking, a DPoP proof is a signature over some
   data of the HTTP request to which it is attached to and a timestamp.





<span class="grey">Fett, et al.            Expires 5 September 2020                [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   +--------+                                          +---------------+
   |        |--(A)-- Token Request -------------------&gt;|               |
   | Client |        (DPoP Proof)                      | Authorization |
   |        |                                          |     Server    |
   |        |&lt;-(B)-- DPoP-bound Access Token ----------|               |
   |        |        (token_type=DPoP)                 +---------------+
   |        |        PoP Refresh Token for public clients
   |        |
   |        |                                          +---------------+
   |        |--(C)-- DPoP-bound Access Token ---------&gt;|               |
   |        |        (DPoP Proof)                      |    Resource   |
   |        |                                          |     Server    |
   |        |&lt;-(D)-- Protected Resource ---------------|               |
   |        |                                          +---------------+
   +--------+

                                  Figure 1

   Figure 1: Basic DPoP Flow

   The basic steps of an OAuth flow with DPoP are shown in Figure 1:

   *  (A) In the Token Request, the client sends an authorization code
      to the authorization server in order to obtain an access token
      (and potentially a refresh token).  The client attaches a DPoP
      proof to the request in an HTTP header.

   *  (B) The AS binds (sender-constrains) the access token to the
      public key claimed by the client in the DPoP proof; that is, the
      access token cannot be used without proving possession of the
      respective private key.  This is signaled to the client by using
      the "token_type" value "DPoP".

   *  If a refresh token is issued to a public client, it is sender-
      constrained in the same way.  For confidential clients, refresh
      tokens are bound to the "client_id", which is more flexible than
      binding it to a particular public key.

   *  (C) If the client wants to use the access token, it has to prove
      possession of the private key by, again, adding a header to the
      request that carries the DPoP proof.  The resource server needs to
      receive information about the public key to which the access token
      is bound.  This information is either encoded directly into the
      access token (for JWT structured access tokens), or provided at
      the token introspection endpoint of the authorization server (not
      shown).





<span class="grey">Fett, et al.            Expires 5 September 2020                [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   *  (D) The resource server refuses to serve the request if the
      signature check fails or the data in the DPoP proof is wrong,
      e.g., the request URI does not match the URI claim in the DPoP
      proof JWT.

   *  When a refresh token that is sender-constrained using DPoP is used
      by the client, the client has to provide a DPoP proof just as in
      the case of a resource access.  The new access token will be bound
      to the same public key.

   The mechanism presented herein is not a client authentication method.
   In fact, a primary use case is public clients (single page
   applications) that do not use client authentication.  Nonetheless,
   DPoP is designed such that it is compatible with "private_key_jwt"
   and all other client authentication methods.

   DPoP does not directly ensure message integrity but relies on the TLS
   layer for that purpose.  See <a href="#section-9">Section 9</a> for details.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.%20%20DPoP%20Proof%20JWTs"></a></body></html><a class="selflink" href="#section-4" id="section-4">4</a>.  DPoP Proof JWTs</span>

   DPoP uses so-called DPoP proof JWTs for binding public keys and
   proving knowledge about private keys.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.1.%20%20Syntax"></a></body></html><a class="selflink" href="#section-4.1" id="section-4.1">4.1</a>.  Syntax</span>

   A DPoP proof is a JWT ([<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>]) that is signed (using JWS,
   [<a href="/doc/html/rfc7515" title='"JSON Web Signature (JWS)"'>RFC7515</a>]) using a private key chosen by the client (see below).  The
   header of a DPoP JWT contains at least the following parameters:

   *  "typ": type header, value "dpop+jwt" (<em>REQUIRED</em>).

   *  "alg": a digital signature algorithm identifier as per [<a href="/doc/html/rfc7518" title='"JSON Web Algorithms (JWA)"'>RFC7518</a>]
      (<em>REQUIRED</em>).  <em>MUST NOT</em> be "none" or an identifier for a symmetric
      algorithm (MAC).

   *  "jwk": representing the public key chosen by the client, in JWK
      format, as defined in [<a href="/doc/html/rfc7515" title='"JSON Web Signature (JWS)"'>RFC7515</a>] (<em>REQUIRED</em>)

   The body of a DPoP proof contains at least the following claims:

   *  "jti": Unique identifier for the DPoP proof JWT (<em>REQUIRED</em>).  The
      value <em>MUST</em> be assigned such that there is a negligible probability
      that the same value will be assigned to any other DPoP proof used
      in the same context during the time window of validity.  Such
      uniqueness can be accomplished by encoding (base64url or any other
      suitable encoding) at least 96 bits of pseudorandom data or by
      using a version 4 UUID string according to [<a href="/doc/html/rfc4122" title='"A Universally Unique IDentifier (UUID) URN Namespace"'>RFC4122</a>].  The "jti"



<span class="grey">Fett, et al.            Expires 5 September 2020                [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


      <em>SHOULD</em> be used by the server for replay detection and prevention,
      see <a href="#section-9.1">Section 9.1</a>.

   *  "htm": The HTTP method for the request to which the JWT is
      attached, as defined in [<a href="/doc/html/rfc7231" title='"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"'>RFC7231</a>] (<em>REQUIRED</em>).

   *  "htu": The HTTP URI used for the request, without query and
      fragment parts (<em>REQUIRED</em>).

   *  "iat": Time at which the JWT was created (<em>REQUIRED</em>).

   Figure 2 shows the JSON header and payload of a DPoP proof JWT.

   {
     "typ":"dpop+jwt",
     "alg":"ES256",
     "jwk": {
       "kty":"EC",
       "x":"l8tFrhx-34tV3hRICRDY9zCkDlpBhF42UQUfWVAWBFs",
       "y":"9VE4jf_Ok_o64zbTTlcuNJajHmt6v9TDVrU0CdvGRDA",
       "crv":"P-256"
     }
   }.{
     "jti":"-BwC3ESc6acc2lTc",
     "htm":"POST",
     "htu":"https://server.example.com/token",
     "iat":1562262616
   }

                                  Figure 2

   Figure 2: Example JWT content for "DPoP" proof header.

   Note: To keep DPoP simple to implement, only the HTTP method and URI
   are signed in DPoP proofs.  Nonetheless, DPoP proofs can be extended
   to contain other information of the HTTP request (see also
   <a href="#section-9.4">Section 9.4</a>).

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.2.%20%20Checking%20DPoP%20Proofs"></a></body></html><a class="selflink" href="#section-4.2" id="section-4.2">4.2</a>.  Checking DPoP Proofs</span>

   To check if a string that was received as part of an HTTP Request is
   a valid DPoP proof, the receiving server <em>MUST</em> ensure that

   1.  the string value is a well-formed JWT,

   2.  all required claims are contained in the JWT,

   3.  the "typ" field in the header has the value "dpop+jwt",



<span class="grey">Fett, et al.            Expires 5 September 2020                [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   4.  the algorithm in the header of the JWT indicates an asymmetric
       digital signature algorithm, is not "none", is supported by the
       application, and is deemed secure,

   5.  that the JWT is signed using the public key contained in the
       "jwk" header of the JWT,

   6.  the "htm" claim matches the HTTP method value of the HTTP request
       in which the JWT was received (case-insensitive),

   7.  the "htu" claims matches the HTTP URI value for the HTTP request
       in which the JWT was received, ignoring any query and fragment
       parts,

   8.  the token was issued within an acceptable timeframe (see
       <a href="#section-9.1">Section 9.1</a>), and

   9.  that, within a reasonable consideration of accuracy and resource
       utilization, a JWT with the same "jti" value has not been
       received previously (see <a href="#section-9.1">Section 9.1</a>).

   Servers <em>SHOULD</em> employ Syntax-Based Normalization and Scheme-Based
   Normalization in accordance with <a href="#section-6.2.2">Section 6.2.2</a>. and <a href="/doc/html/rfc3986#section-6.2.3">Section 6.2.3. of
   [RFC3986]</a> before comparing the "htu" claim.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.%20%20Token%20Request%20%28Binding%20Tokens%20to%20a%20Public%20Key%29"></a></body></html><a class="selflink" href="#section-5" id="section-5">5</a>.  Token Request (Binding Tokens to a Public Key)</span>

   To bind a token to a public key in the token request, the client <em>MUST</em>
   provide a valid DPoP proof JWT in a "DPoP" header.  The HTTPS request
   shown in Figure 3 illustrates the protocol for this (with extra line
   breaks for display purposes only).

   POST /token HTTP/1.1
   Host: server.example.com
   Content-Type: application/x-www-form-urlencoded;charset=UTF-8
   DPoP: eyJ0eXAiOiJkcG9wK2p3dCIsImFsZyI6IkVTMjU2IiwiandrIjp7Imt0eSI6Ik
    VDIiwieCI6Imw4dEZyaHgtMzR0VjNoUklDUkRZOXpDa0RscEJoRjQyVVFVZldWQVdCR
    nMiLCJ5IjoiOVZFNGpmX09rX282NHpiVFRsY3VOSmFqSG10NnY5VERWclUwQ2R2R1JE
    QSIsImNydiI6IlAtMjU2In19.eyJqdGkiOiItQndDM0VTYzZhY2MybFRjIiwiaHRtIj
    oiUE9TVCIsImh0dSI6Imh0dHBzOi8vc2VydmVyLmV4YW1wbGUuY29tL3Rva2VuIiwia
    WF0IjoxNTYyMjYyNjE2fQ.2-GxA6T8lP4vfrg8v-FdWP0A0zdrj8igiMLvqRMUvwnQg
    4PtFLbdLXiOSsX0x7NVY-FNyJK70nfbV37xRZT3Lg
   grant_type=authorization_code
   &amp;code=SplxlOBeZQQYbYS6WxSbIA
   &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb
   &amp;code_verifier=bEaL42izcC-o-xBk0K2vuJ6U-y1p9r_wW2dFWIWgjz-

                                  Figure 3



<span class="grey">Fett, et al.            Expires 5 September 2020                [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   Figure 3: Token Request for a DPoP sender-constrained token.

   The HTTP header "DPoP" <em>MUST</em> contain a valid DPoP proof.

   The authorization server, after checking the validity of the DPoP
   proof, <em>MUST</em> associate the access token issued at the token endpoint
   with the public key.  It then sets "token_type" to "DPoP" in the
   token response.

   A client typically cannot know whether a certain AS supports DPoP.
   It therefore <em>SHOULD</em> use the value of the "token_type" parameter
   returned from the AS to determine support for DPoP: If the token type
   returned is "Bearer" or another value, the AS does not support DPoP.
   If it is "DPoP", DPoP is supported.  Only then, the client needs to
   send the "DPoP" header in subsequent requests and use the token type
   "DPoP" in the "Authorization" header as described below.

   If a refresh token is issued to a public client at the token endpoint
   and a valid DPoP proof is presented, the refresh token <em>MUST</em> be bound
   to the public key contained in the header of the DPoP proof JWT.

   If a DPoP-bound refresh token is to be used at the token endpoint by
   a public client, the AS <em>MUST</em> ensure that the DPoP proof contains the
   same public key as the one the refresh token is bound to.  The access
   token issued <em>MUST</em> be bound to the public key contained in the DPoP
   proof.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.%20%20Resource%20Access%20%28Proof%20of%20Possession%20for%20Access%20Tokens%29"></a></body></html><a class="selflink" href="#section-6" id="section-6">6</a>.  Resource Access (Proof of Possession for Access Tokens)</span>

   To make use of an access token that is token-bound to a public key
   using DPoP, a client <em>MUST</em> prove the possession of the corresponding
   private key by providing a DPoP proof in the "DPoP" request header.

   The DPoP-bound access token must be sent in the "Authorization"
   header with the prefix "DPoP".

   If a resource server detects that an access token that is to be used
   for resource access is bound to a public key using DPoP (via the
   methods described in <a href="#section-7">Section 7</a>) it <em>MUST</em> check that a header "DPoP"
   was received in the HTTP request, and check the header's contents
   according to the rules in <a href="#section-4.2">Section 4.2</a>.

   The resource server <em>MUST NOT</em> grant access to the resource unless all
   checks are successful.







<span class="grey">Fett, et al.            Expires 5 September 2020                [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   GET /protectedresource HTTP/1.1
   Host: resource.example.org
   Authorization: DPoP eyJhbGciOiJFUzI1NiIsImtpZCI6IkJlQUxrYiJ9.eyJzdWI
    iOiJzb21lb25lQGV4YW1wbGUuY29tIiwiaXNzIjoiaHR0cHM6Ly9zZXJ2ZXIuZXhhbX
    BsZS5jb20iLCJhdWQiOiJodHRwczovL3Jlc291cmNlLmV4YW1wbGUub3JnIiwibmJmI
    joxNTYyMjYyNjExLCJleHAiOjE1NjIyNjYyMTYsImNuZiI6eyJqa3QiOiIwWmNPQ09S
    Wk5ZeS1EV3BxcTMwalp5SkdIVE4wZDJIZ2xCVjN1aWd1QTRJIn19.vsFiVqHCyIkBYu
    50c69bmPJsj8qYlsXfuC6nZcLl8YYRNOhqMuRXu6oSZHe2dGZY0ODNaGg1cg-kVigzY
    hF1MQ
   DPoP: eyJ0eXAiOiJkcG9wK2p3dCIsImFsZyI6IkVTMjU2IiwiandrIjp7Imt0eSI6Ik
    VDIiwieCI6Imw4dEZyaHgtMzR0VjNoUklDUkRZOXpDa0RscEJoRjQyVVFVZldWQVdCR
    nMiLCJ5IjoiOVZFNGpmX09rX282NHpiVFRsY3VOSmFqSG10NnY5VERWclUwQ2R2R1JE
    QSIsImNydiI6IlAtMjU2In19.eyJqdGkiOiJlMWozVl9iS2ljOC1MQUVCIiwiaHRtIj
    oiR0VUIiwiaHR1IjoiaHR0cHM6Ly9yZXNvdXJjZS5leGFtcGxlLm9yZy9wcm90ZWN0Z
    WRyZXNvdXJjZSIsImlhdCI6MTU2MjI2MjYxOH0.lNhmpAX1WwmpBvwhok4E74kWCiGB
    NdavjLAeevGy32H3dbF0Jbri69Nm2ukkwb-uyUI4AUg1JSskfWIyo4UCbQ

                                  Figure 4

   Figure 4: Protected Resource Request with a DPoP sender-constrained
   access token.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.%20%20Public%20Key%20Confirmation"></a></body></html><a class="selflink" href="#section-7" id="section-7">7</a>.  Public Key Confirmation</span>

   It <em>MUST</em> be ensured that resource servers can reliably identify
   whether a token is bound using DPoP and learn the public key to which
   the token is bound.

   Access tokens that are represented as JSON Web Tokens (JWT) [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>]
   <em>MUST</em> contain information about the DPoP public key (in JWK format) in
   the member "jkt" of the "cnf" claim, as shown in Figure 5.

   The value in "jkt" <em>MUST</em> be the base64url encoding [<a href="/doc/html/rfc7515" title='"JSON Web Signature (JWS)"'>RFC7515</a>] of the
   JWK SHA-256 Thumbprint (according to [<a href="/doc/html/rfc7638" title='"JSON Web Key (JWK) Thumbprint"'>RFC7638</a>]) of the public key to
   which the access token is bound.

   {
     "sub":"someone@example.com",
     "iss":"https://server.example.com",
     "aud":"https://resource.example.org",
     "nbf":1562262611,
     "exp":1562266216,
     "cnf":{
         "jkt":"0ZcOCORZNYy-DWpqq30jZyJGHTN0d2HglBV3uiguA4I"
     }
   }

                                  Figure 5



<span class="grey">Fett, et al.            Expires 5 September 2020                [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   Figure 5: Example access token body with "cnf" claim.

   When access token introspection is used, the same "cnf" claim as
   above <em>MUST</em> be contained in the introspection response.

   Resource servers <em>MUST</em> ensure that the fingerprint of the public key
   in the DPoP proof JWT equals the value in the "jkt" claim in the
   access token or introspection response.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/8.%20%20Acknowledgements"></a></body></html><a class="selflink" href="#section-8" id="section-8">8</a>.  Acknowledgements</span>

   We would like to thank David Waite, Filip Skokan, Mike Engan, and
   Justin Richer for their valuable input and feedback.

   This document resulted from discussions at the 4th OAuth Security
   Workshop in Stuttgart, Germany.  We thank the organizers of this
   workshop (Ralf Kusters, Guido Schmitz).

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.%20%20Security%20Considerations"></a></body></html><a class="selflink" href="#section-9" id="section-9">9</a>.  Security Considerations</span>

   In DPoP, the prevention of token replay at a different endpoint (see
   <a href="#section-2">Section 2</a>) is achieved through the binding of the DPoP proof to a
   certain URI and HTTP method.  DPoP does not, however, achieve the
   same level of protection as TLS-based methods such as OAuth Mutual
   TLS [<a href="/doc/html/rfc8705" title='"OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens"'>RFC8705</a>] or OAuth Token Binding [<a href="#ref-I-D.ietf-oauth-token-binding">I-D.ietf-oauth-token-binding</a>]
   (see also <a href="#section-9.1">Section 9.1</a> and <a href="#section-9.4">Section 9.4</a>).  TLS-based mechanisms can
   leverage a tight integration between the TLS layer and the
   application layer to achieve a very high level of message integrity
   and replay protection.  Therefore, it is <em>RECOMMENDED</em> to prefer TLS-
   based methods over DPoP if such methods are suitable for the scenario
   at hand.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.1.%20%20DPoP%20Proof%20Replay"></a></body></html><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  DPoP Proof Replay</span>

   If an adversary is able to get hold of a DPoP proof JWT, the
   adversary could replay that token at the same endpoint (the HTTP
   endpoint and method are enforced via the respective claims in the
   JWTs).  To prevent this, servers <em>MUST</em> only accept DPoP proofs for a
   limited time window after their "iat" time, preferably only for a
   relatively brief period.  Servers <em>SHOULD</em> store the "jti" value of
   each DPoP proof for the time window in which the respective DPoP
   proof JWT would be accepted and decline HTTP requests for which the
   "jti" value has been seen before.  In order to guard against memory
   exhaustion attacks a server <em>SHOULD</em> reject DPoP proof JWTs with
   unnecessarily large "jti" values or store only a hash thereof.

   Note: To accommodate for clock offsets, the server <em>MAY</em> accept DPoP




<span class="grey">Fett, et al.            Expires 5 September 2020               [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   proofs that carry an "iat" time in the near future (e.g., up to a few
   seconds in the future).

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.2.%20%20Signed%20JWT%20Swapping"></a></body></html><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  Signed JWT Swapping</span>

   Servers accepting signed DPoP proof JWTs <em>MUST</em> check the "typ" field
   in the headers of the JWTs to ensure that adversaries cannot use JWTs
   created for other purposes in the DPoP headers.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.3.%20%20Signature%20Algorithms"></a></body></html><a class="selflink" href="#section-9.3" id="section-9.3">9.3</a>.  Signature Algorithms</span>

   Implementers <em>MUST</em> ensure that only asymmetric digital signature
   algorithms that are deemed secure can be used for signing DPoP
   proofs.  In particular, the algorithm "none" <em>MUST NOT</em> be allowed.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.4.%20%20Message%20Integrity"></a></body></html><a class="selflink" href="#section-9.4" id="section-9.4">9.4</a>.  Message Integrity</span>

   DPoP does not ensure the integrity of the payload or headers of
   requests.  The signature of DPoP proofs only contains the HTTP URI
   and method, but not, for example, the message body or other request
   headers.

   This is an intentional design decision to keep DPoP simple to use,
   but as described, makes DPoP potentially susceptible to replay
   attacks where an attacker is able to modify message contents and
   headers.  In many setups, the message integrity and confidentiality
   provided by TLS is sufficient to provide a good level of protection.

   Implementers that have stronger requirements on the integrity of
   messages are encouraged to either use TLS-based mechanisms or signed
   requests.  TLS-based mechanisms are in particular OAuth Mutual TLS
   [<a href="/doc/html/rfc8705" title='"OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens"'>RFC8705</a>] and OAuth Token Binding [<a href="#ref-I-D.ietf-oauth-token-binding">I-D.ietf-oauth-token-binding</a>].

   Note: While signatures on (parts of) requests are out of the scope of
   this specification, signatures or information to be signed can be
   added into DPoP proofs.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/10.%20%20IANA%20Considerations"></a></body></html><a class="selflink" href="#section-10" id="section-10">10</a>.  IANA Considerations</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/10.1.%20%20OAuth%20Access%20Token%20Type%20Registration"></a></body></html><a class="selflink" href="#section-10.1" id="section-10.1">10.1</a>.  OAuth Access Token Type Registration</span>

   This specification registers the following access token type in the
   OAuth Access Token Types registry defined in [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>].

   *  Type name: "DPoP"

   *  Additional Token Endpoint Response Parameters: (none)




<span class="grey">Fett, et al.            Expires 5 September 2020               [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   *  HTTP Authentication Scheme(s): Bearer

   *  Change controller: IETF

   *  Specification document(s): [[ this specification ]]

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/10.2.%20%20JSON%20Web%20Signature%20and%20Encryption%20Type%20Values%20Registration"></a></body></html><a class="selflink" href="#section-10.2" id="section-10.2">10.2</a>.  JSON Web Signature and Encryption Type Values Registration</span>

   This specification registers the "dpop+jwt" type value in the IANA
   JSON Web Signature and Encryption Type Values registry [<a href="/doc/html/rfc7515" title='"JSON Web Signature (JWS)"'>RFC7515</a>]:

   *  "typ" Header Parameter Value: "dpop+jwt"

   *  Abbreviation for MIME Type: None

   *  Change Controller: IETF

   *  Specification Document(s): [[ this specification ]]

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.%20%20Normative%20References"></a></body></html><a class="selflink" href="#section-11" id="section-11">11</a>.  Normative References</span>

   [<a id="ref-RFC6749">RFC6749</a>]  Hardt, D., Ed., "The OAuth 2.0 Authorization Framework",
              <a href="/doc/html/rfc6749">RFC 6749</a>, DOI 10.17487/RFC6749, October 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;.

   [<a id="ref-RFC7519">RFC7519</a>]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
              (JWT)", <a href="/doc/html/rfc7519">RFC 7519</a>, DOI 10.17487/RFC7519, May 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;.

   [<a id="ref-RFC7638">RFC7638</a>]  Jones, M. and N. Sakimura, "JSON Web Key (JWK)
              Thumbprint", <a href="/doc/html/rfc7638">RFC 7638</a>, DOI 10.17487/RFC7638, September
              2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7638">https://www.rfc-editor.org/info/rfc7638</a>&gt;.

   [<a id="ref-RFC7518">RFC7518</a>]  Jones, M., "JSON Web Algorithms (JWA)", <a href="/doc/html/rfc7518">RFC 7518</a>,
              DOI 10.17487/RFC7518, May 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;.

   [<a id="ref-RFC7231">RFC7231</a>]  Fielding, R., Ed. and J. Reschke, Ed., "Hypertext Transfer
              Protocol (HTTP/1.1): Semantics and Content", <a href="/doc/html/rfc7231">RFC 7231</a>,
              DOI 10.17487/RFC7231, June 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;.

   [<a id="ref-RFC3986">RFC3986</a>]  Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
              Resource Identifier (URI): Generic Syntax", STD 66,
              <a href="/doc/html/rfc3986">RFC 3986</a>, DOI 10.17487/RFC3986, January 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/12.%20%20Informative%20References"></a></body></html><a class="selflink" href="#section-12" id="section-12">12</a>.  Informative References</span>



<span class="grey">Fett, et al.            Expires 5 September 2020               [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   [<a id="ref-I-D.ietf-oauth-token-binding">I-D.ietf-oauth-token-binding</a>]
              Jones, M., Campbell, B., Bradley, J., and W. Denniss,
              "OAuth 2.0 Token Binding", Work in Progress, Internet-
              Draft, <a href="/doc/html/draft-ietf-oauth-token-binding-08">draft-ietf-oauth-token-binding-08</a>, 19 October 2018,
              &lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-token-binding-08">https://tools.ietf.org/html/draft-ietf-oauth-token-</a>
              <a href="https://tools.ietf.org/html/draft-ietf-oauth-token-binding-08">binding-08</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words", <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC7515">RFC7515</a>]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web
              Signature (JWS)", <a href="/doc/html/rfc7515">RFC 7515</a>, DOI 10.17487/RFC7515, May
              2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;.

   [<a id="ref-RFC4122">RFC4122</a>]  Leach, P., Mealling, M., and R. Salz, "A Universally
              Unique IDentifier (UUID) URN Namespace", <a href="/doc/html/rfc4122">RFC 4122</a>,
              DOI 10.17487/RFC4122, July 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4122">https://www.rfc-editor.org/info/rfc4122</a>&gt;.

   [<a id="ref-RFC8705">RFC8705</a>]  Campbell, B., Bradley, J., Sakimura, N., and T.
              Lodderstedt, "OAuth 2.0 Mutual-TLS Client Authentication
              and Certificate-Bound Access Tokens", <a href="/doc/html/rfc8705">RFC 8705</a>,
              DOI 10.17487/RFC8705, February 2020,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8705">https://www.rfc-editor.org/info/rfc8705</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-I-D.ietf-oauth-security-topics">I-D.ietf-oauth-security-topics</a>]
              Lodderstedt, T., Bradley, J., Labunets, A., and D. Fett,
              "OAuth 2.0 Security Best Current Practice", Work in
              Progress, Internet-Draft, <a href="/doc/html/draft-ietf-oauth-security-topics-14">draft-ietf-oauth-security-</a>
              <a href="/doc/html/draft-ietf-oauth-security-topics-14">topics-14</a>, 10 February 2020, &lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-security-topics-14">https://tools.ietf.org/html/</a>
              <a href="https://tools.ietf.org/html/draft-ietf-oauth-security-topics-14">draft-ietf-oauth-security-topics-14</a>&gt;.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/Appendix%20A.%20%20Document%20History"></a></body></html><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  Document History</span>

   [[ To be removed from the final specification ]]

   -04

   *  Update OAuth MTLS reference to <a href="/doc/html/rfc8705">RFC 8705</a>

   *  Use the newish RFC v3 XML and HTML format




<span class="grey">Fett, et al.            Expires 5 September 2020               [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   -03

   *  rework the text around uniqueness requirements on the jti claim in
      the DPoP proof JWT

   *  make tokens a bit smaller by using "htm", "htu", and "jkt" rather
      than "http_method", "http_uri", and "jkt#S256" respectively

   *  more explicit recommendation to use mTLS if that is available

   *  added David Waite as co-author

   *  editorial updates

   -02

   *  added normalization rules for URIs

   *  removed distinction between proof and binding

   *  "jwk" header again used instead of "cnf" claim in DPoP proof

   *  renamed "Bearer-DPoP" token type to "DPoP"

   *  removed ability for key rotation

   *  added security considerations on request integrity

   *  explicit advice on extending DPoP proofs to sign other parts of
      the HTTP messages

   *  only use the jkt#S256 in ATs

   *  iat instead of exp in DPoP proof JWTs

   *  updated guidance on token_type evaluation

   -01

   *  fixed inconsistencies

   *  moved binding and proof messages to headers instead of parameters

   *  extracted and unified definition of DPoP JWTs

   *  improved description

   -00



<span class="grey">Fett, et al.            Expires 5 September 2020               [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey">Internet-Draft                 OAuth DPoP                     March 2020</span>


   *  first draft

Authors' Addresses

   Daniel Fett
   yes.com

   Email: mail@danielfett.de


   Brian Campbell
   Ping Identity

   Email: bcampbell@pingidentity.com


   John Bradley
   Yubico

   Email: ve7jtb@ve7jtb.com


   Torsten Lodderstedt
   yes.com

   Email: torsten@lodderstedt.net


   Michael Jones
   Microsoft

   Email: mbj@microsoft.com


   David Waite
   Ping Identity

   Email: david@alkaline-solutions.com













Fett, et al.            Expires 5 September 2020               [Page 15]
</pre>
</div>
</div>
</div>
<script>$(".visible-nojs").removeClass("visible-nojs");</script>
<script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
<script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>
</body>
</html>
