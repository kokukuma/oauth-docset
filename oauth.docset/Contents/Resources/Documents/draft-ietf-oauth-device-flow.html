<!DOCTYPE html>
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html --><html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<title>
  
    draft-ietf-oauth-device-flow-15
  
</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>
<!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.38.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.38.0/respond/dest/respond.min.js"></script>
    <![endif]-->
<link href="/feed/document-changes/draft-ietf-oauth-device-flow/" rel="alternate" title="Document changes" type="application/atom+xml"/>
<meta content="OAuth 2.0 Device Authorization Grant (Internet-Draft, 2019)" name="description"/>
<script src="https://www.ietf.org/lib/dt/7.38.0/d3/d3.min.js"></script>
<script src="https://www.ietf.org/lib/dt/7.38.0/jquery/jquery.min.js"></script>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/ietf-icon-blue3.png" rel="shortcut icon"/>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/apple-touch-icon.png" rel="apple-touch-icon"/>
</head>
<body style="padding-top: 0;">
<div class="content" id="content">
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
<div class="rfcmarkup">
<div class="noprint" style="height: 6px;">
<div class="meta-info bgred" onclick="showLegend();" onmouseout="hideLegend()" onmouseover="this.style.cursor='pointer';" style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; " title="Click for colour legend."> </div>
<div class="meta-info noprint pre legend" id="legend" onmouseout="hideLegend();" onmouseover="showLegend();" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
</div>
</div>
<div class="noprint">
<pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-device-flow-15.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-device-flow-15.xml" title="XML source for this document">xml</a>|<a href="https://tools.ietf.org/pdf/draft-ietf-oauth-device-flow-15.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/draft-ietf-oauth-device-flow/15/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/draft-ietf-oauth-device-flow/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/oauth/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-oauth-device-flow@ietf.org?subject=draft-ietf-oauth-device-flow" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-oauth-device-flow-15.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-oauth-device-flow-15.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-oauth-device-flow-15.txt" title="Run an idnits check of this document">Nits</a>]

Versions: (<a href="/doc/html/draft-denniss-oauth-device-flow">draft-denniss-oauth-device-flow</a>)   <a href="/doc/html/draft-ietf-oauth-device-flow-00">00</a>         Standards Track
          <a href="/doc/html/draft-ietf-oauth-device-flow-01">01</a> <a href="/doc/html/draft-ietf-oauth-device-flow-02">02</a> <a href="/doc/html/draft-ietf-oauth-device-flow-03">03</a> <a href="/doc/html/draft-ietf-oauth-device-flow-04">04</a> <a href="/doc/html/draft-ietf-oauth-device-flow-05">05</a> <a href="/doc/html/draft-ietf-oauth-device-flow-06">06</a> <a href="/doc/html/draft-ietf-oauth-device-flow-07">07</a> <a href="/doc/html/draft-ietf-oauth-device-flow-08">08</a> <a href="/doc/html/draft-ietf-oauth-device-flow-09">09</a> <a href="/doc/html/draft-ietf-oauth-device-flow-10">10</a> <a href="/doc/html/draft-ietf-oauth-device-flow-11">11</a> <a href="/doc/html/draft-ietf-oauth-device-flow-12">12</a> <a href="/doc/html/draft-ietf-oauth-device-flow-13">13</a>                        
          <a href="/doc/html/draft-ietf-oauth-device-flow-14">14</a> <a href="/doc/html/draft-ietf-oauth-device-flow-15"><b>15</b></a> <a href="/doc/html/rfc8628">rfc8628</a>                                                 </pre>
</div>
<div class="draftcontent">
<pre>OAuth                                                         W. Denniss
Internet-Draft                                                    Google
Intended status: Standards Track                              J. Bradley
Expires: September 12, 2019                                Ping Identity
                                                                M. Jones
                                                               Microsoft
                                                           H. Tschofenig
                                                             ARM Limited
                                                          March 11, 2019


                  <span class="h1">OAuth 2.0 Device Authorization Grant</span>
                    <span class="h1">draft-ietf-oauth-device-flow-15</span>

Abstract

   The OAuth 2.0 Device Authorization Grant is designed for internet-
   connected devices that either lack a browser to perform a user-agent
   based authorization, or are input-constrained to the extent that
   requiring the user to input text in order to authenticate during the
   authorization flow is impractical.  It enables OAuth clients on such
   devices (like smart TVs, media consoles, digital picture frames, and
   printers) to obtain user authorization to access protected resources
   without using an on-device user-agent.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="/doc/html/bcp78">BCP 78</a> and <a href="/doc/html/bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 12, 2019.

Copyright Notice

   Copyright (c) 2019 IETF Trust and the persons identified as the
   document authors.  All rights reserved.





<span class="grey">Denniss, et al.        Expires September 12, 2019               [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-3">3</a>.  Protocol  . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.1">3.1</a>.  Device Authorization Request  . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.2">3.2</a>.  Device Authorization Response . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-3.3">3.3</a>.  User Interaction  . . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
       <a href="#section-3.3.1">3.3.1</a>.  Non-textual Verification URI Optimization . . . . . .   <a href="#page-9">9</a>
     <a href="#section-3.4">3.4</a>.  Device Access Token Request . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-3.5">3.5</a>.  Device Access Token Response  . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-4">4</a>.  Discovery Metadata  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#section-5">5</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-5.1">5.1</a>.  User Code Brute Forcing . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-5.2">5.2</a>.  Device Code Brute Forcing . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-5.3">5.3</a>.  Device Trustworthiness  . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-5.4">5.4</a>.  Remote Phishing . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-5.5">5.5</a>.  Session Spying  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
     <a href="#section-5.6">5.6</a>.  Non-confidential Clients  . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
     <a href="#section-5.7">5.7</a>.  Non-Visual Code Transmission  . . . . . . . . . . . . . .  <a href="#page-15">15</a>
   <a href="#section-6">6</a>.  Usability Considerations  . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
     <a href="#section-6.1">6.1</a>.  User Code Recommendations . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
     <a href="#section-6.2">6.2</a>.  Non-Browser User Interaction  . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   <a href="#section-7">7</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
     <a href="#section-7.1">7.1</a>.  OAuth Parameters Registration . . . . . . . . . . . . . .  <a href="#page-17">17</a>
       <a href="#section-7.1.1">7.1.1</a>.  Registry Contents . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
     <a href="#section-7.2">7.2</a>.  OAuth URI Registration  . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
       <a href="#section-7.2.1">7.2.1</a>.  Registry Contents . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
     <a href="#section-7.3">7.3</a>.  OAuth Extensions Error Registration . . . . . . . . . . .  <a href="#page-17">17</a>
       <a href="#section-7.3.1">7.3.1</a>.  Registry Contents . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
     <a href="#section-7.4">7.4</a>.  OAuth 2.0 Authorization Server Metadata . . . . . . . . .  <a href="#page-18">18</a>
       <a href="#section-7.4.1">7.4.1</a>.  Registry Contents . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
   <a href="#section-8">8</a>.  Normative References  . . . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
   <a href="#appendix-A">Appendix A</a>.  Acknowledgements . . . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>
   <a href="#appendix-B">Appendix B</a>.  Document History . . . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-22">22</a>





<span class="grey">Denniss, et al.        Expires September 12, 2019               [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.%20%20Introduction"></a></body></html><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   This OAuth 2.0 [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>] protocol extension, sometimes referred to as
   "device flow", enables OAuth clients to request user authorization
   from applications on devices that have limited input capabilities or
   lack a suitable browser.  Such devices include those smart TVs, media
   console, picture frames and printers which lack an easy input method
   or suitable browser required for traditional OAuth interactions.  The
   authorization flow defined by this specification instructs the user
   to review the authorization request on a secondary device, such as a
   smartphone which does have the requisite input and browser
   capabilities to complete the user interaction.

   The Device Authorization Grant is not intended to replace browser-
   based OAuth in native apps on capable devices like smartphones.
   Those apps should follow the practices specified in OAuth 2.0 for
   Native Apps [<a href="/doc/html/rfc8252" title='"OAuth 2.0 for Native Apps"'>RFC8252</a>].

   The operating requirements to be able to use this authorization grant
   type are:

   (1)  The device is already connected to the Internet.

   (2)  The device is able to make outbound HTTPS requests.

   (3)  The device is able to display or otherwise communicate a URI and
        code sequence to the user.

   (4)  The user has a secondary device (e.g., personal computer or
        smartphone) from which they can process the request.

   As the device authorization grant does not require two-way
   communication between the OAuth client and the user-agent (unlike
   other OAuth 2 grant types such as the Authorization Code and Implicit
   grant types), it supports several use cases that cannot be served by
   those other approaches.

   Instead of interacting with the end user's user agent, the client
   instructs the end user to use another computer or device and connect
   to the authorization server to approve the access request.  Since the
   protocol supports clients that can't receive incoming requests,
   clients poll the authorization server repeatedly until the end user
   completes the approval process.

   The device typically chooses the set of authorization servers to
   support (i.e., its own authorization server, or those by providers it
   has relationships with).  It is not uncommon for the device
   application to support only a single authorization server, such as



<span class="grey">Denniss, et al.        Expires September 12, 2019               [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   with a TV application for a specific media provider that supports
   only that media provider's authorization server.  The user may not
   have an established relationship yet with that authorization
   provider, though one can potentially be set up during the
   authorization flow.

      +----------+                                +----------------+
      |          |&gt;---(A)-- Client Identifier ---&gt;|                |
      |          |                                |                |
      |          |&lt;---(B)-- Device Code,      ---&lt;|                |
      |          |          User Code,            |                |
      |  Device  |          &amp; Verification URI    |                |
      |  Client  |                                |                |
      |          |  [polling]                     |                |
      |          |&gt;---(E)-- Device Code,      ---&gt;|                |
      |          |          &amp; Client Identifier   |                |
      |          |                                |  Authorization |
      |          |&lt;---(F)-- Access Token      ---&lt;|     Server     |
      +----------+   (&amp; Optional Refresh Token)   |                |
            v                                     |                |
            :                                     |                |
           (C) User Code &amp; Verification URI       |                |
            :                                     |                |
            v                                     |                |
      +----------+                                |                |
      | End user |                                |                |
      |    at    |&lt;---(D)-- End user reviews  ---&gt;|                |
      |  Browser |          authorization request |                |
      +----------+                                +----------------+

                    Figure 1: Device Authorization Flow

   The device authorization flow illustrated in Figure 1 includes the
   following steps:

      (A) The client requests access from the authorization server and
      includes its client identifier in the request.

      (B) The authorization server issues a device code, an end-user
      code, and provides the end-user verification URI.

      (C) The client instructs the end user to use its user agent (on
      another device) and visit the provided end-user verification URI.
      The client provides the user with the end-user code to enter in
      order to review the authorization request.

      (D) The authorization server authenticates the end user (via the
      user agent) and prompts the user to grant the client's access



<span class="grey">Denniss, et al.        Expires September 12, 2019               [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


      request.  If the user agrees to the client's access request, the
      user enters the user code provided by the client.  The
      authorization server validates the user code provided by the user.

      (E) While the end user reviews the client's request (step D), the
      client repeatedly polls the authorization server to find out if
      the user completed the user authorization step.  The client
      includes the verification code and its client identifier.

      (F) The authorization server validates the verification code
      provided by the client and responds back with the access token if
      the user granted access, an error if they denied access, or
      indicates that the client should continue to poll.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.%20%20Terminology"></a></body></html><a class="selflink" href="#section-2" id="section-2">2</a>.  Terminology</span>

   The key words "<em>MUST</em>", "<em>MUST NOT</em>", "<em>REQUIRED</em>", "<em>SHALL</em>", "<em>SHALL NOT</em>",
   "<em>SHOULD</em>", "<em>SHOULD NOT</em>", "<em>RECOMMENDED</em>", "NOT <em>RECOMMENDED</em>", "<em>MAY</em>", and
   "<em>OPTIONAL</em>" in this document are to be interpreted as described in <a href="/doc/html/bcp14">BCP</a>
   <a href="/doc/html/bcp14">14</a> [<a href="/doc/html/rfc2119">RFC2119</a>] [<a href="/doc/html/rfc8174" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

   Device Authorization Endpoint:
      The authorization server's endpoint capable of issuing device
      verification codes, user codes, and verification URLs.

   Device Verification Code:
      A short-lived token representing an authorization session.

   End-User Verification Code:
      A short-lived token which the device displays to the end user, is
      entered by the user on the authorization server, and is thus used
      to bind the device to the user.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.%20%20Protocol"></a></body></html><a class="selflink" href="#section-3" id="section-3">3</a>.  Protocol</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.1.%20%20Device%20Authorization%20Request"></a></body></html><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  Device Authorization Request</span>

   This specification defines a new OAuth endpoint, the device
   authorization endpoint.  This is separate from the OAuth
   authorization endpoint defined in [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>] with which the user
   interacts with via a user-agent (i.e., a browser).  By comparison,
   when using the device authorization endpoint, the OAuth client on the
   device interacts with the authorization server directly without
   presenting the request in a user-agent, and the end user authorizes
   the request on a separate device.  This interaction is defined as
   follows.




<span class="grey">Denniss, et al.        Expires September 12, 2019               [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   The client initiates the authorization flow by requesting a set of
   verification codes from the authorization server by making an HTTP
   "POST" request to the device authorization endpoint.

   The client constructs the request with the following parameters, sent
   as the body of the request, encoded with the "application/x-www-form-
   urlencoded" encoding algorithm defined by Section 4.10.22.6 of
   [<a href="#ref-HTML5" title='"HTML5"'>HTML5</a>]:

   client_id
      <em>REQUIRED</em>, if the client is not authenticating with the
      authorization server as described in <a href="/doc/html/rfc6749#section-3.2.1">Section 3.2.1. of [RFC6749]</a>.
      The client identifier as described in <a href="/doc/html/rfc6749#section-2.2">Section 2.2 of [RFC6749]</a>.

   scope
      <em>OPTIONAL</em>.  The scope of the access request as described by
      <a href="/doc/html/rfc6749#section-3.3">Section 3.3 of [RFC6749]</a>.

   For example, the client makes the following HTTPS request:

      POST /device_authorization HTTP/1.1
      Host: server.example.com
      Content-Type: application/x-www-form-urlencoded

      client_id=459691054427

   All requests from the device <em>MUST</em> use the Transport Layer Security
   (TLS) [<a href="/doc/html/rfc8446" title='"The Transport Layer Security (TLS) Protocol Version 1.3"'>RFC8446</a>] protocol and implement the best practices of <a href="/doc/html/bcp195">BCP 195</a>
   [<a href="/doc/html/rfc7525" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>RFC7525</a>].

   Parameters sent without a value <em>MUST</em> be treated as if they were
   omitted from the request.  The authorization server <em>MUST</em> ignore
   unrecognized request parameters.  Request and response parameters
   <em>MUST NOT</em> be included more than once.

   The client authentication requirements of <a href="/doc/html/rfc6749#section-3.2.1">Section 3.2.1 of [RFC6749]</a>
   apply to requests on this endpoint, which means that confidential
   clients (those that have established client credentials) authenticate
   in the same manner as when making requests to the token endpoint, and
   public clients provide the "client_id" parameter to identify
   themselves.

   Due to the polling nature of this protocol (as specified in
   <a href="#section-3.4">Section 3.4</a>), care is needed to avoid overloading the capacity of the
   token endpoint.  To avoid unneeded requests on the token endpoint,
   the client <em>SHOULD</em> only commence a device authorization request when
   prompted by the user, and not automatically, such as when the app
   starts or when the previous authorization session expires or fails.



<span class="grey">Denniss, et al.        Expires September 12, 2019               [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.2.%20%20Device%20Authorization%20Response"></a></body></html><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  Device Authorization Response</span>

   In response, the authorization server generates a unique device
   verification code and an end-user code that are valid for a limited
   time and includes them in the HTTP response body using the
   "application/json" format [<a href="/doc/html/rfc8259" title='"The JavaScript Object Notation (JSON) Data Interchange Format"'>RFC8259</a>] with a 200 (OK) status code.  The
   response contains the following parameters:

   device_code
      <em>REQUIRED</em>.  The device verification code.

   user_code
      <em>REQUIRED</em>.  The end-user verification code.

   verification_uri
      <em>REQUIRED</em>.  The end-user verification URI on the authorization
      server.  The URI should be short and easy to remember as end users
      will be asked to manually type it into their user-agent.

   verification_uri_complete
      <em>OPTIONAL</em>.  A verification URI that includes the "user_code" (or
      other information with the same function as the "user_code"),
      designed for non-textual transmission.

   expires_in
      <em>REQUIRED</em>.  The lifetime in seconds of the "device_code" and
      "user_code".

   interval
      <em>OPTIONAL</em>.  The minimum amount of time in seconds that the client
      <em>SHOULD</em> wait between polling requests to the token endpoint.  If no
      value is provided, clients <em>MUST</em> use 5 as the default.

   For example:

      HTTP/1.1 200 OK
      Content-Type: application/json
      Cache-Control: no-store

      {
        "device_code": "GmRhmhcxhwAzkoEqiMEg_DnyEysNkuNhszIySk9eS",
        "user_code": "WDJB-MJHT",
        "verification_uri": "https://example.com/device",
        "verification_uri_complete":
            "https://example.com/device?user_code=WDJB-MJHT",
        "expires_in": 1800,
        "interval": 5
      }



<span class="grey">Denniss, et al.        Expires September 12, 2019               [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   In the event of an error (such as an invalidly configured client),
   the authorization server responds in the same way as the token
   endpoint specified in <a href="/doc/html/rfc6749#section-5.2">Section 5.2 of [RFC6749]</a>.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.3.%20%20User%20Interaction"></a></body></html><a class="selflink" href="#section-3.3" id="section-3.3">3.3</a>.  User Interaction</span>

   After receiving a successful Authorization Response, the client
   displays or otherwise communicates the "user_code" and the
   "verification_uri" to the end user and instructs them to visit the
   URI in a user agent on a secondary device (for example, in a browser
   on their mobile phone), and enter the user code.

                  +-----------------------------------------------+
                  |                                               |
                  |  Using a browser on another device, visit:    |
                  |  https://example.com/device                   |
                  |                                               |
                  |  And enter the code:                          |
                  |  WDJB-MJHT                                    |
                  |                                               |
                  +-----------------------------------------------+

                    Figure 2: Example User Instruction

   The authorizing user navigates to the "verification_uri" and
   authenticates with the authorization server in a secure TLS-protected
   ([<a href="/doc/html/rfc8446" title='"The Transport Layer Security (TLS) Protocol Version 1.3"'>RFC8446</a>]) session.  The authorization server prompts the end user
   to identify the device authorization session by entering the
   "user_code" provided by the client.  The authorization server should
   then inform the user about the action they are undertaking and ask
   them to approve or deny the request.  Once the user interaction is
   complete, the server <em>MAY</em> inform the user to return to their device.

   During the user interaction, the device continuously polls the token
   endpoint with the "device_code", as detailed in <a href="#section-3.4">Section 3.4</a>, until
   the user completes the interaction, the code expires, or another
   error occurs.  The "device_code" is not intended for the end user
   directly, and thus should not be displayed during the interaction to
   avoid confusing the end user.

   Authorization servers supporting this specification <em>MUST</em> implement a
   user interaction sequence that starts with the user navigating to
   "verification_uri" and continues with them supplying the "user_code"
   at some stage during the interaction.  Other than that, the exact
   sequence and implementation of the user interaction is up to the
   authorization server, for example, the authorization server may
   enable new users to sign up for an account during the authorization
   flow, or add additional security verification steps.



<span class="grey">Denniss, et al.        Expires September 12, 2019               [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   It is NOT <em>RECOMMENDED</em> for authorization servers to include the user
   code in the verification URI ("verification_uri"), as this increases
   the length and complexity of the URI that the user must type.  While
   the user must still type the same number of characters with the
   "user_code" separated, once they successfully navigate to the
   "verification_uri", any errors in entering the code can be
   highlighted by the authorization server to improve the user
   experience.  The next section documents user interaction with
   "verification_uri_complete", which is designed to carry both pieces
   of information.

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.3.1.%20%20Non-textual%20Verification%20URI%20Optimization"></a></body></html><a class="selflink" href="#section-3.3.1" id="section-3.3.1">3.3.1</a>.  Non-textual Verification URI Optimization</span>

   When "verification_uri_complete" is included in the Authorization
   Response (<a href="#section-3.2">Section 3.2</a>), clients <em>MAY</em> present this URI in a non-textual
   manner using any method that results in the browser being opened with
   the URI, such as with QR (Quick Response) codes or NFC (Near Field
   Communication), to save the user typing the URI.

   For usability reasons, it is <em>RECOMMENDED</em> for clients to still display
   the textual verification URI ("verification_uri") for users not able
   to use such a shortcut.  Clients <em>MUST</em> still display the "user_code",
   as the authorization server will require the user to confirm it to
   disambiguate devices, or as a remote phishing mitigation (See
   <a href="#section-5.4">Section 5.4</a>).

   If the user starts the user interaction by browsing to
   "verification_uri_complete", then the user interaction described in
   <a href="#section-3.3">Section 3.3</a> is still followed, but with the optimization that the
   user does not need to type the "user_code".  The server <em>SHOULD</em>
   display the "user_code" to the user and ask them to verify that it
   matches the "user_code" being displayed on the device, to confirm
   they are authorizing the correct device.  As before, in addition to
   taking steps to confirm the identity of the device, the user should
   also be afforded the choice to approve or deny the authorization
   request.















<span class="grey">Denniss, et al.        Expires September 12, 2019               [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


                  +-------------------------------------------------+
                  |                                                 |
                  |  Scan the QR code, or using     +------------+  |
                  |  a browser on another device,   |[_]..  . [_]|  |
                  |  visit:                         | .  ..   . .|  |
                  |  https://example.com/device     | . .  . ....|  |
                  |                                 |.   . . .   |  |
                  |  And enter the code:            |[_]. ... .  |  |
                  |  WDJB-MJHT                      +------------+  |
                  |                                                 |
                  +-------------------------------------------------+

   Figure 3: Example User Instruction with QR Code Representation of the
                         Complete Verification URI

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.4.%20%20Device%20Access%20Token%20Request"></a></body></html><a class="selflink" href="#section-3.4" id="section-3.4">3.4</a>.  Device Access Token Request</span>

   After displaying instructions to the user, the client makes an Access
   Token Request to the token endpoint (as defined by <a href="/doc/html/rfc6749#section-3.2">Section 3.2 of
   [RFC6749]</a>) with a "grant_type" of
   "urn:ietf:params:oauth:grant-type:device_code".  This is an extension
   grant type (as defined by <a href="/doc/html/rfc6749#section-4.5">Section 4.5 of [RFC6749]</a>) created by this
   specification, with the following parameters:

   grant_type
      <em>REQUIRED</em>.  Value <em>MUST</em> be set to
      "urn:ietf:params:oauth:grant-type:device_code".

   device_code
      <em>REQUIRED</em>.  The device verification code, "device_code" from the
      Device Authorization Response, defined in <a href="#section-3.2">Section 3.2</a>.

   client_id
      <em>REQUIRED</em>, if the client is not authenticating with the
      authorization server as described in <a href="/doc/html/rfc6749#section-3.2.1">Section 3.2.1. of [RFC6749]</a>.
      The client identifier as described in <a href="/doc/html/rfc6749#section-2.2">Section 2.2 of [RFC6749]</a>.

   For example, the client makes the following HTTPS request (line
   breaks are for display purposes only):












<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


      POST /token HTTP/1.1
      Host: server.example.com
      Content-Type: application/x-www-form-urlencoded

      grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Adevice_code
      &amp;device_code=GmRhmhcxhwAzkoEqiMEg_DnyEysNkuNhszIySk9eS
      &amp;client_id=459691054427


   If the client was issued client credentials (or assigned other
   authentication requirements), the client <em>MUST</em> authenticate with the
   authorization server as described in <a href="/doc/html/rfc6749#section-3.2.1">Section 3.2.1 of [RFC6749]</a>.
   Note that there are security implications of statically distributed
   client credentials, see <a href="#section-5.6">Section 5.6</a>.

   The response to this request is defined in <a href="#section-3.5">Section 3.5</a>.  Unlike other
   OAuth grant types, it is expected for the client to try the Access
   Token Request repeatedly in a polling fashion, based on the error
   code in the response.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.5.%20%20Device%20Access%20Token%20Response"></a></body></html><a class="selflink" href="#section-3.5" id="section-3.5">3.5</a>.  Device Access Token Response</span>

   If the user has approved the grant, the token endpoint responds with
   a success response defined in <a href="/doc/html/rfc6749#section-5.1">Section 5.1 of [RFC6749]</a>; otherwise it
   responds with an error, as defined in <a href="/doc/html/rfc6749#section-5.2">Section 5.2 of [RFC6749]</a>.

   In addition to the error codes defined in <a href="/doc/html/rfc6749#section-5.2">Section 5.2 of [RFC6749]</a>,
   the following error codes are specified for use with the device
   authorization grant in token endpoint responses:

   authorization_pending
      The authorization request is still pending as the end user hasn't
      yet completed the user interaction steps (<a href="#section-3.3">Section 3.3</a>).  The
      client <em>SHOULD</em> repeat the Access Token Request to the token
      endpoint (a process known as polling).  Before each new request
      the client <em>MUST</em> wait at least the number of seconds specified by
      the "interval" parameter of the Device Authorization Response (see
      <a href="#section-3.2">Section 3.2</a>), or 5 seconds if none was provided, and respect any
      increase in the polling interval required by the "slow_down"
      error.

   slow_down
      A variant of "authorization_pending", the authorization request is
      still pending and polling should continue, but the interval <em>MUST</em>
      be increased by 5 seconds for this and all subsequent requests.

   access_denied
      The end user denied the authorization request.



<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   expired_token
      The "device_code" has expired and the device authorization session
      has concluded.  The client <em>MAY</em> commence a new Device Authorization
      Request but <em>SHOULD</em> wait for user interaction before restarting to
      avoid unnecessary polling.

   The "authorization_pending" and "slow_down" error codes define
   particularly unique behavior, as they indicate that the OAuth client
   should continue to poll the token endpoint by repeating the token
   request (implementing the precise behavior defined above).  If the
   client receives an error response with any other error code, it <em>MUST</em>
   stop polling and <em>SHOULD</em> react accordingly, for example, by displaying
   an error to the user.

   On encountering a connection timeout, clients <em>MUST</em> unilaterally
   reduce their polling frequency before retrying.  The use of an
   exponential backoff algorithm to achieve this, such as by doubling
   the polling interval on each such connection timeout, is <em>RECOMMENDED</em>.

   The assumption of this specification is that the separate device the
   user is authorizing the request on does not have a way to communicate
   back to device with the OAuth client.  This protocol only requires a
   one-way channel in order to maximise the viability of the protocol in
   restricted environments, like an application running on a TV that is
   only capable of outbound requests.  If a return channel were to exist
   for the chosen user interaction interface, then the device <em>MAY</em> wait
   until notified on that channel that the user has completed the action
   before initiating the token request (as an alternative to polling).
   Such behavior is, however, outside the scope of this specification.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.%20%20Discovery%20Metadata"></a></body></html><a class="selflink" href="#section-4" id="section-4">4</a>.  Discovery Metadata</span>

   Support for this specification <em>MAY</em> be declared in the OAuth 2.0
   Authorization Server Metadata [<a href="/doc/html/rfc8414" title='"OAuth 2.0 Authorization Server Metadata"'>RFC8414</a>] by including the value
   "urn:ietf:params:oauth:grant-type:device_code" in the
   "grant_types_supported" parameter, and by adding the following new
   parameter:

   device_authorization_endpoint
      <em>OPTIONAL</em>.  URL of the authorization server's device authorization
      endpoint defined in <a href="#section-3.1">Section 3.1</a>.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.%20%20Security%20Considerations"></a></body></html><a class="selflink" href="#section-5" id="section-5">5</a>.  Security Considerations</span>








<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.1.%20%20User%20Code%20Brute%20Forcing"></a></body></html><a class="selflink" href="#section-5.1" id="section-5.1">5.1</a>.  User Code Brute Forcing</span>

   Since the user code is typed by the user, shorter codes are more
   desirable for usability reasons.  This means the entropy is typically
   less than would be used for the device code or other OAuth bearer
   token types where the code length does not impact usability.  It is
   therefore recommended that the server rate-limit user code attempts.

   The user code <em>SHOULD</em> have enough entropy that when combined with rate
   limiting and other mitigations makes a brute-force attack infeasible.
   For example, it's generally held that 128-bit symmetric keys for
   encryption are seen as good enough today because an attacker has to
   put in 2^96 work to have a 2^-32 chance of guessing correctly via
   brute force.  The rate limiting and finite lifetime on the user code
   places an artificial limit on the amount of work an attacker can
   "do", so if, for instance, one uses a 8-character base-20 user code
   (with roughly 34.5 bits of entropy), the rate-limiting interval and
   validity period would need to only allow 5 attempts in order to get
   the same 2^-32 probability of success by random guessing.

   A successful brute forcing of the user code would enable the attacker
   to authenticate with their own credentials and make an authorization
   grant to the device.  This is the opposite scenario to an OAuth
   bearer token being brute forced, whereby the attacker gains control
   of the victim's authorization grant.  Such attacks may not always
   make economic sense, for example for a video app the device owner may
   then be able to purchase movies using the attacker's account, though
   a privacy risk would still remain and thus is important to protect
   against.  Furthermore, some uses of the device flow give the granting
   account the ability to perform actions such as controlling the
   device, which needs to be protected.

   The precise length of the user code and the entropy contained within
   is at the discretion of the authorization server, which needs to
   consider the sensitivity of their specific protected resources, the
   practicality of the code length from a usability standpoint, and any
   mitigations that are in place such as rate-limiting, when determining
   the user code format.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.2.%20%20Device%20Code%20Brute%20Forcing"></a></body></html><a class="selflink" href="#section-5.2" id="section-5.2">5.2</a>.  Device Code Brute Forcing</span>

   An attacker who guesses the device code would be able to potentially
   obtain the authorization code once the user completes the flow.  As
   the device code is not displayed to the user and thus there are no
   usability considerations on the length, a very high entropy code
   <em>SHOULD</em> be used.





<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.3.%20%20Device%20Trustworthiness"></a></body></html><a class="selflink" href="#section-5.3" id="section-5.3">5.3</a>.  Device Trustworthiness</span>

   Unlike other native application OAuth 2.0 flows, the device
   requesting the authorization is not the same as the device that the
   user grants access from.  Thus, signals from the approving user's
   session and device are not relevant to the trustworthiness of the
   client device.

   Note that if an authorization server used with this flow is
   malicious, then it could man-in-the-middle the backchannel flow to
   another authorization server.  In this scenario, the man-in-the-
   middle is not completely hidden from sight, as the end user would end
   up on the authorization page of the wrong service, giving them an
   opportunity to notice that the URL in the browser's address bar is
   wrong.  For this to be possible, the device manufacturer must either
   directly be the attacker, shipping a device intended to perform the
   man-in-the-middle attack, or be using an authorization server that is
   controlled by an attacker, possibly because the attacker compromised
   the authorization server used by the device.  In part, the person
   purchasing the device is counting on it and its business partners to
   be trustworthy.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.4.%20%20Remote%20Phishing"></a></body></html><a class="selflink" href="#section-5.4" id="section-5.4">5.4</a>.  Remote Phishing</span>

   It is possible for the device flow to be initiated on a device in an
   attacker's possession.  For example, an attacker might send an email
   instructing the target user to visit the verification URL and enter
   the user code.  To mitigate such an attack, it is <em>RECOMMENDED</em> to
   inform the user that they are authorizing a device during the user
   interaction step (see <a href="#section-3.3">Section 3.3</a>), and to confirm that the device is
   in their possession.  The authorization server <em>SHOULD</em> display
   information about the device so that the person can notice if a
   software client was attempting to impersonating a hardware device.

   For authorization servers that support the option specified in
   <a href="#section-3.3.1">Section 3.3.1</a> for the client to append the user code to the
   authorization URI, it is particularly important to confirm that the
   device is in the user's possession, as the user no longer has to type
   the code manually.  One possibility is to display the code during the
   authorization flow and asking the user to verify that the same code
   is being displayed on the device they are setting up.

   The user code needs to have a long enough lifetime to be useable
   (allowing the user to retrieve their secondary device, navigate to
   the verification URI, login, etc.), but should be sufficiently short
   to limit the usability of a code obtained for phishing.  This doesn't
   prevent a phisher presenting a fresh token, particularly in the case




<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   they are interacting with the user in real time, but it does limit
   the viability of codes sent over email or SMS.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.5.%20%20Session%20Spying"></a></body></html><a class="selflink" href="#section-5.5" id="section-5.5">5.5</a>.  Session Spying</span>

   While the device is pending authorization, it may be possible for a
   malicious user to physically spy on the device user interface (by
   viewing the screen on which it's displayed, for example) and hijack
   the session by completing the authorization faster than the user that
   initiated it.  Devices <em>SHOULD</em> take into account the operating
   environment when considering how to communicate the code to the user
   to reduce the chances it will be observed by a malicious user.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.6.%20%20Non-confidential%20Clients"></a></body></html><a class="selflink" href="#section-5.6" id="section-5.6">5.6</a>.  Non-confidential Clients</span>

   Device clients are generally incapable of maintaining the
   confidentiality of their credentials, as users in possession of the
   device can reverse engineer it and extract the credentials.
   Therefore, unless additional measures are taken, they should be
   treated as public clients (as defined by <a href="#section-2.1">Section 2.1</a> of OAuth 2.0)
   susceptible to impersonation.  The security considerations of
   <a href="/doc/html/rfc6819#section-5.3.1">Section 5.3.1 of [RFC6819]</a> and Sections <a href="#section-8.5">8.5</a> and <a href="#section-8.6">8.6</a> of [<a href="/doc/html/rfc8252" title='"OAuth 2.0 for Native Apps"'>RFC8252</a>]
   apply to such clients.

   The user may also be able to obtain the device_code and/or other
   OAuth bearer tokens issued to their client, which would allow them to
   use their own authorization grant directly by impersonating the
   client.  Given that the user in possession of the client credentials
   can already impersonate the client and create a new authorization
   grant (with a new device_code), this doesn't represent a separate
   impersonation vector.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.7.%20%20Non-Visual%20Code%20Transmission"></a></body></html><a class="selflink" href="#section-5.7" id="section-5.7">5.7</a>.  Non-Visual Code Transmission</span>

   There is no requirement that the user code be displayed by the device
   visually.  Other methods of one-way communication can potentially be
   used, such as text-to-speech audio, or Bluetooth Low Energy.  To
   mitigate an attack in which a malicious user can bootstrap their
   credentials on a device not in their control, it is <em>RECOMMENDED</em> that
   any chosen communication channel only be accessible by people in
   close proximity.  E.g., users who can see, or hear the device.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.%20%20Usability%20Considerations"></a></body></html><a class="selflink" href="#section-6" id="section-6">6</a>.  Usability Considerations</span>

   This section is a non-normative discussion of usability
   considerations.





<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.1.%20%20User%20Code%20Recommendations"></a></body></html><a class="selflink" href="#section-6.1" id="section-6.1">6.1</a>.  User Code Recommendations</span>

   For many users, their nearest Internet-connected device will be their
   mobile phone, and typically these devices offer input methods that
   are more time consuming than a computer keyboard to change the case
   or input numbers.  To improve usability (improving entry speed, and
   reducing retries), these limitations should be taken into account
   when selecting the user-code character set.

   One way to improve input speed is to restrict the character set to
   case-insensitive A-Z characters, with no digits.  These characters
   can typically be entered on a mobile keyboard without using modifier
   keys.  Further removing vowels to avoid randomly creating words
   results in the base-20 character set: "BCDFGHJKLMNPQRSTVWXZ".  Dashes
   or other punctuation may be included for readability.

   An example user code following this guideline containing 8
   significant characters and dashes added for end-user readability,
   with a resulting entropy of 20^8: "WDJB-MJHT".

   Pure numeric codes are also a good choice for usability, especially
   for clients targeting locales where A-Z character keyboards are not
   used, though their length needs to be longer to maintain a high
   entropy.

   An example numeric user code containing 9 significant digits and
   dashes added for end-user readability, with an entropy of 10^9:
   "019-450-730".

   When processing the inputted user code, the server should strip
   dashes and other punctuation it added for readability (making the
   inclusion of that punctuation by the user optional).  For codes using
   only characters in the A-Z range as with the base-20 charset defined
   above, the user's input should be upper-cased before comparison to
   account for the fact that the user may input the equivalent lower-
   case characters.  Further stripping of all characters outside the
   user_code charset is recommended to reduce instances where an
   errantly typed character (like a space character) invalidates
   otherwise valid input.

   It is <em>RECOMMENDED</em> to avoid character sets that contain two or more
   characters that can easily be confused with each other like "0" and
   "O", or "1", "l" and "I".  Furthermore, the extent practical, where a
   character set contains one character that may be confused with
   characters outside the character set the character outside the set
   <em>MAY</em> be substituted with the one in the character set that it is
   commonly confused with (for example, "O" for "0" when using a
   numerical 0-9 character set).



<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.2.%20%20Non-Browser%20User%20Interaction"></a></body></html><a class="selflink" href="#section-6.2" id="section-6.2">6.2</a>.  Non-Browser User Interaction</span>

   Devices and authorization servers <em>MAY</em> negotiate an alternative code
   transmission and user interaction method in addition to the one
   described in <a href="#section-3.3">Section 3.3</a>.  Such an alternative user interaction flow
   could obviate the need for a browser and manual input of the code,
   for example, by using Bluetooth to transmit the code to the
   authorization server's companion app.  Such interaction methods can
   utilize this protocol, as ultimately, the user just needs to identify
   the authorization session to the authorization server; however, user
   interaction other than via the verification URI is outside the scope
   of this specification.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.%20%20IANA%20Considerations"></a></body></html><a class="selflink" href="#section-7" id="section-7">7</a>.  IANA Considerations</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.1.%20%20OAuth%20Parameters%20Registration"></a></body></html><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  OAuth Parameters Registration</span>

   This specification registers the following values in the IANA "OAuth
   Parameters" registry [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>] established by
   [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>].

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.1.1.%20%20Registry%20Contents"></a></body></html><a class="selflink" href="#section-7.1.1" id="section-7.1.1">7.1.1</a>.  Registry Contents</span>

   o  Parameter name: device_code
   o  Parameter usage location: token request
   o  Change controller: IESG
   o  Specification Document: <a href="#section-3.1">Section 3.1</a> of [[ this specification ]]

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.2.%20%20OAuth%20URI%20Registration"></a></body></html><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  OAuth URI Registration</span>

   This specification registers the following values in the IANA "OAuth
   URI" registry [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>] established by [<a href="/doc/html/rfc6755" title='"An IETF URN Sub-Namespace for OAuth"'>RFC6755</a>].

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.2.1.%20%20Registry%20Contents"></a></body></html><a class="selflink" href="#section-7.2.1" id="section-7.2.1">7.2.1</a>.  Registry Contents</span>

   o  URN: urn:ietf:params:oauth:grant-type:device_code
   o  Common Name: Device flow grant type for OAuth 2.0
   o  Change controller: IESG
   o  Specification Document: <a href="#section-3.1">Section 3.1</a> of [[ this specification ]]

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.3.%20%20OAuth%20Extensions%20Error%20Registration"></a></body></html><a class="selflink" href="#section-7.3" id="section-7.3">7.3</a>.  OAuth Extensions Error Registration</span>

   This specification registers the following values in the IANA "OAuth
   Extensions Error Registry" registry [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>]
   established by [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>].






<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.3.1.%20%20Registry%20Contents"></a></body></html><a class="selflink" href="#section-7.3.1" id="section-7.3.1">7.3.1</a>.  Registry Contents</span>

   o  Error name: authorization_pending
   o  Error usage location: Token endpoint response
   o  Related protocol extension: [[ this specification ]]
   o  Change controller: IETF
   o  Specification Document: <a href="#section-3.5">Section 3.5</a> of [[ this specification ]]

   o  Error name: access_denied
   o  Error usage location: Token endpoint response
   o  Related protocol extension: [[ this specification ]]
   o  Change controller: IETF
   o  Specification Document: <a href="#section-3.5">Section 3.5</a> of [[ this specification ]]

   o  Error name: slow_down
   o  Error usage location: Token endpoint response
   o  Related protocol extension: [[ this specification ]]
   o  Change controller: IETF
   o  Specification Document: <a href="#section-3.5">Section 3.5</a> of [[ this specification ]]

   o  Error name: expired_token
   o  Error usage location: Token endpoint response
   o  Related protocol extension: [[ this specification ]]
   o  Change controller: IETF
   o  Specification Document: <a href="#section-3.5">Section 3.5</a> of [[ this specification ]]

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.4.%20%20OAuth%202.0%20Authorization%20Server%20Metadata"></a></body></html><a class="selflink" href="#section-7.4" id="section-7.4">7.4</a>.  OAuth 2.0 Authorization Server Metadata</span>

   This specification registers the following values in the IANA "OAuth
   2.0 Authorization Server Metadata" registry [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>]
   established by [<a href="/doc/html/rfc8414" title='"OAuth 2.0 Authorization Server Metadata"'>RFC8414</a>].

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.4.1.%20%20Registry%20Contents"></a></body></html><a class="selflink" href="#section-7.4.1" id="section-7.4.1">7.4.1</a>.  Registry Contents</span>

   o  Metadata name: device_authorization_endpoint
   o  Metadata Description: The Device Authorization Endpoint.
   o  Change controller: IESG
   o  Specification Document: <a href="#section-4">Section 4</a> of [[ this specification ]]

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/8.%20%20Normative%20References"></a></body></html><a class="selflink" href="#section-8" id="section-8">8</a>.  Normative References</span>

   [<a id="ref-HTML5">HTML5</a>]    IANA, "HTML5",
              &lt;<a href="https://www.w3.org/TR/2014/REC-html5-20141028/">https://www.w3.org/TR/2014/REC-html5-20141028/</a>&gt;.

   [<a id="ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>]
              IANA, "OAuth Parameters",
              &lt;<a href="http://www.iana.org/assignments/oauth-parameters">http://www.iana.org/assignments/oauth-parameters</a>&gt;.




<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   [<a id="ref-RFC6749">RFC6749</a>]  Hardt, D., Ed., "The OAuth 2.0 Authorization Framework",
              <a href="/doc/html/rfc6749">RFC 6749</a>, DOI 10.17487/RFC6749, October 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;.

   [<a id="ref-RFC6755">RFC6755</a>]  Campbell, B. and H. Tschofenig, "An IETF URN Sub-Namespace
              for OAuth", <a href="/doc/html/rfc6755">RFC 6755</a>, DOI 10.17487/RFC6755, October 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6755">https://www.rfc-editor.org/info/rfc6755</a>&gt;.

   [<a id="ref-RFC6819">RFC6819</a>]  Lodderstedt, T., Ed., McGloin, M., and P. Hunt, "OAuth 2.0
              Threat Model and Security Considerations", <a href="/doc/html/rfc6819">RFC 6819</a>,
              DOI 10.17487/RFC6819, January 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6819">https://www.rfc-editor.org/info/rfc6819</a>&gt;.

   [<a id="ref-RFC7525">RFC7525</a>]  Sheffer, Y., Holz, R., and P. Saint-Andre,
              "Recommendations for Secure Use of Transport Layer
              Security (TLS) and Datagram Transport Layer Security
              (DTLS)", <a href="/doc/html/bcp195">BCP 195</a>, <a href="/doc/html/rfc7525">RFC 7525</a>, DOI 10.17487/RFC7525, May
              2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words", <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8252">RFC8252</a>]  Denniss, W. and J. Bradley, "OAuth 2.0 for Native Apps",
              <a href="/doc/html/bcp212">BCP 212</a>, <a href="/doc/html/rfc8252">RFC 8252</a>, DOI 10.17487/RFC8252, October 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8252">https://www.rfc-editor.org/info/rfc8252</a>&gt;.

   [<a id="ref-RFC8259">RFC8259</a>]  Bray, T., Ed., "The JavaScript Object Notation (JSON) Data
              Interchange Format", STD 90, <a href="/doc/html/rfc8259">RFC 8259</a>,
              DOI 10.17487/RFC8259, December 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;.

   [<a id="ref-RFC8414">RFC8414</a>]  Jones, M., Sakimura, N., and J. Bradley, "OAuth 2.0
              Authorization Server Metadata", <a href="/doc/html/rfc8414">RFC 8414</a>,
              DOI 10.17487/RFC8414, June 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;.

   [<a id="ref-RFC8446">RFC8446</a>]  Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", <a href="/doc/html/rfc8446">RFC 8446</a>, DOI 10.17487/RFC8446, August 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/Appendix%20A.%20%20Acknowledgements"></a></body></html><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  Acknowledgements</span>

   The starting point for this document was the Internet-Draft <a href="/doc/html/draft-recordon-oauth-v2-device">draft-</a>
   <a href="/doc/html/draft-recordon-oauth-v2-device">recordon-oauth-v2-device</a>, authored by David Recordon and Brent
   Goldman, which itself was based on content in draft versions of the
   OAuth 2.0 protocol specification removed prior to publication due to




<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 19]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-20"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   a then lack of sufficient deployment expertise.  Thank you to the
   OAuth working group members who contributed to those earlier drafts.

   This document was produced in the OAuth working group under the
   chairpersonship of Rifaat Shekh-Yusef and Hannes Tschofenig with
   Benjamin Kaduk, Kathleen Moriarty, and Eric Rescorla serving as
   Security Area Directors.

   The following individuals contributed ideas, feedback, and wording
   that shaped and formed the final specification:

   Alissa Cooper, Ben Campbell, Brian Campbell, Roshni Chandrashekhar,
   Eric Fazendin, Benjamin Kaduk, Jamshid Khosravian, Torsten
   Lodderstedt, James Manger, Dan McNulty, Breno de Medeiros, Simon
   Moffatt, Stein Myrseth, Emond Papegaaij, Justin Richer, Adam Roach,
   Nat Sakimura, Andrew Sciberras, Marius Scurtescu, Filip Skokan, Ken
   Wang, and Steven E. Wright.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/Appendix%20B.%20%20Document%20History"></a></body></html><a class="selflink" href="#appendix-B" id="appendix-B">Appendix B</a>.  Document History</span>

   [[ to be removed by the RFC Editor before publication as an RFC ]]

   -15

   o  Renamed and dropped most usage of the term "flow"
   o  Documented error responses on the authorization endpoint
   o  Documented client authentication for the authorization endpoint

   -14

   o  Added more normative text on polling behavior.
   o  Added discussion on risk of user retrieving their own device_code.
   o  Editorial improvements.

   -13

   o  Added a longer discussion about entropy, proposed by Benjamin
      Kaduk.
   o  Added device_code to OAuth IANA registry.
   o  Expanded explanation of "case insensitive".
   o  Added security section on Device Code Brute Forcing.
   o  application/x-www-form-urlencoded normativly referenced.
   o  Editorial improvements.

   -12

   o  Set a default polling interval to 5s explicitly.




<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 20]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-21"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   o  Defined the slow_down behavior that it should increase the current
      interval by 5s.
   o  expires_in now <em>REQUIRED</em>
   o  Other changes in response to review feedback.

   -11

   o  Updated reference to OAuth 2.0 Authorization Server Metadata.

   -10

   o  Added a missing definition of access_denied for use on the token
      endpoint.
   o  Corrected text documenting which error code should be returned for
      expired tokens (it's "expired_token", not "invalid_grant").
   o  Corrected section reference to <a href="/doc/html/rfc8252">RFC 8252</a> (the section numbers had
      changed after the initial reference was made).
   o  Fixed line length of one diagram (was causing xml2rfc warnings).
   o  Added line breaks so the URN grant_type is presented on an
      unbroken line.
   o  Typos fixed and other stylistic improvements.

   -09

   o  Addressed review comments by Security Area Director Eric Rescorla
      about the potential of a confused deputy attack.

   -08

   o  Expanded the User Code Brute Forcing section to include more
      detail on this attack.

   -07

   o  Replaced the "user_code" URI parameter optimization with
      verification_uri_complete following the IETF99 working group
      discussion.
   o  Added security consideration about spying.
   o  Required that device_code not be shown.
   o  Added text regarding a minimum polling interval.

   -06

   o  Clarified usage of the "user_code" URI parameter optimization
      following the IETF98 working group discussion.

   -05




<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 21]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-22"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   o  response_type parameter removed from authorization request.
   o  Added option for clients to include the user_code on the
      verification URI.
   o  Clarified token expiry, and other nits.

   -04

   o  Security &amp; Usability sections.  OAuth Discovery Metadata.

   -03

   o  device_code is now a URN.  Added IANA Considerations

   -02

   o  Added token request &amp; response specification.

   -01

   o  Applied spelling and grammar corrections and added the Document
      History appendix.

   -00

   o  Initial working group draft based on <a href="/doc/html/draft-recordon-oauth-v2-device">draft-recordon-oauth-</a>
      <a href="/doc/html/draft-recordon-oauth-v2-device">v2-device</a>.

Authors' Addresses

   William Denniss
   Google
   1600 Amphitheatre Pkwy
   Mountain View, CA  94043
   USA

   Email: wdenniss@google.com
   URI:   <a href="http://wdenniss.com/device-flow">http://wdenniss.com/device-flow</a>


   John Bradley
   Ping Identity

   Email: ve7jtb@ve7jtb.com
   URI:   <a href="http://www.thread-safe.com/">http://www.thread-safe.com/</a>







<span class="grey">Denniss, et al.        Expires September 12, 2019              [Page 22]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-23"></span>
<span class="grey">Internet-Draft           OAuth 2.0 Device Grant               March 2019</span>


   Michael B. Jones
   Microsoft

   Email: mbj@microsoft.com
   URI:   <a href="http://self-issued.info/">http://self-issued.info/</a>


   Hannes Tschofenig
   ARM Limited
   Austria

   Email: Hannes.Tschofenig@gmx.net
   URI:   <a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a>






































Denniss, et al.        Expires September 12, 2019              [Page 23]
</pre>
</div>
</div>
</div>
<script>$(".visible-nojs").removeClass("visible-nojs");</script>
<script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
<script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>
</body>
</html>
