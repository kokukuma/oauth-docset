<!DOCTYPE html>
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html --><html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<title>
  
    draft-ietf-oauth-jwt-introspection-response-12
  
</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>
<!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.38.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.38.0/respond/dest/respond.min.js"></script>
    <![endif]-->
<link href="/feed/document-changes/draft-ietf-oauth-jwt-introspection-response/" rel="alternate" title="Document changes" type="application/atom+xml"/>
<meta content="JWT Response for OAuth Token Introspection (Internet-Draft, 2021)" name="description"/>
<script src="https://www.ietf.org/lib/dt/7.38.0/d3/d3.min.js"></script>
<script src="https://www.ietf.org/lib/dt/7.38.0/jquery/jquery.min.js"></script>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/ietf-icon-blue3.png" rel="shortcut icon"/>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/apple-touch-icon.png" rel="apple-touch-icon"/>
</head>
<body style="padding-top: 0;">
<div class="content" id="content">
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
<div class="rfcmarkup">
<div class="noprint" style="height: 6px;">
<div class="meta-info bgred" onclick="showLegend();" onmouseout="hideLegend()" onmouseover="this.style.cursor='pointer';" style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; " title="Click for colour legend.">Â </div>
<div class="meta-info noprint pre legend" id="legend" onmouseout="hideLegend();" onmouseover="showLegend();" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
</div>
</div>
<div class="noprint">
<pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-jwt-introspection-response-12.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-jwt-introspection-response-12.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-jwt-introspection-response-12.xml" title="XML source for this document">xml</a>|<a href="https://tools.ietf.org/pdf/draft-ietf-oauth-jwt-introspection-response-12.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/draft-ietf-oauth-jwt-introspection-response/12/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/draft-ietf-oauth-jwt-introspection-response/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/oauth/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-oauth-jwt-introspection-response@ietf.org?subject=draft-ietf-oauth-jwt-introspection-response" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-oauth-jwt-introspection-response-12.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-oauth-jwt-introspection-response-12.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-oauth-jwt-introspection-response-12.txt" title="Run an idnits check of this document">Nits</a>]

Versions: (<a href="/doc/html/draft-lodderstedt-oauth-jwt-introspection-response">draft-lodderstedt-oauth-jwt-introspection-response</a>)          
          <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-00">00</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-01">01</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-02">02</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-03">03</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-04">04</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-05">05</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-06">06</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-07">07</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-08">08</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-09">09</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-10">10</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-11">11</a> <a href="/doc/html/draft-ietf-oauth-jwt-introspection-response-12"><b>12</b></a>         Standards Track
                                                                        </pre>
</div>
<div class="draftcontent">
<pre>Open Authentication Protocol                         T. Lodderstedt, Ed.
Internet-Draft                                                yes.com AG
Intended status: Standards Track                            V. Dzhuvinov
Expires: 8 March 2022                                    Connect2id Ltd.
                                                        4 September 2021


               <span class="h1">JWT Response for OAuth Token Introspection</span>
             <span class="h1">draft-ietf-oauth-jwt-introspection-response-12</span>

Abstract

   This specification proposes an additional JSON Web Token (JWT)
   secured response for OAuth 2.0 Token Introspection.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="/doc/html/bcp78">BCP 78</a> and <a href="/doc/html/bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 8 March 2022.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/</a>
   <a href="https://trustee.ietf.org/license-info">license-info</a>) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Simplified BSD License text
   as described in Section 4.e of the <a href="https://trustee.ietf.org/license-info">Trust Legal Provisions</a> and are
   provided without warranty as described in the Simplified BSD License.






<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                  [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Requirements Notation and Conventions . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Resource Server Management  . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-4">4</a>.  Requesting a JWT Response . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-5">5</a>.  JWT Response  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-6">6</a>.  Client Metadata . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-7">7</a>.  Authorization Server Metadata . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
   <a href="#section-8">8</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-8.1">8.1</a>.  Cross-JWT Confusion . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-8.2">8.2</a>.  Token Data Leakage  . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-9">9</a>.  Privacy Considerations  . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-10">10</a>. Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-11">11</a>. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     11.1.  OAuth Dynamic Client Registration Metadata
            Registration . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
       <a href="#section-11.1.1">11.1.1</a>.  Registry Contents  . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-11.2">11.2</a>.  OAuth Authorization Server Metadata Registration . . . .  <a href="#page-11">11</a>
       <a href="#section-11.2.1">11.2.1</a>.  Registry Contents  . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-11.3">11.3</a>.  Media Type Registration  . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
       <a href="#section-11.3.1">11.3.1</a>.  Registry Contents  . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-11.4">11.4</a>.  JWT Claim Registration . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
       <a href="#section-11.4.1">11.4.1</a>.  Registry Contents  . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-12">12</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-12.1">12.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-12.2">12.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
   <a href="#appendix-A">Appendix A</a>.  Document History . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.%20%20Introduction"></a></body></html><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   OAuth 2.0 Token Introspection [<a href="/doc/html/rfc7662" title='"OAuth 2.0 Token Introspection"'>RFC7662</a>] specifies a method for a
   protected resource to query an OAuth 2.0 authorization server to
   determine the state of an access token and obtain data associated
   with the access token.  This enables deployments to implement opaque
   access tokens in an interoperable way.

   The introspection response, as specified in OAuth 2.0 Token
   Introspection [<a href="/doc/html/rfc7662" title='"OAuth 2.0 Token Introspection"'>RFC7662</a>], is a plain JSON object.  However, there are
   use cases where the resource server requires stronger assurance that
   the authorization server issued the token introspection response for
   an access token, including cases where the authorization server
   assumes liability for the content of the token introspection
   response.  An example is a resource server using verified person data
   to create certificates, which in turn are used to create qualified
   electronic signatures.




<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                  [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   In such use cases it may be useful or even required to return a
   signed JWT [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>] as the introspection response.  This
   specification extends the token introspection endpoint with the
   capability to return responses as JWTs.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.%20%20Requirements%20Notation%20and%20Conventions"></a></body></html><a class="selflink" href="#section-2" id="section-2">2</a>.  Requirements Notation and Conventions</span>

   The key words "<em>MUST</em>", "<em>MUST NOT</em>", "<em>REQUIRED</em>", "<em>SHALL</em>", "<em>SHALL NOT</em>",
   "<em>SHOULD</em>", "<em>SHOULD NOT</em>", "<em>RECOMMENDED</em>", "NOT <em>RECOMMENDED</em>", "<em>MAY</em>", and
   "<em>OPTIONAL</em>" in this document are to be interpreted as described in <a href="/doc/html/bcp14">BCP</a>
   <a href="/doc/html/bcp14">14</a> [<a href="/doc/html/rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="/doc/html/rfc8174" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.%20%20Resource%20Server%20Management"></a></body></html><a class="selflink" href="#section-3" id="section-3">3</a>.  Resource Server Management</span>

   The authorization server (AS) and the resource server (RS) maintain a
   strong two-way trust relationship.  The resource server relies on the
   authorization server to obtain authorization, user and other data as
   input to its access control decisions and service delivery.  The
   authorization server relies on the resource server to handle the
   provided data appropriately.

   In the context of this specification, the token introspection
   endpoint is used to convey such security data and potentially also
   privacy sensitive data related to an access token.

   In order to process the introspection requests in a secure and
   privacy-preserving manner, the authorization server <em>MUST</em> be able to
   identify, authenticate and authorize resource servers.

   The authorization server <em>MAY</em> additionally encrypt the token
   introspection response JWTs.  If encryption is used the authorization
   server is provisioned with encryption keys and algorithms for the RS.

   The authorization server <em>MUST</em> be able to determine whether an RS is
   the audience for a particular access token and what data it is
   entitled to receive, otherwise the RS is not authorized to obtain
   data for the access token.  The AS has the discretion how to fulfil
   this requirement.  The AS could, for example, maintain a mapping
   between scope values and resource servers.

   The requirements given above imply that the authorization server
   maintains credentials and other configuration data for each RS.

   One way is by utilizing dynamic client registration [<a href="/doc/html/rfc7591" title='"OAuth 2.0 Dynamic Client Registration Protocol"'>RFC7591</a>] and
   treating every RS as an OAuth client.  In this case, the
   authorization server is assumed to at least maintain a "client_id"
   and a "token_endpoint_auth_method" with complementary authentication



<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                  [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   method metadata, such as "jwks" or "client_secret".  In cases where
   the AS needs to acquire consent to transmit data to a RS, the
   following client metadata fields are recommended: "client_name",
   "client_uri", "contacts", "tos_uri", "policy_uri".

   The AS <em>MUST</em> restrict the use of client credentials by a RS to the
   calls it requires, e.g. the AS <em>MAY</em> restrict such a client to call the
   token introspection endpoint only.  How the AS implements this
   restriction is beyond the scope of this specification.

   This specification further introduces client metadata to manage the
   configuration options required to sign and encrypt token
   introspection response JWTs.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.%20%20Requesting%20a%20JWT%20Response"></a></body></html><a class="selflink" href="#section-4" id="section-4">4</a>.  Requesting a JWT Response</span>

   A resource server requests a JWT introspection response by sending an
   introspection request with an "Accept" HTTP header field set to
   "application/token-introspection+jwt".

   The AS <em>MUST</em> authenticate the caller at the token introspection
   endpoint.  Authentication can utilize client authentication methods
   or a separate access token issued to the resource server and
   identifying it as subject.

   The following is a non-normative example request, with the resource
   server authenticating with a private key JWT:

   POST /introspect HTTP/1.1
   Host: as.example.com
   Accept: application/token-introspection+jwt
   Content-Type: application/x-www-form-urlencoded

   token=2YotnFZFEjr1zCsicMWpAA&amp;
   client_assertion_type=
    urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer&amp;
   client_assertion=PHNhbWxwOl[...omitted for brevity...]ZT

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.%20%20JWT%20Response"></a></body></html><a class="selflink" href="#section-5" id="section-5">5</a>.  JWT Response</span>

   The introspection endpoint responds with a JWT, setting the "Content-
   Type" HTTP header field to "application/token-introspection+jwt" and
   the JWT "typ" ("type") header parameter to "token-introspection+jwt".

   The JWT <em>MUST</em> include the following top-level claims:

   iss     <em>MUST</em> be set to the issuer URL of the authorization server.




<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                  [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   aud     <em>MUST</em> identify the resource server receiving the token
           introspection response.

   iat     <em>MUST</em> be set to the time when the introspection response was
           created by the authorization server.

   token_introspection  A JSON object containing the members of the
           token introspection response as specified in <a href="/doc/html/rfc7662#section-2.2">[RFC7662],
           sectionÂ 2.2</a>.  The separation of the introspection response
           members into a dedicated containing JWT claim is intended to
           prevent conflict and confusion with top-level JWT claims that
           may bear the same name.

           If the access token is invalid, expired, revoked, or not
           intended for the calling resource server (audience), the
           authorization server <em>MUST</em> set the value of the "active"
           member in the "token_introspection" claim to "false" and <em>MUST</em>
           NOT include other members.  Otherwise, the "active" member is
           set to "true".

           The AS <em>SHOULD</em> narrow down the "scope" value to the scopes
           relevant to the particular RS.

           As specified in <a href="/doc/html/rfc7662#section-2.2">sectionÂ 2.2 of [RFC7662]</a>, implementations <em>MAY</em>
           extend the token introspection response with service-specific
           claims.  In the context of this specification, such claims
           will be added as top-level members of the
           "token_introspection" claim.

           Token introspection response parameter names intended to be
           used across domains <em>MUST</em> be registered in the OAuth Token
           Introspection Response registry
           [<a href="#ref-IANA.OAuth.Token.Introspection">IANA.OAuth.Token.Introspection</a>] defined by [<a href="/doc/html/rfc7662" title='"OAuth 2.0 Token Introspection"'>RFC7662</a>].

           When the AS acts as a provider of resource owner identity
           claims to the RS, the AS determines based on its RS-specific
           policy what identity claims to return in the token
           introspection response.  The AS <em>MUST</em> ensure the release of
           any privacy-sensitive data is legally based (see <a href="#section-9">Section 9</a>).

           Further content of the introspection response is determined
           by the RS-specific policy at the AS.

   The JWT <em>MAY</em> include other claims, including those from the "JSON Web
   Token Claims" registry established by [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>].  The JWT <em>SHOULD NOT</em>
   include the "sub" and "exp" claims, as an additional prevention
   against misuse of the JWT as an access token (see <a href="#section-8.1">Section 8.1</a>).




<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                  [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   Note: Although the JWT format is widely used as an access token
   format, the JWT returned in the introspection response is not an
   alternative representation of the introspected access token and is
   not intended to be used as an access token.

   This specification registers the "application/token-
   introspection+jwt" media type, which is used as value of the "typ"
   ("type") header parameter of the JWT to indicate that the payload is
   a token introspection response.

   The JWT is cryptographically secured as specified in [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>].

   Depending on the specific resource server policy the JWT is either
   signed, or signed and encrypted.  If the JWT is signed and encrypted
   it <em>MUST</em> be a Nested JWT, as defined in JWT [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>].

   Note: An AS compliant with this specification <em>MUST</em> refuse to serve
   introspection requests that don't authenticate the caller, and return
   an HTTP status code 400.  This is done to ensure token data is
   released to legitimate recipients only and prevent downgrading to
   [<a href="/doc/html/rfc7662" title='"OAuth 2.0 Token Introspection"'>RFC7662</a>] behavior (see <a href="#section-8.2">Section 8.2</a>).

   The following is a non-normative example response (with line breaks
   for display purposes only):

   HTTP/1.1 200 OK
   Content-Type: application/token-introspection+jwt

   eyJraWQiOiJ3RzZEIiwidHlwIjoidG9rZW4taW50cm9zcGVjdGlvbitqd3QiLCJhbGc
   iOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL2FzLmV4YW1wbGUuY29tLyIsImF1ZCI6I
   mh0dHBzOi8vcnMuZXhhbXBsZS5jb20vcmVzb3VyY2UiLCJpYXQiOjE1MTQ3OTc4OTIs
   InRva2VuX2ludHJvc3BlY3Rpb24iOnsiYWN0aXZlIjp0cnVlLCJpc3MiOiJodHRwczo
   vL2FzLmV4YW1wbGUuY29tLyIsImF1ZCI6Imh0dHBzOi8vcnMuZXhhbXBsZS5jb20vcm
   Vzb3VyY2UiLCJpYXQiOjE1MTQ3OTc4MjIsImV4cCI6MTUxNDc5Nzk0MiwiY2xpZW50X
   2lkIjoicGFpQjJnb28wYSIsInNjb3BlIjoicmVhZCB3cml0ZSBkb2xwaGluIiwic3Vi
   IjoiWjVPM3VwUEM4OFFyQWp4MDBkaXMiLCJiaXJ0aGRhdGUiOiIxOTgyLTAyLTAxIiw
   iZ2l2ZW5fbmFtZSI6IkpvaG4iLCJmYW1pbHlfbmFtZSI6IkRvZSIsImp0aSI6InQxRm
   9DQ2FaZDRYdjRPUkpVV1ZVZVRaZnNLaFczMENRQ3JXRERqd1h5NncifX0.przJMU5Gh
   mNzvwtt1Sr-xa9xTkpiAg5IshbQsRiRVP_7eGR1GHYrNwQh84kxOkHCyje2g5WSRcYo
   sGEVIiC-eoPJJ-qBwqwSlgx9JEeCDw2W5DjrblOI_N0Jvsq_dUeOyoWVMqlOydOBhKN
   Y0smBrI4NZvEExucOm9WUJXMuJtvq1gBes-0go5j4TEv9sOP9uu81gqWTr_LOo6pgT0
   tFFyZfWC4kbXPXiQ2YT6mxCiQRRNM-l9cBdF6Jx6IOrsfFhBuYdYQ_mlL19HgDDOFal
   eyqmru6lKlASOsaE8dmLSeKcX91FbG79FKN8un24iwIDCbKT9xlUFl54xWVShNDFA

   The example response JWT header contains the following JSON document:






<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                  [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   {
     "typ": "token-introspection+jwt",
     "alg": "RS256",
     "kid": "wG6D"
   }

   The example response JWT payload contains the following JSON
   document:

   {
     "iss":"https://as.example.com/",
     "aud":"https://rs.example.com/resource",
     "iat":1514797892,
     "token_introspection":
        {
           "active":true,
           "iss":"https://as.example.com/",
           "aud":"https://rs.example.com/resource",
           "iat":1514797822,
           "exp":1514797942,
           "client_id":"paiB2goo0a",
           "scope":"read write dolphin",
           "sub":"Z5O3upPC88QrAjx00dis",
           "birthdate":"1982-02-01",
           "given_name":"John",
           "family_name":"Doe",
           "jti":"t1FoCCaZd4Xv4ORJUWVUeTZfsKhW30CQCrWDDjwXy6w"
        }
   }

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.%20%20Client%20Metadata"></a></body></html><a class="selflink" href="#section-6" id="section-6">6</a>.  Client Metadata</span>

   The authorization server determines the algorithm to secure the JWT
   for a particular introspection response.  This decision can be based
   on registered metadata parameters for the resource server, supplied
   via dynamic client registration [<a href="/doc/html/rfc7591" title='"OAuth 2.0 Dynamic Client Registration Protocol"'>RFC7591</a>] with the resource server
   acting as a client, as specified below.

   The parameter names follow the pattern established by OpenID Connect
   Dynamic Client Registration [<a href="#ref-OpenID.Registration">OpenID.Registration</a>] for configuring
   signing and encryption algorithms for JWT responses at the UserInfo
   endpoint.

   The following client metadata parameters are introduced by this
   specification:

   introspection_signed_response_alg  <em>OPTIONAL</em>.  JWS [<a href="/doc/html/rfc7515" title='"JSON Web Signature (JWS)"'>RFC7515</a>] algorithm




<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                  [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


           ("alg" value) as defined in JWA [<a href="/doc/html/rfc7518" title='"JSON Web Algorithms (JWA)"'>RFC7518</a>] for signing
           introspection responses.  If this is specified, the response
           will be signed using JWS and the configured algorithm.  The
           default, if omitted, is "RS256".

   introspection_encrypted_response_alg  <em>OPTIONAL</em>.  JWE [<a href="/doc/html/rfc7516" title='"JSON Web Encryption (JWE)"'>RFC7516</a>]
           algorithm ("alg" value) as defined in JWA [<a href="/doc/html/rfc7518" title='"JSON Web Algorithms (JWA)"'>RFC7518</a>] for
           content key encryption.  If this is specified, the response
           will be encrypted using JWE and the configured content
           encryption algorithm
           ("introspection_encrypted_response_enc").  The default, if
           omitted, is that no encryption is performed.  If both signing
           and encryption are requested, the response will be signed
           then encrypted, with the result being a Nested JWT, as
           defined in JWT [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>].

   introspection_encrypted_response_enc  <em>OPTIONAL</em>.  JWE [<a href="/doc/html/rfc7516" title='"JSON Web Encryption (JWE)"'>RFC7516</a>]
           algorithm ("enc" value) as defined in JWA [<a href="/doc/html/rfc7518" title='"JSON Web Algorithms (JWA)"'>RFC7518</a>] for
           content encryption of introspection responses.  The default,
           if omitted, is "A128CBC-HS256".  Note: This parameter <em>MUST</em>
           NOT be specified without setting
           "introspection_encrypted_response_alg".

   Resource servers may register their public encryption keys using the
   "jwks_uri" or "jwks" metadata parameters.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.%20%20Authorization%20Server%20Metadata"></a></body></html><a class="selflink" href="#section-7" id="section-7">7</a>.  Authorization Server Metadata</span>

   Authorization servers <em>SHOULD</em> publish the supported algorithms for
   signing and encrypting the JWT of an introspection response by
   utilizing OAuth 2.0 Authorization Server Metadata [<a href="/doc/html/rfc8414" title='"OAuth 2.0 Authorization Server Metadata"'>RFC8414</a>]
   parameters.  Resource servers use this data to parametrize their
   client registration requests.

   The following parameters are introduced by this specification:

   introspection_signing_alg_values_supported  <em>OPTIONAL</em>.  JSON array
           containing a list of the JWS [<a href="/doc/html/rfc7515" title='"JSON Web Signature (JWS)"'>RFC7515</a>] signing algorithms
           ("alg" values) as defined in JWA [<a href="/doc/html/rfc7518" title='"JSON Web Algorithms (JWA)"'>RFC7518</a>] supported by the
           introspection endpoint to sign the response.

   introspection_encryption_alg_values_supported  <em>OPTIONAL</em>.  JSON array
           containing a list of the JWE [<a href="/doc/html/rfc7516" title='"JSON Web Encryption (JWE)"'>RFC7516</a>] encryption algorithms
           ("alg" values) as defined in JWA [<a href="/doc/html/rfc7518" title='"JSON Web Algorithms (JWA)"'>RFC7518</a>] supported by the
           introspection endpoint to encrypt the content encryption key
           for introspection responses (content key encryption).

   introspection_encryption_enc_values_supported  <em>OPTIONAL</em>.  JSON array



<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                  [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


           containing a list of the JWE [<a href="/doc/html/rfc7516" title='"JSON Web Encryption (JWE)"'>RFC7516</a>] encryption algorithms
           ("enc" values) as defined in JWA [<a href="/doc/html/rfc7518" title='"JSON Web Algorithms (JWA)"'>RFC7518</a>] supported by the
           introspection endpoint to encrypt the response (content
           encryption).

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/8.%20%20Security%20Considerations"></a></body></html><a class="selflink" href="#section-8" id="section-8">8</a>.  Security Considerations</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/8.1.%20%20Cross-JWT%20Confusion"></a></body></html><a class="selflink" href="#section-8.1" id="section-8.1">8.1</a>.  Cross-JWT Confusion</span>

   The "iss" and potentially the "aud" claim of a token introspection
   JWT can resemble those of a JWT-encoded access token.  An attacker
   could try to exploit this and pass a JWT token introspection response
   as an access token to the resource server.  The "typ" ("type") JWT
   header "token-introspection+jwt" and the encapsulation of the token
   introspection members such as "sub" and "scope" in the
   "token_introspection" claim is intended to prevent such substitution
   attacks.  Resource servers <em>MUST</em> therefore check the "typ" JWT header
   value of received JWT-encoded access tokens and ensure all minimally
   required claims for a valid access token are present.

   Resource servers <em>MUST</em> additionally apply the countermeasures against
   replay as described in [<a href="#ref-I-D.ietf-oauth-security-topics">I-D.ietf-oauth-security-topics</a>], section 3.2.

   JWT Confusion and other attacks involving JWTs are discussed in
   [<a href="#ref-I-D.ietf-oauth-jwt-bcp">I-D.ietf-oauth-jwt-bcp</a>].

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/8.2.%20%20Token%20Data%20Leakage"></a></body></html><a class="selflink" href="#section-8.2" id="section-8.2">8.2</a>.  Token Data Leakage</span>

   The authorization server <em>MUST</em> use Transport Layer Security (TLS) 1.2
   (or higher) per <a href="/doc/html/bcp195">BCP 195</a> [<a href="/doc/html/rfc7525" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>RFC7525</a>] in order to prevent token data
   leakage.

   <a href="/doc/html/rfc7662#section-2.1">SectionÂ 2.1 of [RFC7662]</a> permits requests to the introspection
   endpoint to be authorized with an access token which doesn't identify
   the caller.  To prevent introspection of tokens by parties that are
   not the intended consumer the authorization server <em>MUST</em> require all
   requests to the token introspection endpoint to be authenticated.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.%20%20Privacy%20Considerations"></a></body></html><a class="selflink" href="#section-9" id="section-9">9</a>.  Privacy Considerations</span>

   The token introspection response can be used to transfer personal
   identifiable information (PII) from the AS to the RS.  The AS <em>MUST</em>
   conform to legal and jurisdictional constraints for the data transfer
   before any data is released to a particular RS.  The details and
   determining of these constraints varies by jurisdiction and is
   outside the scope of this document.





<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                  [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   A commonly found way to establish the legal basis for releasing PII
   is by explicit user consent gathered from the resource owner by the
   AS during the authorization flow.

   It is also possible that the legal basis is established out of band,
   for example in an explicit contract or by the client gathering the
   resource owner's consent.

   If the AS and the RS belong to the same legal entity (1st party
   scenario), there is potentially no need for an explicit user consent
   but the terms of service and policy of the respective service
   provider <em>MUST</em> be enforced at all times.

   In any case, the AS <em>MUST</em> ensure that the scope of the legal basis is
   enforced throughout the whole process.  The AS <em>MUST</em> retain the scope
   of the legal basis with the access token, e.g. in the scope value, it
   <em>MUST</em> authenticate the RS, and the AS <em>MUST</em> determine the data a
   resource server is allowed to receive based on the resource server's
   identity and suitable token data, e.g. the scope value.

   Implementers should be aware that a token introspection request lets
   the AS know when the client (and potentially the user) is accessing
   the RS, which is also an indication of when the user is using the
   client.  If this implication is not acceptable, implementers <em>MUST</em> use
   other means to relay access token data, for example by directly
   transferring the data needed by the RS within the access token.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/10.%20%20Acknowledgements"></a></body></html><a class="selflink" href="#section-10" id="section-10">10</a>.  Acknowledgements</span>

   We would like to thank Petteri Stenius, Neil Madden, Filip Skokan,
   Tony Nadalin, Remco Schaar, Justin Richer, Takahiko Kawasaki,
   Benjamin Kaduk, Robert Wilton and Roman Danyliw for their valuable
   feedback.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.%20%20IANA%20Considerations"></a></body></html><a class="selflink" href="#section-11" id="section-11">11</a>.  IANA Considerations</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.1.%20%20OAuth%20Dynamic%20Client%20Registration%20Metadata%20Registration"></a></body></html><a class="selflink" href="#section-11.1" id="section-11.1">11.1</a>.  OAuth Dynamic Client Registration Metadata Registration</span>

   This specification requests registration of the following client
   metadata definitions in the IANA "OAuth Dynamic Client Registration
   Metadata" registry [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>] established by [<a href="/doc/html/rfc7591" title='"OAuth 2.0 Dynamic Client Registration Protocol"'>RFC7591</a>]:

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.1.1.%20%20Registry%20Contents"></a></body></html><a class="selflink" href="#section-11.1.1" id="section-11.1.1">11.1.1</a>.  Registry Contents</span>

   *  Client Metadata Name: "introspection_signed_response_alg"

   *  Client Metadata Description: String value indicating the client's
      desired introspection response signing algorithm.



<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                 [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   *  Change Controller: IESG

   *  Specification Document(s): <a href="#section-6">Section 6</a> of [[ this specification ]]

   *  Client Metadata Name: "introspection_encrypted_response_alg"

   *  Client Metadata Description: String value specifying the desired
      introspection response content key encryption algorithm (alg
      value).

   *  Change Controller: IESG

   *  Specification Document(s): <a href="#section-6">Section 6</a> of [[ this specification ]]

   *  Client Metadata Name: "introspection_encrypted_response_enc"

   *  Client Metadata Description: String value specifying the desired
      introspection response content encryption algorithm (enc value).

   *  Change Controller: IESG

   *  Specification Document(s): <a href="#section-6">Section 6</a> of [[ this specification ]]

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.2.%20%20OAuth%20Authorization%20Server%20Metadata%20Registration"></a></body></html><a class="selflink" href="#section-11.2" id="section-11.2">11.2</a>.  OAuth Authorization Server Metadata Registration</span>

   This specification requests registration of the following values in
   the IANA "OAuth Authorization Server Metadata" registry
   [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>] established by [<a href="/doc/html/rfc8414" title='"OAuth 2.0 Authorization Server Metadata"'>RFC8414</a>].

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.2.1.%20%20Registry%20Contents"></a></body></html><a class="selflink" href="#section-11.2.1" id="section-11.2.1">11.2.1</a>.  Registry Contents</span>

   *  Metadata Name: "introspection_signing_alg_values_supported"

   *  Metadata Description: JSON array containing a list of algorithms
      supported by the authorization server for introspection response
      signing.

   *  Change Controller: IESG

   *  Specification Document(s): <a href="#section-7">Section 7</a> of [[ this specification ]]

   *  Metadata Name: "introspection_encryption_alg_values_supported"

   *  Metadata Description: JSON array containing a list of algorithms
      supported by the authorization server for introspection response
      content key encryption (alg value).

   *  Change Controller: IESG



<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                 [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   *  Specification Document(s): <a href="#section-7">Section 7</a> of [[ this specification ]]

   *  Metadata Name: "introspection_encryption_enc_values_supported"

   *  Metadata Description: JSON array containing a list of algorithms
      supported by the authorization server for introspection response
      content encryption (enc value).

   *  Change Controller: IESG

   *  Specification Document(s): <a href="#section-7">Section 7</a> of [[ this specification ]]

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.3.%20%20Media%20Type%20Registration"></a></body></html><a class="selflink" href="#section-11.3" id="section-11.3">11.3</a>.  Media Type Registration</span>

   This section registers the "application/token-introspection+jwt"
   media type in the "Media Types" registry [<a href="#ref-IANA.MediaTypes">IANA.MediaTypes</a>] in the
   manner described in [<a href="/doc/html/rfc6838" title='"Media Type Specifications and Registration Procedures"'>RFC6838</a>], which can be used to indicate that the
   content is a token introspection response in JWT format.

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.3.1.%20%20Registry%20Contents"></a></body></html><a class="selflink" href="#section-11.3.1" id="section-11.3.1">11.3.1</a>.  Registry Contents</span>

   *  Type name: application

   *  Subtype name: token-introspection+jwt

   *  Required parameters: N/A

   *  Optional parameters: N/A

   *  Encoding considerations: binary; A token introspection response is
      a JWT; JWT values are encoded as a series of base64url-encoded
      values (with trailing '=' characters removed), some of which may
      be the empty string, separated by period ('.') characters.

   *  Security considerations: See <a href="#section-7">Section 7</a> of this specification

   *  Interoperability considerations: N/A

   *  Published specification: <a href="#section-4">Section 4</a> of this specification

   *  Applications that use this media type: Applications that produce
      and consume OAuth Token Introspection Responses in JWT format

   *  Fragment identifier considerations: N/A

   *  Additional information:

      -  Magic number(s): N/A



<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                 [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


      -  File extension(s): N/A

      -  Macintosh file type code(s): N/A

   *  Person &amp; email address to contact for further information: Torsten
      Lodderstedt, torsten@lodderstedt.net

   *  Intended usage: COMMON

   *  Restrictions on usage: none

   *  Author: Torsten Lodderstedt, torsten@lodderstedt.net

   *  Change controller: IESG

   *  Provisional registration?  No

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.4.%20%20JWT%20Claim%20Registration"></a></body></html><a class="selflink" href="#section-11.4" id="section-11.4">11.4</a>.  JWT Claim Registration</span>

   This section registers the "token_introspection" claim in the JSON
   Web Token (JWT) IANA registry [<a href="#ref-IANA.JWT" title='"JSON Web Token (JWT) claims registry"'>IANA.JWT</a>] in the manner described in
   [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>].

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/11.4.1.%20%20Registry%20Contents"></a></body></html><a class="selflink" href="#section-11.4.1" id="section-11.4.1">11.4.1</a>.  Registry Contents</span>

   *  Claim name: token_introspection

   *  Claim description: Token introspection response

   *  Change Controller: IESG

   *  Specification Document(s): <a href="#section-5">Section 5</a> of [[this specification]]

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/12.%20%20References"></a></body></html><a class="selflink" href="#section-12" id="section-12">12</a>.  References</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/12.1.%20%20Normative%20References"></a></body></html><a class="selflink" href="#section-12.1" id="section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-I-D.ietf-oauth-jwt-bcp">I-D.ietf-oauth-jwt-bcp</a>]
              Sheffer, Y., Hardt, D., and M. Jones, "JSON Web Token Best
              Current Practices", Work in Progress, Internet-Draft,
              <a href="/doc/html/draft-ietf-oauth-jwt-bcp-06">draft-ietf-oauth-jwt-bcp-06</a>, 7 June 2019,
              &lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-jwt-bcp-06.txt">http://www.ietf.org/internet-drafts/draft-ietf-oauth-jwt-</a>
              <a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-jwt-bcp-06.txt">bcp-06.txt</a>&gt;.








<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                 [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   [<a id="ref-I-D.ietf-oauth-security-topics">I-D.ietf-oauth-security-topics</a>]
              Lodderstedt, T., Bradley, J., Labunets, A., and D. Fett,
              "OAuth 2.0 Security Best Current Practice", Work in
              Progress, Internet-Draft, <a href="/doc/html/draft-ietf-oauth-security-topics-13">draft-ietf-oauth-security-</a>
              <a href="/doc/html/draft-ietf-oauth-security-topics-13">topics-13</a>, 8 July 2019, &lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-security-topics-13.txt">http://www.ietf.org/internet-</a>
              <a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-security-topics-13.txt">drafts/draft-ietf-oauth-security-topics-13.txt</a>&gt;.

   [<a id="ref-IANA.JWT">IANA.JWT</a>] IANA, "JSON Web Token (JWT) claims registry",
              &lt;<a href="https://www.iana.org/assignments/jwt/jwt.xhtml#claims">https://www.iana.org/assignments/jwt/jwt.xhtml#claims</a>&gt;.

   [<a id="ref-IANA.MediaTypes">IANA.MediaTypes</a>]
              IANA, "Media Types",
              &lt;<a href="http://www.iana.org/assignments/media-types">http://www.iana.org/assignments/media-types</a>&gt;.

   [<a id="ref-IANA.OAuth.Token.Introspection">IANA.OAuth.Token.Introspection</a>]
              IANA, "OAuth Token Introspection Response registry",
              &lt;<a href="https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#token-introspection-response">https://www.iana.org/assignments/oauth-parameters/oauth-</a>
              <a href="https://www.iana.org/assignments/oauth-parameters/oauth-parameters.xhtml#token-introspection-response">parameters.xhtml#token-introspection-response</a>&gt;.

   [<a id="ref-OpenID.Registration">OpenID.Registration</a>]
              Sakimura, N., Bradley, J., and M. Jones, "OpenID Connect
              Dynamic Client Registration 1.0 incorporating errata set
              1", 8 November 2014, &lt;<a href="https://openid.net/specs/openid-connect-registration-1_0.html">https://openid.net/specs/openid-</a>
              <a href="https://openid.net/specs/openid-connect-registration-1_0.html">connect-registration-1_0.html</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC6838">RFC6838</a>]  Freed, N., Klensin, J., and T. Hansen, "Media Type
              Specifications and Registration Procedures", <a href="/doc/html/bcp13">BCP 13</a>,
              <a href="/doc/html/rfc6838">RFC 6838</a>, DOI 10.17487/RFC6838, January 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;.

   [<a id="ref-RFC7515">RFC7515</a>]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web
              Signature (JWS)", <a href="/doc/html/rfc7515">RFC 7515</a>, DOI 10.17487/RFC7515, May
              2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;.

   [<a id="ref-RFC7516">RFC7516</a>]  Jones, M. and J. Hildebrand, "JSON Web Encryption (JWE)",
              <a href="/doc/html/rfc7516">RFC 7516</a>, DOI 10.17487/RFC7516, May 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7516">https://www.rfc-editor.org/info/rfc7516</a>&gt;.

   [<a id="ref-RFC7518">RFC7518</a>]  Jones, M., "JSON Web Algorithms (JWA)", <a href="/doc/html/rfc7518">RFC 7518</a>,
              DOI 10.17487/RFC7518, May 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;.





<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                 [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   [<a id="ref-RFC7519">RFC7519</a>]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
              (JWT)", <a href="/doc/html/rfc7519">RFC 7519</a>, DOI 10.17487/RFC7519, May 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;.

   [<a id="ref-RFC7525">RFC7525</a>]  Sheffer, Y., Holz, R., and P. Saint-Andre,
              "Recommendations for Secure Use of Transport Layer
              Security (TLS) and Datagram Transport Layer Security
              (DTLS)", <a href="/doc/html/bcp195">BCP 195</a>, <a href="/doc/html/rfc7525">RFC 7525</a>, DOI 10.17487/RFC7525, May
              2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;.

   [<a id="ref-RFC7591">RFC7591</a>]  Richer, J., Ed., Jones, M., Bradley, J., Machulak, M., and
              P. Hunt, "OAuth 2.0 Dynamic Client Registration Protocol",
              <a href="/doc/html/rfc7591">RFC 7591</a>, DOI 10.17487/RFC7591, July 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7591">https://www.rfc-editor.org/info/rfc7591</a>&gt;.

   [<a id="ref-RFC7662">RFC7662</a>]  Richer, J., Ed., "OAuth 2.0 Token Introspection",
              <a href="/doc/html/rfc7662">RFC 7662</a>, DOI 10.17487/RFC7662, October 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7662">https://www.rfc-editor.org/info/rfc7662</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words", <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8414">RFC8414</a>]  Jones, M., Sakimura, N., and J. Bradley, "OAuth 2.0
              Authorization Server Metadata", <a href="/doc/html/rfc8414">RFC 8414</a>,
              DOI 10.17487/RFC8414, June 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/12.2.%20%20Informative%20References"></a></body></html><a class="selflink" href="#section-12.2" id="section-12.2">12.2</a>.  Informative References</span>

   [<a id="ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>]
              IANA, "OAuth Parameters",
              &lt;<a href="http://www.iana.org/assignments/oauth-parameters">http://www.iana.org/assignments/oauth-parameters</a>&gt;.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/Appendix%20A.%20%20Document%20History"></a></body></html><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  Document History</span>

   [[ To be removed from the final specification ]]

   -12

   *  made registration of response parameters intended for cross domain
      use a <em>MUST</em> ( in <a href="/doc/html/rfc7662">RFC 7662</a>)

   -11

   *  consistent normative language that the AS must authenticate all
      callers to the token introspection endpoint when complying with
      this specification



<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                 [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   *  removes text that claims from the JSON Web Token Claims registry
      may be included in the token_introspection claim

   *  updates the privacy considerations section

   *  fixes the example BASE64URL encoded JWT payload

   -10

   *  added requirement to authenticate RS if privacy sensitive data is
      released

   *  reworked text on claims from different registries

   *  added forward reference to privacy considerations to <a href="#section-5">section 5</a>

   *  added text in privacy considerations regarding client/user
      tracking

   -09

   *  changes the Accept and Content-Type HTTP headers from
      "application/json" to "application/token-introspection+jwt" so
      they match the registered media type

   *  moves the token introspection response members into a JSON object
      claim named "token_introspection" to provide isolation from the
      top-level JWT-specific claims

   *  "iss", "aud" and "iat" <em>MUST</em> be present as top-level JWT claims

   *  the "sub" and "exp" claims <em>SHOULD NOT</em> be used as top-level JWT
      claims as additional prevention against JWT access token
      substitution attacks

   -08

   *  made difference between introspected access token and
      introspection response clearer

   *  defined semantics of JWT claims overlapping between introspected
      access token and introspection response as JWT

   *  added section about RS management

   *  added text about user claims including a privacy considerations
      section




<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                 [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   *  removed registration of OpenID Connect claims to "Token
      Introspection Response" registry and refer to "JWT Claims"
      registry instead

   *  added registration of "application/token-introspection+jwt" media
      type as type identifier of token introspection responses in JWT
      format

   *  more changed to incorporate IESG review feedback

   -07

   *  fixed wrong description of "locale"

   *  added references for ISO and ITU specifications

   -06

   *  replaced reference to <a href="/doc/html/rfc7159">RFC 7159</a> with reference to <a href="/doc/html/rfc8259">RFC 8259</a>

   -05

   *  improved wording for TLS requirement

   *  added <a href="/doc/html/rfc2119">RFC 2119</a> boilerplate

   *  fixed and updated some references

   -04

   *  reworked definition of parameters in <a href="#section-4">section 4</a>

   *  added text on data minimization to security considerations section

   *  added statement regarding TLS to security considerations section

   -03

   *  added registration for OpenID Connect Standard Claims to OAuth
      Token Introspection Response registry

   -02

   *  updated references

   -01





<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                 [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   *  adapted wording to preclude any accept header except "application/
      jwt" if encrypted responses are required

   *  use registered alg value RS256 for default signing algorithm

   *  added text on claims in the token introspection response

   -00

   *  initial version of the WG draft

   *  defined default signing algorithm

   *  changed behavior in case resource server is set up for encryption

   *  Added text on token data leakage prevention to the security
      considerations

   *  moved Security Considerations section forward

   WG draft

   -01

   *  fixed typos in client meta data field names

   *  added OAuth Server Metadata parameters to publish algorithms
      supported for signing and encrypting the introspection response

   *  added registration of new parameters for OAuth Server Metadata and
      Client Registration

   *  added explicit request for JWT introspection response

   *  made iss and aud claims mandatory in introspection response

   *  Stylistic and clarifying edits, updates references

   -00

   *  initial version

Authors' Addresses

   Torsten Lodderstedt (editor)
   yes.com AG

   Email: torsten@lodderstedt.net



<span class="grey">Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                 [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey">Internet-Draft                JWT Response                September 2021</span>


   Vladimir Dzhuvinov
   Connect2id Ltd.

   Email: vladimir@connect2id.com















































Lodderstedt &amp; Dzhuvinov   Expires 8 March 2022                 [Page 19]
</pre>
</div>
</div>
</div>
<script>$(".visible-nojs").removeClass("visible-nojs");</script>
<script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
<script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>
</body>
</html>
