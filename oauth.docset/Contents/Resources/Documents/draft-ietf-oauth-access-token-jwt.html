<!DOCTYPE html>
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html --><html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<title>
  
    draft-ietf-oauth-access-token-jwt-13
  
</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>
<!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.38.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.38.0/respond/dest/respond.min.js"></script>
    <![endif]-->
<link href="/feed/document-changes/draft-ietf-oauth-access-token-jwt/" rel="alternate" title="Document changes" type="application/atom+xml"/>
<meta content="JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens (Internet-Draft, 2021)" name="description"/>
<script src="https://www.ietf.org/lib/dt/7.38.0/d3/d3.min.js"></script>
<script src="https://www.ietf.org/lib/dt/7.38.0/jquery/jquery.min.js"></script>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/ietf-icon-blue3.png" rel="shortcut icon"/>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/apple-touch-icon.png" rel="apple-touch-icon"/>
</head>
<body style="padding-top: 0;">
<div class="content" id="content">
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
<div class="rfcmarkup">
<div class="noprint" style="height: 6px;">
<div class="meta-info bgred" onclick="showLegend();" onmouseout="hideLegend()" onmouseover="this.style.cursor='pointer';" style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; " title="Click for colour legend.">Â </div>
<div class="meta-info noprint pre legend" id="legend" onmouseout="hideLegend();" onmouseover="showLegend();" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
</div>
</div>
<div class="noprint">
<pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-access-token-jwt-13.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-access-token-jwt-13.xml" title="XML source for this document">xml</a>|<a href="https://tools.ietf.org/pdf/draft-ietf-oauth-access-token-jwt-13.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/draft-ietf-oauth-access-token-jwt/13/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/draft-ietf-oauth-access-token-jwt/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/oauth/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-oauth-access-token-jwt@ietf.org?subject=draft-ietf-oauth-access-token-jwt" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-oauth-access-token-jwt-13.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-oauth-access-token-jwt-13.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-oauth-access-token-jwt-13.txt" title="Run an idnits check of this document">Nits</a>]

Versions: (<a href="/doc/html/draft-bertocci-oauth-access-token-jwt">draft-bertocci-oauth-access-token-jwt</a>)        Standards Track
          <a href="/doc/html/draft-ietf-oauth-access-token-jwt-00">00</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-01">01</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-02">02</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-03">03</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-04">04</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-05">05</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-06">06</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-07">07</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-08">08</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-09">09</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-10">10</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-11">11</a> <a href="/doc/html/draft-ietf-oauth-access-token-jwt-12">12</a>                        
          <a href="/doc/html/draft-ietf-oauth-access-token-jwt-13"><b>13</b></a>                                                            </pre>
</div>
<div class="draftcontent">
<pre>OAuth Working Group                                          V. Bertocci
Internet-Draft                                                     Auth0
Intended status: Standards Track                            May 25, 2021
Expires: November 26, 2021


        <span class="h1">JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens</span>
                  <span class="h1">draft-ietf-oauth-access-token-jwt-13</span>

Abstract

   This specification defines a profile for issuing OAuth 2.0 access
   tokens in JSON web token (JWT) format.  Authorization servers and
   resource servers from different vendors can leverage this profile to
   issue and consume access tokens in an interoperable manner.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="/doc/html/bcp78">BCP 78</a> and <a href="/doc/html/bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on November 26, 2021.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




<span class="grey">Bertocci                Expires November 26, 2021               [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
     <a href="#section-1.1">1.1</a>.  Requirements Notation and Conventions . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.2">1.2</a>.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  JWT Access Token Header and Data Structure  . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-2.1">2.1</a>.  Header  . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-2.2">2.2</a>.  Data Structure  . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
       <a href="#section-2.2.1">2.2.1</a>.  Authentication Information Claims . . . . . . . . . .   <a href="#page-5">5</a>
       <a href="#section-2.2.2">2.2.2</a>.  Identity Claims . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
       <a href="#section-2.2.3">2.2.3</a>.  Authorization Claims  . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
         2.2.3.1.  Claims for Authorization Outside of Delegation
                   Scenarios . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-3">3</a>.  Requesting a JWT Access Token . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-4">4</a>.  Validating JWT Access Tokens  . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
   <a href="#section-5">5</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-6">6</a>.  Privacy Considerations  . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-7">7</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-7.1">7.1</a>.  Media Type Registration . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
       <a href="#section-7.1.1">7.1.1</a>.  Registry Content  . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-7.2">7.2</a>.  Claims Registration . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
       <a href="#section-7.2.1">7.2.1</a>.  Registry Contents . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
         <a href="#section-7.2.1.1">7.2.1.1</a>.  Roles . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
         <a href="#section-7.2.1.2">7.2.1.2</a>.  Groups  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
         <a href="#section-7.2.1.3">7.2.1.3</a>.  Entitlements  . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
   <a href="#section-8">8</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-8.1">8.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-8.2">8.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#appendix-A">Appendix A</a>.  Acknowledgements . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#appendix-B">Appendix B</a>.  Document History . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-22">22</a>

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.%20%20Introduction"></a></body></html><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The original OAuth 2.0 Authorization Framework [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>]
   specification does not mandate any specific format for access tokens.
   While that remains perfectly appropriate for many important
   scenarios, in-market use has shown that many commercial OAuth 2.0
   implementations elected to issue access tokens using a format that
   can be parsed and validated by resource servers directly, without
   further authorization server involvement.  The approach is
   particularly common in topologies where the authorization server and
   resource server are not co-located, are not run by the same entity,
   or are otherwise separated by some boundary.  At the time of writing,
   many commercial implementations leverage the JSON Web Tokens (JWT)
   [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>] format.





<span class="grey">Bertocci                Expires November 26, 2021               [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   Many vendor specific JWT access tokens share the same functional
   layout, using JWT claims to convey the information needed to support
   a common set of use cases: token validation, transporting
   authorization information in forms of scopes and entitlements,
   carrying identity information about the subject, and so on.  The
   differences are mostly confined to the claim names and syntax used to
   represent the same entities, suggesting that interoperability could
   be easily achieved by standardizing on a common set of claims and
   validation rules.

   The assumption that access tokens are associated to specific
   information doesn't appear only in commercial implementations.
   Various specifications in the OAuth 2.0 family (such as resource
   indicators [<a href="/doc/html/rfc8707" title='"Resource Indicators for OAuth 2.0"'>RFC8707</a>], OAuth 2.0 bearer token usage [<a href="/doc/html/rfc6750" title='"The OAuth 2.0 Authorization Framework: Bearer Token Usage"'>RFC6750</a>] and
   others) postulate the presence in access tokens of scoping
   mechanisms, such as an audience.  The family of specifications
   associated to introspection also indirectly suggest a fundamental set
   of information access tokens are expected to carry or at least be
   associated with.

   This specification aims to provide a standardized and interoperable
   profile as an alternative to the proprietary JWT access token layouts
   going forward.  Besides defining a common set of mandatory and
   optional claims, the profile provides clear indications on how
   authorization request parameters determine the content of the issued
   JWT access token, how an authorization server can publish metadata
   relevant to the JWT access tokens it issues, and how a resource
   server should validate incoming JWT access tokens.

   Finally, this specification provides security and privacy
   considerations meant to prevent common mistakes and anti patterns
   that are likely to occur in naive use of the JWT format to represent
   access tokens.

   Please note: although both this document and [<a href="/doc/html/rfc7523" title='"JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants"'>RFC7523</a>] use JSON Web
   Tokens in the context of the OAuth2 framework, the two specifications
   differ in both intent and mechanics.  Whereas [<a href="/doc/html/rfc7523" title='"JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants"'>RFC7523</a>] defines how a
   JWT Bearer Token can be used to request an access token, this
   documents describes how to encode access tokens in JWT format.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.1.%20%20Requirements%20Notation%20and%20Conventions"></a></body></html><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Requirements Notation and Conventions</span>

   The key words "<em>MUST</em>", "<em>MUST NOT</em>", "<em>REQUIRED</em>", "<em>SHALL</em>", "<em>SHALL NOT</em>",
   "<em>SHOULD</em>", "<em>SHOULD NOT</em>", "<em>RECOMMENDED</em>", "NOT <em>RECOMMENDED</em>", "<em>MAY</em>", and
   "<em>OPTIONAL</em>" in this document are to be interpreted as described in <a href="/doc/html/bcp14">BCP</a>
   <a href="/doc/html/bcp14">14</a> [<a href="/doc/html/rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="/doc/html/rfc8174" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.




<span class="grey">Bertocci                Expires November 26, 2021               [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.2.%20%20Terminology"></a></body></html><a class="selflink" href="#section-1.2" id="section-1.2">1.2</a>.  Terminology</span>

   JWT access token:  An OAuth 2.0 access token encoded in JWT format
      and complying with the requirements described in this
      specification.

   This specification uses the terms "access token", "refresh token",
   "authorization server", "resource server", "authorization endpoint",
   "authorization request", "authorization response", "token endpoint",
   "grant type", "access token request", "access token response", and
   "client" defined by The OAuth 2.0 Authorization Framework [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>].

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.%20%20JWT%20Access%20Token%20Header%20and%20Data%20Structure"></a></body></html><a class="selflink" href="#section-2" id="section-2">2</a>.  JWT Access Token Header and Data Structure</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.1.%20%20Header"></a></body></html><a class="selflink" href="#section-2.1" id="section-2.1">2.1</a>.  Header</span>

   JWT access tokens <em>MUST</em> be signed.  Although JWT access tokens can use
   any signing algorithm, use of asymmetric cryptography is <em>RECOMMENDED</em>
   as it simplifies the process of acquiring validation information for
   resource servers (see <a href="#section-4">Section 4</a>).  JWT access tokens <em>MUST NOT</em> use
   "none" as the signing algorithm.  See <a href="#section-4">Section 4</a> for more details.

   Authorization servers and resource servers conforming to this
   specification <em>MUST</em> include RS256 (as defined in [<a href="/doc/html/rfc7518" title='"JSON Web Algorithms (JWA)"'>RFC7518</a>]) among
   their supported signature algorithms.

   This specification registers the "application/at+jwt" media type,
   which can be used to indicate that the content is a JWT access token.
   JWT access tokens <em>MUST</em> include this media type in the "typ" header
   parameter to explicitly declare that the JWT represents an access
   token complying with this profile.  Per the definition of "typ" in
   <a href="/doc/html/rfc7515#section-4.1.9">SectionÂ 4.1.9 of [RFC7515]</a>, it is <em>RECOMMENDED</em> that the "application/"
   prefix be omitted.  Therefore, the "typ" value used <em>SHOULD</em> be
   "at+jwt".  See the security considerations section for details on the
   importance of preventing OpenID Connect ID Tokens (as defined by
   Section 2 of [<a href="#ref-OpenID.Core">OpenID.Core</a>]) from being accepted as access tokens by
   resource servers implementing this profile.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.2.%20%20Data%20Structure"></a></body></html><a class="selflink" href="#section-2.2" id="section-2.2">2.2</a>.  Data Structure</span>

   The following claims are used in the JWT access token data structure.

   iss  <em>REQUIRED</em> - as defined in <a href="/doc/html/rfc7519#section-4.1.1">SectionÂ 4.1.1 of [RFC7519]</a>.

   exp  <em>REQUIRED</em> - as defined in <a href="/doc/html/rfc7519#section-4.1.4">SectionÂ 4.1.4 of [RFC7519]</a>.






<span class="grey">Bertocci                Expires November 26, 2021               [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   aud  <em>REQUIRED</em> - as defined in <a href="/doc/html/rfc7519#section-4.1.3">SectionÂ 4.1.3 of [RFC7519]</a>.  See
      <a href="#section-3">Section 3</a> for indications on how an authorization server should
      determine the value of "aud" depending on the request.

   sub  <em>REQUIRED</em> - as defined in <a href="/doc/html/rfc7519#section-4.1.2">SectionÂ 4.1.2 of [RFC7519]</a>.  In case of
      access tokens obtained through grants where a resource owner is
      involved, such as the authorization code grant, the value of "sub"
      <em>SHOULD</em> correspond to the subject identifier of the resource owner.
      In case of access tokens obtained through grants where no resource
      owner is involved, such as the client credentials grant, the value
      of "sub" <em>SHOULD</em> correspond to an identifier the authorization
      server uses to indicate the client application.  See <a href="#section-5">Section 5</a> for
      more details on this scenario.  Also, see <a href="#section-6">Section 6</a> for a
      discussion about how different choices in assigning "sub" values
      can impact privacy.

   client_id  <em>REQUIRED</em> - as defined in <a href="/doc/html/rfc8693#section-4.3">SectionÂ 4.3 of [RFC8693]</a>.

   iat  <em>REQUIRED</em> - as defined in <a href="/doc/html/rfc7519#section-4.1.6">SectionÂ 4.1.6 of [RFC7519]</a>.  This claim
      identifies the time at which the JWT access token was issued.

   jti  <em>REQUIRED</em> - as defined in <a href="/doc/html/rfc7519#section-4.1.7">SectionÂ 4.1.7 of [RFC7519]</a>.

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.2.1.%20%20Authentication%20Information%20Claims"></a></body></html><a class="selflink" href="#section-2.2.1" id="section-2.2.1">2.2.1</a>.  Authentication Information Claims</span>

   The claims listed in this section <em>MAY</em> be issued in the context of
   authorization grants involving the resource owner, and reflect in the
   access token the types and strength of authentication that the
   authentication server enforced prior to returning the authorization
   response to the client.  Their values are fixed, and remain the same
   across all access tokens that derive from a given authorization
   response, whether the access token was obtained directly in the
   response (e.g., via the implicit flow) or after one or more token
   exchanges (e.g., obtaining a fresh access token using a refresh
   token, or exchanging one access token for another via [<a href="/doc/html/rfc8693" title='"OAuth 2.0 Token Exchange"'>RFC8693</a>]
   procedures).

   auth_time  <em>OPTIONAL</em> - as defined in Section 2 of [<a href="#ref-OpenID.Core">OpenID.Core</a>].

   acr  <em>OPTIONAL</em> - as defined in Section 2 of [<a href="#ref-OpenID.Core">OpenID.Core</a>].

   amr  <em>OPTIONAL</em> - as defined in Section 2 of [<a href="#ref-OpenID.Core">OpenID.Core</a>].

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.2.2.%20%20Identity%20Claims"></a></body></html><a class="selflink" href="#section-2.2.2" id="section-2.2.2">2.2.2</a>.  Identity Claims</span>

   In the context of authorization grants involving the resource owner,
   commercial authorization servers will often include resource owner
   attributes directly in access tokens, so that resource servers can



<span class="grey">Bertocci                Expires November 26, 2021               [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   consume them directly for authorization or other purposes without any
   further round trips to introspection ( [<a href="/doc/html/rfc7662" title='"OAuth 2.0 Token Introspection"'>RFC7662</a>]) or UserInfo (
   [<a href="#ref-OpenID.Core">OpenID.Core</a>]) endpoints.  This is particularly common in scenarios
   where the client and the resource server belong to the same entity
   and are part of the same solution, as is the case for first party
   clients invoking their own backend API.

   This profile does not introduce any mechanism for a client to
   directly request the presence of specific claims in JWT access
   tokens, as the authorization server can determine what additional
   claims are required by a particular resource server by taking in
   consideration the client_id of the client, the "scope" and the
   "resource" parameters included in the request.

   Any additional identity attribute whose semantic is well described by
   an entry in the JSON Web Token (JWT) IANA registry introduced in
   [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>] <em>SHOULD</em> be encoded using the corresponding claim name, if
   that attribute is to be included in the JWT access token.  Note that
   the JWT IANA registry includes the claims found in Section 5.1 of
   [<a href="#ref-OpenID.Core">OpenID.Core</a>].

   Authorization servers <em>MAY</em> return arbitrary attributes not defined in
   any existing specification, as long as the corresponding claim names
   are collision resistant or the access tokens are meant to be used
   only within a private subsystem.  Please refer to Sections <a href="#section-4.2">4.2</a> and
   4.3 of [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>] for details.

   Authorization servers including resource owner attributes in JWT
   access tokens need to exercise care and verify that all privacy
   requirements are met, as discussed in <a href="#section-6">Section 6</a>.

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.2.3.%20%20Authorization%20Claims"></a></body></html><a class="selflink" href="#section-2.2.3" id="section-2.2.3">2.2.3</a>.  Authorization Claims</span>

   If an authorization request includes a scope parameter, the
   corresponding issued JWT access token <em>SHOULD</em> include a "scope" claim
   as defined in <a href="/doc/html/rfc8693#section-4.2">SectionÂ 4.2 of [RFC8693]</a>.

   All the individual scope strings in the "scope" claim <em>MUST</em> have
   meaning for the resources indicated in the "aud" claim.  See
   <a href="#section-5">Section 5</a> for more considerations about the relationship between
   scope strings and resources indicated by the "aud" claim.

<span class="h5"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.2.3.1.%20%20Claims%20for%20Authorization%20Outside%20of%20Delegation%20Scenarios"></a></body></html><a class="selflink" href="#section-2.2.3.1" id="section-2.2.3.1">2.2.3.1</a>.  Claims for Authorization Outside of Delegation Scenarios</span>

   Many authorization servers embed in the access tokens they issue
   authorization attributes that go beyond the delegated scenarios
   described by [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>].  Typical examples include resource owner
   memberships in roles and groups that are relevant to the resource



<span class="grey">Bertocci                Expires November 26, 2021               [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   being accessed, entitlements assigned to the resource owner for the
   targeted resource that the authorization server knows about, and so
   on.

   An authorization server wanting to include such attributes in a JWT
   access token <em>SHOULD</em> use as claim types the "groups","roles" and
   "entitlements" attributes of the "User" resource schema defined by
   <a href="/doc/html/rfc7643#section-4.1.2">SectionÂ 4.1.2 of [RFC7643]</a>).

   Authorization servers <em>SHOULD</em> encode the corresponding claim values
   according to the guidance defined in [<a href="/doc/html/rfc7643" title='"System for Cross-domain Identity Management: Core Schema"'>RFC7643</a>].  In particular, a
   non-normative example of "groups" attribute can be found in
   <a href="/doc/html/rfc7643#section-8.2">SectionÂ 8.2 of [RFC7643]</a>.  No specific vocabulary is provided for
   "roles" and "entitlements".

   <a href="#section-7">Section 7</a> of this document provides entries for registering "groups",
   "roles" and "entitlements" attributes from [<a href="/doc/html/rfc7643" title='"System for Cross-domain Identity Management: Core Schema"'>RFC7643</a>] as claim types
   to be used in this profile.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.%20%20Requesting%20a%20JWT%20Access%20Token"></a></body></html><a class="selflink" href="#section-3" id="section-3">3</a>.  Requesting a JWT Access Token</span>

   An authorization server can issue a JWT access token in response to
   any authorization grant defined by [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>] and subsequent
   extensions meant to result in an access token.

   If the request includes a "resource" parameter (as defined in
   [<a href="/doc/html/rfc8707" title='"Resource Indicators for OAuth 2.0"'>RFC8707</a>]), the resulting JWT access token "aud" claim <em>SHOULD</em> have
   the same value as the "resource" parameter in the request.

   Example request below:


   GET /as/authorization.oauth2?response_type=code
           &amp;client_id=s6BhdRkqt3
           &amp;state=xyz
           &amp;scope=openid%20profile%20reademail
           &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb
           &amp;resource=https%3A%2F%2Frs.example.com%2F HTTP/1.1
        Host: authorization-server.example.com


    Figure 1: Authorization Request with Resource and Scope Parameters

   Once redeemed, the code obtained from the request above will result
   in a JWT access token in the form shown below:






<span class="grey">Bertocci                Expires November 26, 2021               [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   Header:

      {"typ":"at+JWT","alg":"RS256","kid":"RjEwOwOA"}

   Claims:

      {
        "iss": "https://authorization-server.example.com/",
        "sub": "5ba552d67",
        "aud":   "https://rs.example.com/",
        "exp": 1639528912,
        "iat": 1618354090,
        "jti" : "dbe39bf3a3ba4238a513f51d6e1691c4",
        "client_id": "s6BhdRkqt3",
        "scope": "openid profile reademail"
      }


       Figure 2: The Header and JWT Claims Set of a JWT Access Token

   The authorization server <em>MUST NOT</em> issue a JWT access token if the
   authorization granted by the token would be ambiguous.  See <a href="#section-5">Section 5</a>
   for more details about common cases that might lead to ambiguity and
   strategies an authorization server can enact to prevent them.

   If the request does not include a "resource" parameter, the
   authorization server <em>MUST</em> use in the "aud" claim a default resource
   indicator.  If a "scope" parameter is present in the request, the
   authorization server <em>SHOULD</em> use it to infer the value of the default
   resource indicator to be used in the "aud" claim.  The mechanism
   through which scopes are associated to default resource indicator
   values is outside the scope of this specification.  If the values in
   the "scope" parameter refer to different default resource indicator
   values, the authorization server <em>SHOULD</em> reject the request with
   "invalid_scope" as described in <a href="/doc/html/rfc6749#section-4.1.2.1">SectionÂ 4.1.2.1 of [RFC6749]</a>.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.%20%20Validating%20JWT%20Access%20Tokens"></a></body></html><a class="selflink" href="#section-4" id="section-4">4</a>.  Validating JWT Access Tokens</span>

   For the purpose of facilitating validation data retrieval, it is here
   <em>RECOMMENDED</em> that authorization servers sign JWT access tokens with an
   asymmetric algorithm.

   Authorization servers <em>SHOULD</em> use OAuth 2.0 Authorization Server
   Metadata [<a href="/doc/html/rfc8414" title='"OAuth 2.0 Authorization Server Metadata"'>RFC8414</a>] to advertise to resource servers their signing
   keys via "jwks_uri" and what "iss" claim value to expect via the
   "issuer" metadata value.  Alternatively, authorization servers
   implementing OpenID Connect <em>MAY</em> use the "OpenID Connect discovery
   [<a href="#ref-OpenID.Discovery">OpenID.Discovery</a>] document for the same purpose.  If an



<span class="grey">Bertocci                Expires November 26, 2021               [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   authorization server supports both OAuth 2.0 Authorization Server
   Metadata and OpenID Connect discovery, the values provided <em>MUST</em> be
   consistent across the two publication methods.

   An authorization server <em>MAY</em> elect to use different keys to sign
   OpenID Connect ID Tokens and JWT access tokens.  This specification
   does not provide a mechanism for identifying a specific key as the
   one used to sign JWT access tokens.  An authorization server can sign
   JWT access tokens with any of the keys advertised via AS metadata or
   OpenID Connect discovery.  See <a href="#section-5">Section 5</a> for further guidance on
   security implications.

   Resource servers receiving a JWT access token <em>MUST</em> validate it in the
   following manner.

   o  The resource server <em>MUST</em> verify that the typ header value is
      "at+jwt" or "application/at+jwt" and reject tokens carrying any
      other value.

   o  If the JWT access token is encrypted, decrypt it using the keys
      and algorithms that the resource server specified during
      registration.  If encryption was negotiated with the authorization
      server at registration time and the incoming JWT access token is
      not encrypted, the resource server <em>SHOULD</em> reject it.

   o  The Issuer Identifier for the authorization server (which is
      typically obtained during discovery) <em>MUST</em> exactly match the value
      of the "iss" claim.

   o  The resource server <em>MUST</em> validate that the "aud" claim contains a
      resource indicator value corresponding to an identifier the
      resource server expects for itself.  The JWT access token <em>MUST</em> be
      rejected if "aud" does not contain a resource indicator of the
      current resource server as a valid audience.

   o  The resource server <em>MUST</em> validate the signature of all incoming
      JWT access tokens according to [<a href="/doc/html/rfc7515" title='"JSON Web Signature (JWS)"'>RFC7515</a>] using the algorithm
      specified in the JWT alg Header Parameter.  The resource server
      <em>MUST</em> reject any JWT in which the value of "alg" is "none".  The
      resource server <em>MUST</em> use the keys provided by the authorization
      server.

   o  The current time <em>MUST</em> be before the time represented by the "exp"
      claim.  Implementers <em>MAY</em> provide for some small leeway, usually no
      more than a few minutes, to account for clock skew.

   The resource server <em>MUST</em> handle errors as described in <a href="/doc/html/rfc6750#section-3.1">SectionÂ 3.1 of
   [RFC6750]</a>.  In particular, in case of any failure in the validation



<span class="grey">Bertocci                Expires November 26, 2021               [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   checks listed above the authorization server response <em>MUST</em> include
   the error code "invalid_token".  Please note that this requirement
   does not prevent JWT access tokens to use authentications schemes
   other than Bearer.

   If the JWT access token includes authorization claims as described in
   <a href="#section-2.2.3">Section 2.2.3</a>, the resource server <em>SHOULD</em> use them in combination
   with any other contextual information available to determine whether
   the current call should be authorized or rejected.  Details about how
   a resource server performs those checks is beyond the scope of this
   profile specification.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.%20%20Security%20Considerations"></a></body></html><a class="selflink" href="#section-5" id="section-5">5</a>.  Security Considerations</span>

   The JWT access token data layout described here is very similar to
   the one of the id_token as defined by [<a href="#ref-OpenID.Core">OpenID.Core</a>].  The explicit
   typing required in this profile, in line with the recommendations in
   [<a href="/doc/html/rfc8725" title='"JSON Web Token Best Current Practices"'>RFC8725</a>] helps the resource server to distinguish between JWT access
   tokens and OpenID Connect ID Tokens.

   Authorization servers should prevent scenarios where clients can
   affect the value of the "sub" claim in ways that could confuse
   resource servers.  For example, if the authorization server elects to
   use the client_id as the "sub" value for access tokens issued using
   the client credentials grant, the authorization server should prevent
   clients from registering an arbitrary client_id value, as this would
   allow malicious clients to select the sub of a high privilege
   resource owner and confuse any authorization logic on the resource
   server relying on the "sub" value.  For more details please refer to
   Section 4.14 of [<a href="#ref-OAuth2.Security.BestPractices">OAuth2.Security.BestPractices</a>].

   To prevent cross-JWT confusion, authorization servers <em>MUST</em> use a
   distinct identifier as "aud" claim value to uniquely identify access
   tokens issued by the same issuer for distinct resources.  For more
   details on cross-JWT confusion please refer to <a href="/doc/html/rfc8725#section-2.8">SectionÂ 2.8 of
   [RFC8725]</a>.

   Authorization servers should use particular care when handling
   requests that might lead to ambiguous authorization grants.  For
   example: if a request includes multiple resource indicators, the
   authorization server should ensure that each scope string included in
   the resulting JWT access token, if any, can be unambiguously
   correlated to a specific resource among the ones listed in the "aud"
   claim.  The details on how to recognize and mitigate this and other
   ambiguous situations is highly scenario-dependent, hence out of scope
   for this profile.





<span class="grey">Bertocci                Expires November 26, 2021              [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   Authorization servers cannot rely on the use of different keys for
   signing OpenID Connect ID Tokens and JWT tokens as a method to
   safeguard against the consequences of leaking specific keys.  Given
   that resource servers have no way of knowing what key should be used
   to validate JWT access tokens in particular, they have to accept
   signatures performed with any of the keys published in AS metadata or
   OpenID Connect discovery: consequently, an attacker just needs to
   compromise any key among the ones published to be able to generate
   and sign JWTs that will be accepted as valid by the resource server.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.%20%20Privacy%20Considerations"></a></body></html><a class="selflink" href="#section-6" id="section-6">6</a>.  Privacy Considerations</span>

   As JWT access tokens carry information by value, it now becomes
   possible for clients and potentially even end users to directly peek
   inside the token claims collection of unencrypted tokens.

   The client <em>MUST NOT</em> inspect the content of the access token: the
   authorization server and the resource server might decide to change
   token format at any time (for example by switching from this profile
   to opaque tokens) hence any logic in the client relying on the
   ability to read the access token content would break without
   recourse.  The OAuth 2.0 framework assumes that access tokens are
   treated as opaque by clients.  Administrators of authorization
   servers should also take into account that the content of an access
   token is visible to the client.  Whenever client access to the access
   token content presents privacy issues for a given scenario, the
   authorization server needs to take explicit steps to prevent it.

   In scenarios in which JWT access tokens are accessible to the end
   user, it should be evaluated whether the information can be accessed
   without privacy violations (for example, if an end user would simply
   access his or her own personal information) or if steps must be taken
   to enforce confidentiality.

   Possible measures to prevent leakage of information to clients and
   end users include: encrypting the access token, encrypting the
   sensitive claims, omitting the sensitive claims or not using this
   profile, falling back on opaque access tokens.

   In every scenario, the content of the JWT access token will
   eventually be accessible to the resource server.  It's important to
   evaluate whether the resource server gained the proper entitlement to
   have access to any content received in form of claims, for example
   through user consent in some form, policies and agreements with the
   organization running the authorization servers, and so on.  For
   example, a user might not wish to consent to granting a given
   resource server information about any of the non-mandatory claims
   enumerated in <a href="#section-2">Section 2</a> (and subsections)."



<span class="grey">Bertocci                Expires November 26, 2021              [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   This profile mandates the presence of the "sub" claim in every JWT
   access token, making it possible for resource servers to rely on that
   information for correlating incoming requests with data stored
   locally for the authenticated principal.  Although the ability to
   correlate requests might be required by design in many scenarios,
   there are scenarios where the authorization server might want to
   prevent correlation.  The "sub" claim should be populated by the
   authorization servers according to a privacy impact assessment.  For
   instance, if a solution requires preventing tracking principal
   activities across multiple resource servers, the authorization server
   should ensure that JWT access tokens meant for different resource
   servers have distinct "sub" values that cannot be correlated in the
   event of resource servers collusion.  Similarly, if a solution
   requires preventing a resource server from correlating the
   principal's activity within the resource itself, the authorization
   server should assign different "sub" values for every JWT access
   token issued.  In turn, the client should obtain a new JWT access
   token for every call to the resource server, to ensure that the
   resource server receives different "sub" and "jti" values at every
   call, thus preventing correlation between distinct requests.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.%20%20IANA%20Considerations"></a></body></html><a class="selflink" href="#section-7" id="section-7">7</a>.  IANA Considerations</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.1.%20%20Media%20Type%20Registration"></a></body></html><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  Media Type Registration</span>

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.1.1.%20%20Registry%20Content"></a></body></html><a class="selflink" href="#section-7.1.1" id="section-7.1.1">7.1.1</a>.  Registry Content</span>

   This section registers the "application/at+jwt" media type [<a href="/doc/html/rfc2046" title='"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"'>RFC2046</a>]
   in the "Media Types" registry [IANA.MediaTypes] in the manner
   described in [<a href="/doc/html/rfc6838" title='"Media Type Specifications and Registration Procedures"'>RFC6838</a>], which can be used to indicate that the
   content is an access token encoded in JWT format.

   o  Type name: application

   o  Subtype name: at+jwt

   o  Required parameters: N/A

   o  Optional parameters: N/A

   o  Encoding considerations: binary; JWT values are encoded as a
      series of base64url-encoded values (with trailing '=' characters
      removed), some of which may be the empty string, separated by
      period ('.') characters.

   o  Security considerations: See the Security Considerations
      Section of [[TODO: update once there's a RFC number for the JWT AT
      profile]]



<span class="grey">Bertocci                Expires November 26, 2021              [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   o  Interoperability considerations: N/A

   o  Published specification: [[TODO: update once there's a RFC number
      for the JWT AT profile]]

   o  Applications that use this media type: Applications that access
      resource servers using OAuth 2.0 access tokens encoded in JWT
      format

   o  Fragment identifier considerations: N/A

   o  Additional information: Magic number(s): N/A File extension(s): N/
      A Macintosh file type code(s): N/A

   o  Person and email address to contact for further information:
      Vittorio Bertocci, vittorio@auth0.com

   o  Intended usage: COMMON

   o  Restrictions on usage: none

   o  Author: Vittorio Bertocci, vittorio@auth0.com

   o  Change controller: IESG

   o  Provisional registration?  No

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.2.%20%20Claims%20Registration"></a></body></html><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  Claims Registration</span>

   <a href="#section-2.2.3.1">Section 2.2.3.1</a> of this specification refers to the attributes
   "roles", "groups", "entitlements" defined in [<a href="/doc/html/rfc7643" title='"System for Cross-domain Identity Management: Core Schema"'>RFC7643</a>] to express
   authorization information in JWT access tokens.  This section
   registers those attributes as claims in the JSON Web Token (JWT) IANA
   registry introduced in [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>].

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.2.1.%20%20Registry%20Contents"></a></body></html><a class="selflink" href="#section-7.2.1" id="section-7.2.1">7.2.1</a>.  Registry Contents</span>

<span class="h5"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.2.1.1.%20%20Roles"></a></body></html><a class="selflink" href="#section-7.2.1.1" id="section-7.2.1.1">7.2.1.1</a>.  Roles</span>

   o  Claim Name: "roles"

   o  Claim Description: Roles

   o  Change Controller: IESG

   o  Specification Document(s): <a href="/doc/html/rfc7643#section-4.1.2">SectionÂ 4.1.2 of [RFC7643]</a> and
      <a href="#section-2.2.3.1">Section 2.2.3.1</a> of [[this specification]]




<span class="grey">Bertocci                Expires November 26, 2021              [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


<span class="h5"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.2.1.2.%20%20Groups"></a></body></html><a class="selflink" href="#section-7.2.1.2" id="section-7.2.1.2">7.2.1.2</a>.  Groups</span>

   o  Claim Name: "groups"

   o  Claim Description: Groups

   o  Change Controller: IESG

   o  Specification Document(s): <a href="/doc/html/rfc7643#section-4.1.2">SectionÂ 4.1.2 of [RFC7643]</a> and
      <a href="#section-2.2.3.1">Section 2.2.3.1</a> of [[this specification]]

<span class="h5"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.2.1.3.%20%20Entitlements"></a></body></html><a class="selflink" href="#section-7.2.1.3" id="section-7.2.1.3">7.2.1.3</a>.  Entitlements</span>

   o  Claim Name: "entitlements"

   o  Claim Description: Entitlements

   o  Change Controller: IESG

   o  Specification Document(s): <a href="/doc/html/rfc7643#section-4.1.2">SectionÂ 4.1.2 of [RFC7643]</a> and
      <a href="#section-2.2.3.1">Section 2.2.3.1</a> of [[this specification]]

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/8.%20%20References"></a></body></html><a class="selflink" href="#section-8" id="section-8">8</a>.  References</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/8.1.%20%20Normative%20References"></a></body></html><a class="selflink" href="#section-8.1" id="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-OpenID.Core">OpenID.Core</a>]
              Sakimura, N., Bradley, J., Jones, M., Medeiros, B., and C.
              Mortimore, "OpenID Connect Core 1.0", November 2014,
              &lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;.

   [<a id="ref-OpenID.Discovery">OpenID.Discovery</a>]
              Sakimura, N., Bradley, J., Jones, M., and J. Jay, "OpenID
              Connect Discovery 1.0", November 2014,
              &lt;<a href="https://openid.net/specs/openid-connect-discovery-1_0.html">https://openid.net/specs/openid-connect-discovery-</a>
              <a href="https://openid.net/specs/openid-connect-discovery-1_0.html">1_0.html</a>&gt;.

   [<a id="ref-RFC2046">RFC2046</a>]  Freed, N. and N. Borenstein, "Multipurpose Internet Mail
              Extensions (MIME) Part Two: Media Types", <a href="/doc/html/rfc2046">RFC 2046</a>,
              DOI 10.17487/RFC2046, November 1996,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2046">https://www.rfc-editor.org/info/rfc2046</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.





<span class="grey">Bertocci                Expires November 26, 2021              [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   [<a id="ref-RFC6749">RFC6749</a>]  Hardt, D., Ed., "The OAuth 2.0 Authorization Framework",
              <a href="/doc/html/rfc6749">RFC 6749</a>, DOI 10.17487/RFC6749, October 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;.

   [<a id="ref-RFC6838">RFC6838</a>]  Freed, N., Klensin, J., and T. Hansen, "Media Type
              Specifications and Registration Procedures", <a href="/doc/html/bcp13">BCP 13</a>,
              <a href="/doc/html/rfc6838">RFC 6838</a>, DOI 10.17487/RFC6838, January 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;.

   [<a id="ref-RFC7515">RFC7515</a>]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web
              Signature (JWS)", <a href="/doc/html/rfc7515">RFC 7515</a>, DOI 10.17487/RFC7515, May
              2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;.

   [<a id="ref-RFC7518">RFC7518</a>]  Jones, M., "JSON Web Algorithms (JWA)", <a href="/doc/html/rfc7518">RFC 7518</a>,
              DOI 10.17487/RFC7518, May 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;.

   [<a id="ref-RFC7519">RFC7519</a>]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
              (JWT)", <a href="/doc/html/rfc7519">RFC 7519</a>, DOI 10.17487/RFC7519, May 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;.

   [<a id="ref-RFC7643">RFC7643</a>]  Hunt, P., Ed., Grizzle, K., Wahlstroem, E., and C.
              Mortimore, "System for Cross-domain Identity Management:
              Core Schema", <a href="/doc/html/rfc7643">RFC 7643</a>, DOI 10.17487/RFC7643, September
              2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7643">https://www.rfc-editor.org/info/rfc7643</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words", <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8414">RFC8414</a>]  Jones, M., Sakimura, N., and J. Bradley, "OAuth 2.0
              Authorization Server Metadata", <a href="/doc/html/rfc8414">RFC 8414</a>,
              DOI 10.17487/RFC8414, June 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;.

   [<a id="ref-RFC8693">RFC8693</a>]  Jones, M., Nadalin, A., Campbell, B., Ed., Bradley, J.,
              and C. Mortimore, "OAuth 2.0 Token Exchange", <a href="/doc/html/rfc8693">RFC 8693</a>,
              DOI 10.17487/RFC8693, January 2020,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8693">https://www.rfc-editor.org/info/rfc8693</a>&gt;.

   [<a id="ref-RFC8707">RFC8707</a>]  Campbell, B., Bradley, J., and H. Tschofenig, "Resource
              Indicators for OAuth 2.0", <a href="/doc/html/rfc8707">RFC 8707</a>, DOI 10.17487/RFC8707,
              February 2020, &lt;<a href="https://www.rfc-editor.org/info/rfc8707">https://www.rfc-editor.org/info/rfc8707</a>&gt;.

   [<a id="ref-RFC8725">RFC8725</a>]  Sheffer, Y., Hardt, D., and M. Jones, "JSON Web Token Best
              Current Practices", <a href="/doc/html/bcp225">BCP 225</a>, <a href="/doc/html/rfc8725">RFC 8725</a>,
              DOI 10.17487/RFC8725, February 2020,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8725">https://www.rfc-editor.org/info/rfc8725</a>&gt;.



<span class="grey">Bertocci                Expires November 26, 2021              [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/8.2.%20%20Informative%20References"></a></body></html><a class="selflink" href="#section-8.2" id="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-OAuth2.Security.BestPractices">OAuth2.Security.BestPractices</a>]
              Lodderstedt, T., Bradley, J., Labunets, A., and D. Fett,
              "OAuth 2.0 Security Best Current Practice", July 2019,
              &lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-18">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-</a>
              <a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-18">security-topics-18</a>&gt;.

   [<a id="ref-RFC6750">RFC6750</a>]  Jones, M. and D. Hardt, "The OAuth 2.0 Authorization
              Framework: Bearer Token Usage", <a href="/doc/html/rfc6750">RFC 6750</a>,
              DOI 10.17487/RFC6750, October 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6750">https://www.rfc-editor.org/info/rfc6750</a>&gt;.

   [<a id="ref-RFC7523">RFC7523</a>]  Jones, M., Campbell, B., and C. Mortimore, "JSON Web Token
              (JWT) Profile for OAuth 2.0 Client Authentication and
              Authorization Grants", <a href="/doc/html/rfc7523">RFC 7523</a>, DOI 10.17487/RFC7523, May
              2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7523">https://www.rfc-editor.org/info/rfc7523</a>&gt;.

   [<a id="ref-RFC7662">RFC7662</a>]  Richer, J., Ed., "OAuth 2.0 Token Introspection",
              <a href="/doc/html/rfc7662">RFC 7662</a>, DOI 10.17487/RFC7662, October 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7662">https://www.rfc-editor.org/info/rfc7662</a>&gt;.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/Appendix%20A.%20%20Acknowledgements"></a></body></html><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  Acknowledgements</span>

   The initial set of requirements informing this specification was
   extracted by numerous examples of access tokens issued in JWT format
   by production systems.  Thanks to Dominick Baier (IdentityServer),
   Brian Campbell (Ping Identity), Daniel Dobalian (Microsoft), Karl
   Guinness (Okta) for providing sample tokens issued by their products
   and services.  Brian Campbell and Filip Skokan provided early
   feedback that shaped the direction of the specification.  This
   profile was discussed at length during the OAuth Security Workshop
   2019, with several individuals contributing ideas and feedback.  The
   author would like to acknowledge the contributions of:

   John Bradley, Brian Campbell, Vladimir Dzhuvinov, Torsten
   Lodderstedt, Nat Sakimura, Hannes Tschofenig and everyone who
   actively participated in the unconference discussions.

   The following individuals contributed useful feedback and insights on
   the drafts, both on the IETF OAuth 2.0 WG DL and during the IIW28
   conference:

   Dale Olds, George Fletcher, David Waite, Michael Engan, Mike Jones,
   Hans Zandbelt, Vladimir Dzhuvinov, Martin Schanzenbach , Aaron
   Parecki, Annabelle Richard Backman, Dick Hardt, Denis Pinkas,
   Benjamin Kaduk, Dominick Baier, Andrii Deinega, Mike Jones and
   everyone who actively participated in the IIW28 unconference



<span class="grey">Bertocci                Expires November 26, 2021              [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   discussions and the IETF OAuth 2.0 WG DL discussions.  Thanks to
   Roman Danyliw for the AD review, Joseph Salowey and Roni Even for the
   SECDIR/GENART reviews, Francesca Palomini, Lars Eggert, Murray
   Kucherawy, Roberto Polli, Martin Duke, Benjamin Kaduk for the IESG
   reviews.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/Appendix%20B.%20%20Document%20History"></a></body></html><a class="selflink" href="#appendix-B" id="appendix-B">Appendix B</a>.  Document History</span>

   [[ to be removed by the RFC Editor before publication as an RFC ]]

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-13">draft-ietf-oauth-access-token-jwt-13</a>

   o  Added an explicit requirement for the JWT access tokens to be
      signed in <a href="#section-2.1">Section 2.1</a>.
   o  Added sections in <a href="#section-7.2">Section 7.2</a> for improving readability.
   o  In Figure 2, added jti and iat claims.
   o  Editorial fixes in <a href="#section-2.2.1">Section 2.2.1</a> and <a href="#section-4">Section 4</a>.
   o  Clarified that additional claims are to be added only if necessary
      - in <a href="#section-2.2.2">Section 2.2.2</a>.  Editorial changes in the same section.
   o  Updates sample values in <a href="#section-3">Section 3</a>.
   o  Added leeway language to the exp validation step in <a href="#section-4">Section 4</a>.
   o  In <a href="#section-4">Section 4</a>, clarified that the use of <a href="/doc/html/rfc6750">RFC6750</a> error codes does
      not imply that JWT ATs can only be Bearer tokens.
   o  Various edits and nits in <a href="#section-5">Section 5</a> and <a href="#section-6">Section 6</a>.
   o  Added clarifying language in <a href="#section-6">Section 6</a> regarding what claims in
      the AT might require explicit user consent.
   o  Added URLs for the OpenID references and the oauth security BCP.
      Moved <a href="/doc/html/rfc7523">RFC7523</a> to the informative references section.

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-12">draft-ietf-oauth-access-token-jwt-12</a>

   o  Editorial changes in the abstract.
   o  Updated the client_id value in the figures in <a href="#section-3">Section 3</a>.
   o  Added clarifying language in <a href="#section-1">Section 1</a> positioning this
      specification vs [<a href="/doc/html/rfc7523" title='"JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants"'>RFC7523</a>].
   o  In section <a href="#section-2.1">Section 2.1</a> added a sentence that makes RS256 support
      mandatory for AS and RS.

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-11">draft-ietf-oauth-access-token-jwt-11</a>

   o  Editorial updates and typo fixes in <a href="#section-1.2">Section 1.2</a>, <a href="#section-2.2">Section 2.2</a>,
      <a href="#section-2.2.1">Section 2.2.1</a>, <a href="#section-2.2.2">Section 2.2.2</a>, <a href="#section-3">Section 3</a>, <a href="#section-4">Section 4</a>, <a href="#section-5">Section 5</a>,
      <a href="#appendix-A">Appendix A</a>
   o  Updated language in <a href="#section-2.2.2">Section 2.2.2</a> to explicitly refer to the JWT
      IANA registry.
   o  Citation added in in <a href="#section-2.1">Section 2.1</a>
   o  Added a normative reference entry for OpenID Connect Discovery 1.0
      and referenced it from <a href="#section-4">Section 4</a>



<span class="grey">Bertocci                Expires November 26, 2021              [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-10">draft-ietf-oauth-access-token-jwt-10</a>

   o  Updated Figure 2 in <a href="#section-3">Section 3</a> to clarify that the intent of that
      snippet is to describe the content rather than exact JWT AT
      format.
   o  Updated registry references in <a href="#section-7.2.1">Section 7.2.1</a> to point to
      <a href="#section-2.2.3.1">Section 2.2.3.1</a>
   o  Modified <a href="#section-2.2.3.1">Section 2.2.3.1</a> to make it easier for the reader to
      understand what values and format is expected for the groups,
      roles and entitlement claims.  Minor formatting issues fixed.

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-09">draft-ietf-oauth-access-token-jwt-09</a>

   o  Removed unused reference to <a href="http://www.iana.org/assignments/oauth-">http://www.iana.org/assignments/oauth-</a>
      parameters; moved the OAuth2 security BCP to the informative
      references section.
   o  Restructured opening paragraphs in <a href="#section-6">Section 6</a> for clarity.

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-08">draft-ietf-oauth-access-token-jwt-08</a>

   o  Numerous edits for correcting typos, improving clarity and
      precision of language.
   o  Moved <a href="/doc/html/rfc7519">RFC7519</a> to the normative section; eliminated unused
      references <a href="/doc/html/rfc7644">RFC7644</a> and <a href="/doc/html/rfc3986">RFC3986</a>.

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-07">draft-ietf-oauth-access-token-jwt-07</a>

   o  In <a href="#section-2.1">Section 2.1</a>, added language that forbids use of none as alg
      value, and references <a href="#section-4">Section 4</a> where the same prohibition was
      already expressed from the RS perspective.
   o  In the sub definition in <a href="#section-2.2">Section 2.2</a>, added a sentence that
      clarifies what goes in the sub in the case of grants where a
      resource owner is involved.
   o  Updated acknowledgements.
   o  Updated <a href="#section-2.2.1">Section 2.2.1</a> to clarify that acr, amr and auth_type can
      occur if the AT has been obtained by grants where the resource
      owner is involved.
   o  Updated <a href="#section-2.2.2">Section 2.2.2</a> to clarify that identity claims can occur if
      the AT has been obtained by grants where the resource owner is
      involved.
   o  In <a href="#section-2.2.3.1">Section 2.2.3.1</a> eliminated the claim that SCIM doesn't provide
      a vocabulary for the attributes listed there.
   o  In <a href="#section-5">Section 5</a> added reference to 8725.
   o  In <a href="#section-4">Section 4</a> added application/jwt+at as accepted typ value.
   o  Various typos and formatting issues fixed.

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-06">draft-ietf-oauth-access-token-jwt-06</a>




<span class="grey">Bertocci                Expires November 26, 2021              [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   o  In <a href="#section-2.2">Section 2.2</a> and <a href="#section-6">Section 6</a> added a discussion about how
      different sub values affect the privacy properties of a solution.
   o  In <a href="#section-2.2.3">Section 2.2.3</a> and <a href="#section-3">Section 3</a> eliminated language prohibiting JWT
      AT requests featuring multiple resources, substituting it with the
      prohibition for the AS to emit JWT ATs expressing ambiguous
      authorization grants.  In <a href="#section-5">Section 5</a>, added language warning
      against scope confusion and mentioned the existence of other
      ambiguous authorization grant.
   o  In <a href="#section-2.2">Section 2.2</a> promoted claims iat and jti from <em>RECOMMENDED</em> to
      <em>REQUIRED</em>.
   o  In <a href="#section-2.1">Section 2.1</a> eliminated temporary note on the lack of
      authenticated encryption methods specifications.
   o  Updated acknowledgements.

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-05">draft-ietf-oauth-access-token-jwt-05</a>

   o  Varios typos, grammar issues and improper abbreviations fixed.
   o  Reworded the definition of at+jwt in <a href="#section-2.1">Section 2.1</a>.
   o  In <a href="#section-2.2">Section 2.2</a>, clarified that iat refers to the issuance time of
      the JWT itself.
   o  In <a href="#section-2.2.2">Section 2.2.2</a>, added a reference to public/private claims
      definitions (Sections <a href="#section-4.2">4.2</a>, <a href="#section-4.3">4.3</a>) of [<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>].
   o  In <a href="#section-3">Section 3</a>, removed the paragrah stating that every JWT AT <em>MUST</em>
      have an aud, as it is already defined in <a href="#section-2.2">Section 2.2</a>.
   o  Reworded description of the JWT AT adoption landscape in
      <a href="#section-1">Section 1</a>.
   o  Simplified the individual descriptions of the claims list in
      <a href="#section-2.2.1">Section 2.2.1</a>.
   o  Updated <a href="#section-4">Section 4</a> and <a href="#section-5">Section 5</a> to clarify that the AS can use any
      of the published keys to sign JWT access tokens, and that the AS
      should not rely on use of different signing keys per token type as
      a security mechanism.
   o  In <a href="#section-2.2">Section 2.2</a> promoted claims iat and jti from <em>OPTIONAL</em> to
      <em>RECOMMENDED</em>
   o  In <a href="#section-4">Section 4</a>, switched the validation steps list type from numbers
      to bullets.
   o  In <a href="#section-4">Section 4</a>, eliminated the auth_time instructions from the
      validation steps list.
   o  In <a href="#section-2.2.2">Section 2.2.2</a>, added a reference to the JWT claims registry as
      source of claims for JWT ATs
   o  In <a href="#section-4">Section 4</a>, clarified that failures in JWT AT validation checks
      will result in invalid_token.

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-04">draft-ietf-oauth-access-token-jwt-04</a>

   o  Eliminated reference to resource aliases list from the aud claim
      description in <a href="#section-2">Section 2</a>.




<span class="grey">Bertocci                Expires November 26, 2021              [Page 19]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-20"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   o  Eliminated references to resource aliases list from the aud
      validation guidance in <a href="#section-4">Section 4</a>.
   o  Introduced a new subsection <a href="#section-2.2.1">Section 2.2.1</a>, moved the definitions
      of auth_time, acr and amr there and incorporated the language
      proposed by Annabelle and Brian on the WG mailing list.
   o  In section <a href="#section-3">Section 3</a> softened (from <em>MUST</em> to <em>SHOULD</em>) the
      requirement that ties the resource identifier in the request to
      the value in the aud claim of the issued access token.
   o  Updated acknowledgements.
   o  In the section <a href="#section-3">Section 3</a>, the example request now has
      response_type=code.
   o  Updated text in the Privacy Consideration section to clarify what
      protection steps the text refers to.
   o  Updated the typ header discussion in <a href="#section-2.1">Section 2.1</a> to clarify that
      it helps preventing resources from accepting OpenID Connect ID
      Tokens as JWT access tokens.
   o  Updated refrences to token exchange, resource indicators and JWT
      best practices to reflect their RFC status (8693,8707,8725).

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-03">draft-ietf-oauth-access-token-jwt-03</a>

   o  Varios typos fixed.
   o  In the security considerations section, relaxed the claim that the
      typ header value "at+jwt" will prevent RS from misinterpreting JWT
      ATs as idtokens.
   o  In the "Requesting JWT Access Tokens" section, added
      "invalid_target" as a possible error returned for the multiple
      resources request case.
   o  In the Validating JWT Access Tokens" section, disallowed JWTs with
      "alg":"none"
   o  in the IANA registration entries for the SCIM claim types,
      complemented the reference to the SCIM spec with a reference to
      this spec so that the eventual registration entries have better
      context.
   o  Updated acknowledgements.
   o  In the section <a href="#section-3">Section 3</a>, the example request now has
      response_type=code.
   o  Updated text in the Privacy Consideration section to clarify what
      protection steps the text refers to.

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-02">draft-ietf-oauth-access-token-jwt-02</a>

   o  In 2.2.1, opened the sources of identity attributes to any
      identity related specification.
   o  In 2.2.2, relaxed from <em>MUST</em> to <em>SHOULD</em> the requirement that
      requests including a scope always result in access tkens
      containing a corresponding scope claim.




<span class="grey">Bertocci                Expires November 26, 2021              [Page 20]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-21"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   o  In the security considerations setting, added a requirement for
      the authorization server to assing unique identifiers for
      different resources- to prevent cross JWT confusion.
   o  Added IANA registration for the authorization attributes borrowed
      from SCIM CORE

   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-01">draft-ietf-oauth-access-token-jwt-01</a>

   o  Added note on authenticated encryption.
   o  Added a mention to the 1st party clients scenarios in the identity
      claims section.
   o  Changed the definition reference for the iss, exp, aud, sub, iat
      claims from OpenID.Core to <a href="/doc/html/rfc7519">RFC7519</a>.
   o  Added a mention of the client_id==sub case in the security
      considerations section, added a reference to <a href="/doc/html/draft-ietf-oauth-security-topics-13">draft-ietf-oauth-</a>
      <a href="/doc/html/draft-ietf-oauth-security-topics-13">security-topics-13</a>.  Added a reference to the security
      considerations from the sub claim definition section.
   o  Specified invalid_request as the error code the authorization
      server should return in case of multiple resources in the access
      token request.
   o  Specified invalid_scope as the error code the authorization server
      should return in case it isn;t possible to determine to which
      resource the requested scopes refers to.
   o  In the identity claims section, added a reference to introspection
      as possible source of claim types and added language explicitly
      stating that the AS can add arbitrary attributes as long as they
      are collision resistant or private.
   o  Updated language for the auth_time claim to include the case in
      which the AS reauthenticates the user mid-session (e.g. during
      step up auth).
   o  Removed note about adding a mechanism for extablishing whether the
      token was obtained on behalf or the resource owner or of the
      client itself (client credentials grant).
   o  Removed note about adding a mechanism for indicating whether the
      authorization server sent the resource owner to authenticate with
      a federated identity provider, and the identity of that federated
      provider.
   o  Removed the note in the security consideration sections about
      discussing the purpose of aud, iss, exp validation (redundant).
   o  In the authorization claims section, stated intent to register
      roles, groups and entitlements as claim types in IANA
   o  Clarified in the privacy considerations that clients should not
      inspect access tokens.
   o  Expanded the privacy considerations with more explicit guidance
      about privacy preserving approaches.
   o  Added IANA registry content for the at+JWT MIME type.
   o  Updated acknowledgements.




<span class="grey">Bertocci                Expires November 26, 2021              [Page 21]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-22"></span>
<span class="grey">Internet-Draft     OAuth 2.0 Access Token JWT Profile           May 2021</span>


   <a href="/doc/html/draft-ietf-oauth-access-token-jwt-00">draft-ietf-oauth-access-token-jwt-00</a>

   o  Initial draft to define a JWTt profile for OAuth 2.0 access
      tokens.

Author's Address

   Vittorio Bertocci
   Auth0

   Email: vittorio@auth0.com








































Bertocci                Expires November 26, 2021              [Page 22]
</pre>
</div>
</div>
</div>
<script>$(".visible-nojs").removeClass("visible-nojs");</script>
<script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
<script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>
</body>
</html>
