<!DOCTYPE html>
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html --><html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<title>
  
    draft-ietf-oauth-revocation-11
  
</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>
<!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.38.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.38.0/respond/dest/respond.min.js"></script>
    <![endif]-->
<link href="/feed/document-changes/draft-ietf-oauth-revocation/" rel="alternate" title="Document changes" type="application/atom+xml"/>
<meta content="OAuth 2.0 Token Revocation (Internet-Draft, 2013)" name="description"/>
<script src="https://www.ietf.org/lib/dt/7.38.0/d3/d3.min.js"></script>
<script src="https://www.ietf.org/lib/dt/7.38.0/jquery/jquery.min.js"></script>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/ietf-icon-blue3.png" rel="shortcut icon"/>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/apple-touch-icon.png" rel="apple-touch-icon"/>
</head>
<body style="padding-top: 0;">
<div class="content" id="content">
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
<div class="rfcmarkup">
<div class="noprint" style="height: 6px;">
<div class="meta-info bgred" onclick="showLegend();" onmouseout="hideLegend()" onmouseover="this.style.cursor='pointer';" style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; " title="Click for colour legend."> </div>
<div class="meta-info noprint pre legend" id="legend" onmouseout="hideLegend();" onmouseover="showLegend();" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
</div>
</div>
<div class="noprint">
<pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-revocation-11.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-revocation-11.xml" title="XML source for this document">xml</a>|<a href="https://tools.ietf.org/pdf/draft-ietf-oauth-revocation-11.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/draft-ietf-oauth-revocation/11/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/draft-ietf-oauth-revocation/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/oauth/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-oauth-revocation@ietf.org?subject=draft-ietf-oauth-revocation" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-oauth-revocation-11.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-oauth-revocation-11.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-oauth-revocation-11.txt" title="Run an idnits check of this document">Nits</a>]

Versions: <a href="/doc/html/draft-ietf-oauth-revocation-00">00</a> <a href="/doc/html/draft-ietf-oauth-revocation-01">01</a> <a href="/doc/html/draft-ietf-oauth-revocation-02">02</a> <a href="/doc/html/draft-ietf-oauth-revocation-03">03</a> <a href="/doc/html/draft-ietf-oauth-revocation-04">04</a> <a href="/doc/html/draft-ietf-oauth-revocation-05">05</a> <a href="/doc/html/draft-ietf-oauth-revocation-06">06</a> <a href="/doc/html/draft-ietf-oauth-revocation-07">07</a> <a href="/doc/html/draft-ietf-oauth-revocation-08">08</a> <a href="/doc/html/draft-ietf-oauth-revocation-09">09</a> <a href="/doc/html/draft-ietf-oauth-revocation-10">10</a> <a href="/doc/html/draft-ietf-oauth-revocation-11"><b>11</b></a>            Standards Track
          <a href="/doc/html/rfc7009">rfc7009</a>                                                       </pre>
</div>
<div class="draftcontent">
<pre>OAuth Working Group                                  T. Lodderstedt, Ed.
Internet-Draft                                       Deutsche Telekom AG
Intended status: Standards Track                               S. Dronia
Expires: January 14, 2014
                                                            M. Scurtescu
                                                                  Google
                                                           July 13, 2013


                       <span class="h1">OAuth 2.0 Token Revocation</span>
                     <span class="h1">draft-ietf-oauth-revocation-11</span>

Abstract

   This document proposes an additional endpoint for OAuth authorization
   servers, which allows clients to notify the authorization server that
   a previously obtained refresh or access token is no longer needed.
   This allows the authorization server to cleanup security credentials.
   A revocation request will invalidate the actual token and, if
   applicable, other tokens based on the same authorization grant.

Requirements Language

   The key words "<em>MUST</em>", "<em>MUST NOT</em>", "<em>REQUIRED</em>", "<em>SHALL</em>", "<em>SHALL NOT</em>",
   "<em>SHOULD</em>", "<em>SHOULD NOT</em>", "<em>RECOMMENDED</em>", "<em>MAY</em>", and "<em>OPTIONAL</em>" in this
   document are to be interpreted as described in <a href="/doc/html/rfc2119">RFC 2119</a> [<a href="/doc/html/rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="/doc/html/bcp78">BCP 78</a> and <a href="/doc/html/bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on January 14, 2014.

Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.



<span class="grey">Lodderstedt, et al.     Expires January 14, 2014                [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey">Internet-Draft              Token Revocation                   July 2013</span>


   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Token Revocation  . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-2.1">2.1</a>.  Revocation Request  . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-2.2">2.2</a>.  Revocation Response . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
       <a href="#section-2.2.1">2.2.1</a>.  Error Response  . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-2.3">2.3</a>.  Cross-Origin Support  . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-3">3</a>.  Implementation Note . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-4">4</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-4.1">4.1</a>.  OAuth Extensions Error Registration . . . . . . . . . . .   <a href="#page-7">7</a>
       <a href="#section-4.1.1">4.1.1</a>.  The "unsupported_token_type" Error Value  . . . . . .   <a href="#page-7">7</a>
       <a href="#section-4.1.2">4.1.2</a>.  OAuth Token Type Hint Registry  . . . . . . . . . . .   <a href="#page-8">8</a>
         <a href="#section-4.1.2.1">4.1.2.1</a>.  Registration Template . . . . . . . . . . . . . .   <a href="#page-8">8</a>
         <a href="#section-4.1.2.2">4.1.2.2</a>.  Initial Registry Contents . . . . . . . . . . . .   <a href="#page-8">8</a>
   <a href="#section-5">5</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-6">6</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-7">7</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-7.1">7.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-7.2">7.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.%20%20Introduction"></a></body></html><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The OAuth 2.0 core specification [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>] defines several ways for a
   client to obtain refresh and access tokens.  This specification
   supplements the core specification with a mechanism to revoke both
   types of tokens.  A token is a string representing an authorization
   grant issued by the resource owner to the client.  A revocation
   request will invalidate the actual token and, if applicable, other
   tokens based on the same authorization grant and the authorization
   grant itself.

   From an end-user's perspective, OAuth is often used to log into a
   certain site or application.  This revocation mechanism allows a
   client to invalidate its tokens if the end-user logs out, changes
   identity, or uninstalls the respective application.  Notifying the
   authorization server that the token is no longer needed allows the



<span class="grey">Lodderstedt, et al.     Expires January 14, 2014                [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey">Internet-Draft              Token Revocation                   July 2013</span>


   authorization server to clean up data associated with that token
   (e.g. session data) and the underlying authorization grant.  This
   behavior prevents a situation where there is still a valid
   authorization grant for a particular client which the end user is not
   aware of.  This way, token revocation prevents abuse of abandoned
   tokens and facilitates a better end-user experience since invalidated
   authorization grants will no longer turn up in a list of
   authorization grants the authorization server might present to the
   end-user.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.%20%20Token%20Revocation"></a></body></html><a class="selflink" href="#section-2" id="section-2">2</a>.  Token Revocation</span>

   Implementations <em>MUST</em> support the revocation of refresh tokens and
   <em>SHOULD</em> support the revocation of access tokens (see Implementation
   Note).

   The client requests the revocation of a particular token by making an
   HTTP POST request to the token revocation endpoint URL.  This URL
   <em>MUST</em> conform to the rules given in <a href="/doc/html/rfc6749#section-3.1">[RFC6749], section 3.1</a>.  Clients
   <em>MUST</em> verify that the URL is an HTTPS URL.

   The means to obtain the location of the revocation endpoint is out of
   scope of this specification.  For example, the client developer may
   consult the server's documentation or automatic discovery may be
   used.  As this endpoint is handling security credentials, the
   endpoint location needs to be obtained from a trustworthy source.

   Since requests to the token revocation endpoint result in the
   transmission of plain text credentials in the HTTP request, URLs for
   token revocation endpoints <em>MUST</em> be HTTPS URLs.  The authorization
   server <em>MUST</em> use Transport Layer Security (TLS) in a version compliant
   with <a href="/doc/html/rfc6749#section-1.6">[RFC6749], section 1.6</a>.  Implementations <em>MAY</em> also support
   additional transport-layer security mechanisms that meet their
   security requirements.

   If the host of the token revocation endpoint can also be reached over
   HTTP, then the server <em>SHOULD</em> also offer a revocation service at the
   corresponding HTTP URI, but <em>MUST NOT</em> publish this URI as a token
   revocation endpoint.  This ensures that tokens accidentally sent over
   HTTP will be revoked.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.1.%20%20Revocation%20Request"></a></body></html><a class="selflink" href="#section-2.1" id="section-2.1">2.1</a>.  Revocation Request</span>

   The client constructs the request by including the following
   parameters using the "application/x-www-form-urlencoded" format in
   the HTTP request entity-body:

   token   <em>REQUIRED</em>.  The token that the client wants to get revoked.



<span class="grey">Lodderstedt, et al.     Expires January 14, 2014                [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey">Internet-Draft              Token Revocation                   July 2013</span>


   token_type_hint  <em>OPTIONAL</em>.  A hint about the type of the token
           submitted for revocation.  Clients <em>MAY</em> pass this parameter in
           order to help the authorization server to optimize the token
           lookup.  If the server is unable to locate the token using
           the given hint, it <em>MUST</em> extend its search accross all of its
           supported token types.  An authorization server <em>MAY</em> ignore
           this parameter, particularly if it is able to detect the
           token type automatically.  This specification defines two
           such values:

           *  access_token: An Access Token as defined in <a href="/doc/html/rfc6749#section-1.4">[RFC6749],
              section 1.4</a>

           *  refresh_token: A Refresh Token as defined in <a href="/doc/html/rfc6749#section-1.5">[RFC6749],
              section 1.5</a>

           Specific implementations, profiles, and extensions of this
           specification <em>MAY</em> define other values for this parameter
           using the registry defined in <a href="#section-4.1.2">Section 4.1.2</a>.

   The client also includes its authentication credentials as described
   in <a href="/doc/html/rfc6749#section-2.3">Section 2.3. of [RFC6749]</a>.

   For example, a client may request the revocation of a refresh token
   with the following request:

     POST /revoke HTTP/1.1
     Host: server.example.com
     Content-Type: application/x-www-form-urlencoded
     Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

     token=45ghiukldjahdnhzdauz&amp;token_type_hint=refresh_token


   The authorization server first validates the client credentials (in
   case of a confidential client) and then verifies whether the token
   was issued to the client making the revocation request.  If this
   validation fails, the request is refused and the client is informed
   of the error by the authorization server as described below.

   In the next step, the authorization server invalidates the token.
   The invalidation takes place immediately, and the token can not be
   used again after the revocation.  In practice there could be a
   propagation delay, for example, in which some servers know about the
   invalidation while others do not.  Implementations should minimize
   that window, and clients must not try to use the token after receipt
   of an HTTP 200 response from the server.




<span class="grey">Lodderstedt, et al.     Expires January 14, 2014                [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey">Internet-Draft              Token Revocation                   July 2013</span>


   Depending on the authorization server's revocation policy, the
   revocation of a particular token may cause the revocation of related
   tokens and the underlying authorization grant.  If the particular
   token is a refresh token and the authorization server supports the
   revocation of access tokens, then the authorization server <em>SHOULD</em>
   also invalidate all access tokens based on the same authorization
   grant (see Implementation Note).  If the token passed to the request
   is an access token, the server <em>MAY</em> revoke the respective refresh
   token as well.

   Note: A client compliant with [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>] must be prepared to handle
   unexpected token invalidation at any time.  Independent of the
   revocation mechanism specified in this document, resource owners may
   revoke authorization grants or the authorization server may
   invalidate tokens in order to mitigate security threats.  Thus having
   different server policies with respect to cascading the revocation of
   tokens should not pose interoperability problems.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.2.%20%20Revocation%20Response"></a></body></html><a class="selflink" href="#section-2.2" id="section-2.2">2.2</a>.  Revocation Response</span>

   The authorization server responds with HTTP status code 200 if the
   token has been revoked sucessfully or if the client submitted an
   invalid token.

   Note: invalid tokens do not cause an error response since the client
   cannot handle such an error in a reasonable way.  Moreover, the
   purpose of the revocation request, invalidating the particular token,
   is already achieved.

   The content of the response body is ignored by the client as all
   necessary information is conveyed in the response code.

   An invalid token type hint value is ignored by the authorization
   server and does not influence the revocation response.

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.2.1.%20%20Error%20Response"></a></body></html><a class="selflink" href="#section-2.2.1" id="section-2.2.1">2.2.1</a>.  Error Response</span>

   The error presentation conforms to the definition in <a href="/doc/html/rfc6749#section-5.2">section 5.2 of
   [RFC6749]</a>.  The following additional error code is defined for the
   token revocation endpoint:

   unsupported_token_type  The authorization server does not support the
           revocation of the presented token type.  I.e. the client
           tried to revoke an access token on a server not supporting
           this feature.

   If the server responds with HTTP status code 503, the client must
   assume the token still exists and may retry after a reasonable delay.



<span class="grey">Lodderstedt, et al.     Expires January 14, 2014                [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey">Internet-Draft              Token Revocation                   July 2013</span>


   The server may include a "Retry-After" header in the response to
   indicate how long the service is expected to be unavailable to the
   requesting client.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.3.%20%20Cross-Origin%20Support"></a></body></html><a class="selflink" href="#section-2.3" id="section-2.3">2.3</a>.  Cross-Origin Support</span>

   The revocation end-point <em>MAY</em> support CORS (Cross-Origin Resource
   Sharing) if it is aimed at use in combination with user-agent-based
   applications.

   In addition, for interoperability with legacy user-agents, it <em>MAY</em>
   also offer JSONP (Remote JSON - JSONP) by allowing GET requests with
   an additional parameter:

   callback  <em>OPTIONAL</em>.  The qualified name of a JavaScript function.

   For example, a client may request the revocation of an access token
   with the following request (line breaks are for display purposes
   only):

   https://example.com/revoke?token=agabcdefddddafdd&amp;
   callback=package.myCallback


   Successful response:

   package.myCallback();


   Error response:

   package.myCallback({"error":"unsupported_token_type"});


   Clients should be aware that when relying on JSONP, a malicious
   revocation end-point may attempt to inject malicious code into the
   client.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.%20%20Implementation%20Note"></a></body></html><a class="selflink" href="#section-3" id="section-3">3</a>.  Implementation Note</span>

   OAuth 2.0 allows deployment flexibility with respect to the style of
   access tokens.  The access tokens may be self-contained so that an
   resource server needs no further interaction with an authorization
   server issuing these tokens to perform an authorization decision of
   the client requesting access to a protected resource.  A system
   design may, however, instead use access tokens that are handles
   referring to authorization data stored at the authorization server.
   This consequently requires a resource server to issue a request to



<span class="grey">Lodderstedt, et al.     Expires January 14, 2014                [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey">Internet-Draft              Token Revocation                   July 2013</span>


   the respective authorization server to retrieve the content of the
   access token every time a client presents an access token.

   While these are not the only options they illustrate the implications
   for revocation.  In the latter case the authorization server is able
   to revoke an access token previously issued to a client when the
   resource server relays a received access token.  In the former case
   some (currently non-standardized) backend interaction between the
   authorization server and the resource server may be used when
   immediate access token revocation is desired.  Another design
   alternative is to issue short-lived access tokens, which can be
   refreshed at any time using the corresponding refresh tokens.  This
   allows the authorization server to impose a limit on the time revoked
   access tokens are in use.

   Which approach of token revocation is chosen will depend on the
   overall system design and on the application service provider's risk
   analysis.  The cost of revocation in terms of required state and
   communication overhead is ultimately the result of the desired
   security properties.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.%20%20IANA%20Considerations"></a></body></html><a class="selflink" href="#section-4" id="section-4">4</a>.  IANA Considerations</span>

   This specification registers an error value in the OAuth Extension
   Error registry and establishes the OAuth Token Type registry.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.1.%20%20OAuth%20Extensions%20Error%20Registration"></a></body></html><a class="selflink" href="#section-4.1" id="section-4.1">4.1</a>.  OAuth Extensions Error Registration</span>

   This specification registers the following error values in the OAuth
   Extensions Error registry defined in [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>].

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.1.1.%20%20The%20%22unsupported_token_type%22%20Error%20Value"></a></body></html><a class="selflink" href="#section-4.1.1" id="section-4.1.1">4.1.1</a>.  The "unsupported_token_type" Error Value</span>

   Error name  unsupported_token_type

   Error usage location  revocation endpoint error response

   Related protocol extension  Token Revocation Endpoint

   Change controller  IETF

   Specification document(s)  [this document]









<span class="grey">Lodderstedt, et al.     Expires January 14, 2014                [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey">Internet-Draft              Token Revocation                   July 2013</span>


<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.1.2.%20%20OAuth%20Token%20Type%20Hint%20Registry"></a></body></html><a class="selflink" href="#section-4.1.2" id="section-4.1.2">4.1.2</a>.  OAuth Token Type Hint Registry</span>

   This specification establishes the OAuth Token Type Hint registry.
   Possible values of the parameter "token_type_hint" (see <a href="#section-2.1">Section 2.1</a>)
   are registered with a Specification Required ([<a href="/doc/html/rfc5226" title="">RFC5226</a>]) after a two-
   week review period on the TBD@ietf.org mailing list, on the advice of
   one or more Designated Experts.  However, to allow for the allocation
   of values prior to publication, the Designated Expert(s) may approve
   registration once they are satisfied that such a specification will
   be published.  Registration requests must be sent to the TBD@ietf.org
   mailing list for review and comment, with an appropriate subject
   (e.g., "Request for parameter: example").  Within the review period,
   the Designated Expert(s) will either approve or deny the registration
   request, communicating this decision to the review list and IANA.
   Denials should include an explanation and, if applicable, suggestions
   as to how to make the request successful.  IANA must only accept
   registry updates from the Designated Expert(s) and should direct all
   requests for registration to the review mailing list.

<span class="h5"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.1.2.1.%20%20Registration%20Template"></a></body></html><a class="selflink" href="#section-4.1.2.1" id="section-4.1.2.1">4.1.2.1</a>.  Registration Template</span>

   Hint Value:  The additional value, which can be used to indicate a
      certain token type to the authorization server.

   Change controller:  For Standards Track RFCs, state "IETF".  For
      others, give the name of the responsible party.  Other details
      (e.g., postal address, email address, home page URI) may also be
      included.

   Specification document(s):  Reference to the document(s) that specify
      the type, preferably including a URI that can be used to retrieve
      a copy of the document(s).  An indication of the relevant sections
      may also be included but is not required.

<span class="h5"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.1.2.2.%20%20Initial%20Registry%20Contents"></a></body></html><a class="selflink" href="#section-4.1.2.2" id="section-4.1.2.2">4.1.2.2</a>.  Initial Registry Contents</span>

   The OAuth Token Type Hint registry's initial contents are:

   o  Hint Value: access_token

   o  Change controller: IETF

   o  Specification document(s): [this document]

   o  Hint Value: refresh_token

   o  Change controller: IETF




<span class="grey">Lodderstedt, et al.     Expires January 14, 2014                [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey">Internet-Draft              Token Revocation                   July 2013</span>


   o  Specification document(s): [this document]

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.%20%20Security%20Considerations"></a></body></html><a class="selflink" href="#section-5" id="section-5">5</a>.  Security Considerations</span>

   If the authorization server does not support access token revocation,
   access tokens will not be immediately invalidated when the
   corresponding refresh token is revoked.  Deployments must take this
   into account when conducting their security risk analysis.

   Cleaning up tokens using revocation contributes to overall security
   and privacy since it reduces the likelihood for abuse of abandoned
   tokens.  This specification in general does not intend to provide
   countermeasures against token theft and abuse.  For a discussion of
   respective threats and countermeasures, consult the security
   considerations given in <a href="#section-10">section 10</a> of the OAuth core specification
   [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>] and the OAuth threat model document [<a href="/doc/html/rfc6819" title='"OAuth 2.0 Threat Model and Security Considerations"'>RFC6819</a>].

   Malicious clients could attempt to use the new endpoint to launch
   denial of service attacks on the authorization server.  Appropriate
   countermeasures, which should be in place for the token endpoint as
   well, <em>MUST</em> be applied to the revocation endpoint (see <a href="/doc/html/rfc6819#section-4.4.1.11">[RFC6819],
   section 4.4.1.11</a>).  Specifically, invalid token type hints may
   misguide the authorization server and cause additional database
   lookups.  Care <em>MUST</em> be taken to prevent malicious clients from
   exploiting this feature to launch denial of service attacks.

   A malicious client may attempt to guess valid tokens on this endpoint
   by making revocation requests against potential token strings.
   According to this specification, a client's request must contain a
   valid client_id, in the case of a public client, or valid client
   credentials, in the case of a confidential client.  The token being
   revoked must also belong to the requesting client.  If an attacker is
   able to successfully guess a public client's client_id and one of
   their tokens, or a private client's credentials and one of their
   tokens, they could do much worse damage by using the token elsewhere
   than by revoking it.  If they chose to revoke the token, the
   legitimate client will lose its authorization grant and will need to
   prompt the user again.  No further damage is done and the guessed
   token is now worthless.

   Since the revocation endpoint is handling security credentials,
   clients need to obtain its location from a trustworthy source only.
   Otherwise, an attacker could capture valid security tokens by
   utilizing a counterfeit revocation endpoint.  Moreover in order to
   detect counterfeit revocation endpoints, clients <em>MUST</em> authenticate
   the revocation endpoint (certificate validation etc.).





<span class="grey">Lodderstedt, et al.     Expires January 14, 2014                [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey">Internet-Draft              Token Revocation                   July 2013</span>


<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.%20%20Acknowledgements"></a></body></html><a class="selflink" href="#section-6" id="section-6">6</a>.  Acknowledgements</span>

   We would like to thank Peter Mauritius, Amanda Anganes, Mark Wubben,
   Hannes Tschofenig, Michiel de Jong, Doug Foiles, Paul Madsen, George
   Fletcher, Sebastian Ebling, Christian Stuebner, Brian Campbell, Igor
   Faynberg, Lukas Rosenstock, and Justin Richer for their valuable
   feedback.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.%20%20References"></a></body></html><a class="selflink" href="#section-7" id="section-7">7</a>.  References</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.1.%20%20Normative%20References"></a></body></html><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2246">RFC2246</a>]  Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
              <a href="/doc/html/rfc2246">RFC 2246</a>, January 1999.

   [<a id="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="/doc/html/bcp26">BCP 26</a>, <a href="/doc/html/rfc5226">RFC 5226</a>,
              May 2008.

   [<a id="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="/doc/html/rfc5246">RFC 5246</a>, August 2008.

   [<a id="ref-RFC6749">RFC6749</a>]  Hardt, D., "The OAuth 2.0 Authorization Framework", <a href="/doc/html/rfc6749">RFC</a>
              <a href="/doc/html/rfc6749">6749</a>, October 2012.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.2.%20%20Informative%20References"></a></body></html><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-RFC6819">RFC6819</a>]  Lodderstedt, T., McGloin, M., and P. Hunt, "OAuth 2.0
              Threat Model and Security Considerations", <a href="/doc/html/rfc6819">RFC 6819</a>,
              January 2013.

   [<a id="ref-W3C.WD-cors-20120403">W3C.WD-cors-20120403</a>]
              Kesteren, A., "Cross-Origin Resource Sharing", World Wide
              Web Consortium LastCall WD-cors-20120403, April 2012,
              &lt;<a href="http://www.w3.org/TR/2012/WD-cors-20120403">http://www.w3.org/TR/2012/WD-cors-20120403</a>&gt;.

   [<a id="ref-jsonp">jsonp</a>]    Ippolito, B., "Remote JSON - JSONP", December 2005, &lt;http:
              //bob.pythonmac.org/archives/2005/12/05/remote-json-
              jsonp&gt;.









<span class="grey">Lodderstedt, et al.     Expires January 14, 2014               [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey">Internet-Draft              Token Revocation                   July 2013</span>


Authors' Addresses

   Torsten Lodderstedt (editor)
   Deutsche Telekom AG

   Email: torsten@lodderstedt.net


   Stefanie Dronia

   Email: sdronia@gmx.de


   Marius Scurtescu
   Google

   Email: mscurtescu@google.com


































Lodderstedt, et al.     Expires January 14, 2014               [Page 11]
</pre>
</div>
</div>
</div>
<script>$(".visible-nojs").removeClass("visible-nojs");</script>
<script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
<script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>
</body>
</html>
