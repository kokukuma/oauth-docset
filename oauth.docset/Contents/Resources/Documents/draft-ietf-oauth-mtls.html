<!DOCTYPE html>
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html --><html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<title>
  
    draft-ietf-oauth-mtls-17
  
</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>
<!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.38.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.38.0/respond/dest/respond.min.js"></script>
    <![endif]-->
<link href="/feed/document-changes/draft-ietf-oauth-mtls/" rel="alternate" title="Document changes" type="application/atom+xml"/>
<meta content="OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens (Internet-Draft, 2019)" name="description"/>
<script src="https://www.ietf.org/lib/dt/7.38.0/d3/d3.min.js"></script>
<script src="https://www.ietf.org/lib/dt/7.38.0/jquery/jquery.min.js"></script>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/ietf-icon-blue3.png" rel="shortcut icon"/>
<link href="https://www.ietf.org/lib/dt/7.38.0/ietf/images/apple-touch-icon.png" rel="apple-touch-icon"/>
</head>
<body style="padding-top: 0;">
<div class="content" id="content">
<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
<div class="rfcmarkup">
<div class="noprint" style="height: 6px;">
<div class="meta-info bgred" onclick="showLegend();" onmouseout="hideLegend()" onmouseover="this.style.cursor='pointer';" style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; " title="Click for colour legend."> </div>
<div class="meta-info noprint pre legend" id="legend" onmouseout="hideLegend();" onmouseover="showLegend();" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
</div>
</div>
<div class="noprint">
<pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-mtls-17.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-mtls-17.xml" title="XML source for this document">xml</a>|<a href="https://tools.ietf.org/pdf/draft-ietf-oauth-mtls-17.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/draft-ietf-oauth-mtls/17/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/draft-ietf-oauth-mtls/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/oauth/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-oauth-mtls@ietf.org?subject=draft-ietf-oauth-mtls" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-oauth-mtls-17.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-oauth-mtls-17.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-oauth-mtls-17.txt" title="Run an idnits check of this document">Nits</a>]

Versions: (<a href="/doc/html/draft-campbell-oauth-mtls">draft-campbell-oauth-mtls</a>)   <a href="/doc/html/draft-ietf-oauth-mtls-00">00</a> <a href="/doc/html/draft-ietf-oauth-mtls-01">01</a> <a href="/doc/html/draft-ietf-oauth-mtls-02">02</a>         Standards Track
          <a href="/doc/html/draft-ietf-oauth-mtls-03">03</a> <a href="/doc/html/draft-ietf-oauth-mtls-04">04</a> <a href="/doc/html/draft-ietf-oauth-mtls-05">05</a> <a href="/doc/html/draft-ietf-oauth-mtls-06">06</a> <a href="/doc/html/draft-ietf-oauth-mtls-07">07</a> <a href="/doc/html/draft-ietf-oauth-mtls-08">08</a> <a href="/doc/html/draft-ietf-oauth-mtls-09">09</a> <a href="/doc/html/draft-ietf-oauth-mtls-10">10</a> <a href="/doc/html/draft-ietf-oauth-mtls-11">11</a> <a href="/doc/html/draft-ietf-oauth-mtls-12">12</a> <a href="/doc/html/draft-ietf-oauth-mtls-13">13</a> <a href="/doc/html/draft-ietf-oauth-mtls-14">14</a> <a href="/doc/html/draft-ietf-oauth-mtls-15">15</a>                        
          <a href="/doc/html/draft-ietf-oauth-mtls-16">16</a> <a href="/doc/html/draft-ietf-oauth-mtls-17"><b>17</b></a> <a href="/doc/html/rfc8705">rfc8705</a>                                                 </pre>
</div>
<div class="draftcontent">
<pre>OAuth Working Group                                          B. Campbell
Internet-Draft                                             Ping Identity
Intended status: Standards Track                              J. Bradley
Expires: February 23, 2020                                        Yubico
                                                             N. Sakimura
                                               Nomura Research Institute
                                                          T. Lodderstedt
                                                              YES.com AG
                                                         August 22, 2019


    <span class="h1">OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound</span>
                             <span class="h1">Access Tokens</span>
                        <span class="h1">draft-ietf-oauth-mtls-17</span>

Abstract

   This document describes OAuth client authentication and certificate-
   bound access and refresh tokens using mutual Transport Layer Security
   (TLS) authentication with X.509 certificates.  OAuth clients are
   provided a mechanism for authentication to the authorization server
   using mutual TLS, based on either self-signed certificates or public
   key infrastructure (PKI).  OAuth authorization servers are provided a
   mechanism for binding access tokens to a client's mutual-TLS
   certificate, and OAuth protected resources are provided a method for
   ensuring that such an access token presented to it was issued to the
   client presenting the token.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="/doc/html/bcp78">BCP 78</a> and <a href="/doc/html/bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on February 23, 2020.







<span class="grey">Campbell, et al.        Expires February 23, 2020               [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


Copyright Notice

   Copyright (c) 2019 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Requirements Notation and Conventions . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-1.2">1.2</a>.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-2">2</a>.  Mutual TLS for OAuth Client Authentication  . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-2.1">2.1</a>.  PKI Mutual-TLS Method . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
       <a href="#section-2.1.1">2.1.1</a>.  PKI Method Metadata Value . . . . . . . . . . . . . .   <a href="#page-7">7</a>
       <a href="#section-2.1.2">2.1.2</a>.  Client Registration Metadata  . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-2.2">2.2</a>.  Self-Signed Certificate Mutual-TLS Method . . . . . . . .   <a href="#page-8">8</a>
       <a href="#section-2.2.1">2.2.1</a>.  Self-Signed Method Metadata Value . . . . . . . . . .   <a href="#page-8">8</a>
       <a href="#section-2.2.2">2.2.2</a>.  Client Registration Metadata  . . . . . . . . . . . .   <a href="#page-8">8</a>
   <a href="#section-3">3</a>.  Mutual-TLS Client Certificate-Bound Access Tokens . . . . . .   <a href="#page-9">9</a>
     <a href="#section-3.1">3.1</a>.  JWT Certificate Thumbprint Confirmation Method  . . . . .  <a href="#page-10">10</a>
     <a href="#section-3.2">3.2</a>.  Confirmation Method for Token Introspection . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-3.3">3.3</a>.  Authorization Server Metadata . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-3.4">3.4</a>.  Client Registration Metadata  . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#section-4">4</a>.  Public Clients and Certificate-Bound Tokens . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-5">5</a>.  Metadata for Mutual-TLS Endpoint Aliases  . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-6">6</a>.  Implementation Considerations . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
     <a href="#section-6.1">6.1</a>.  Authorization Server  . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
     <a href="#section-6.2">6.2</a>.  Resource Server . . . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
     <a href="#section-6.3">6.3</a>.  Certificate Expiration and Bound Access Tokens  . . . . .  <a href="#page-16">16</a>
     <a href="#section-6.4">6.4</a>.  Implicit Grant Unsupported  . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
     <a href="#section-6.5">6.5</a>.  TLS Termination . . . . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   <a href="#section-7">7</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
     <a href="#section-7.1">7.1</a>.  Certificate-Bound Refresh Tokens  . . . . . . . . . . . .  <a href="#page-17">17</a>
     <a href="#section-7.2">7.2</a>.  Certificate Thumbprint Binding  . . . . . . . . . . . . .  <a href="#page-17">17</a>
     <a href="#section-7.3">7.3</a>.  TLS Versions and Best Practices . . . . . . . . . . . . .  <a href="#page-18">18</a>
     <a href="#section-7.4">7.4</a>.  X.509 Certificate Spoofing  . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
     <a href="#section-7.5">7.5</a>.  X.509 Certificate Parsing and Validation Complexity . . .  <a href="#page-18">18</a>
   <a href="#section-8">8</a>.  Privacy Considerations  . . . . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>
   <a href="#section-9">9</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>



<span class="grey">Campbell, et al.        Expires February 23, 2020               [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


     <a href="#section-9.1">9.1</a>.  JWT Confirmation Methods Registration . . . . . . . . . .  <a href="#page-19">19</a>
     <a href="#section-9.2">9.2</a>.  Authorization Server Metadata Registration  . . . . . . .  <a href="#page-19">19</a>
     <a href="#section-9.3">9.3</a>.  Token Endpoint Authentication Method Registration . . . .  <a href="#page-20">20</a>
     <a href="#section-9.4">9.4</a>.  Token Introspection Response Registration . . . . . . . .  <a href="#page-20">20</a>
     <a href="#section-9.5">9.5</a>.  Dynamic Client Registration Metadata Registration . . . .  <a href="#page-21">21</a>
   <a href="#section-10">10</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-22">22</a>
     <a href="#section-10.1">10.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-22">22</a>
     <a href="#section-10.2">10.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-24">24</a>
   <a href="#appendix-A">Appendix A</a>.  Example "cnf" Claim, Certificate and JWK . . . . . .  <a href="#page-25">25</a>
   <a href="#appendix-B">Appendix B</a>.  Relationship to Token Binding  . . . . . . . . . . .  <a href="#page-26">26</a>
   <a href="#appendix-C">Appendix C</a>.  Acknowledgements . . . . . . . . . . . . . . . . . .  <a href="#page-26">26</a>
   <a href="#appendix-D">Appendix D</a>.  Document(s) History  . . . . . . . . . . . . . . . .  <a href="#page-27">27</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-31">31</a>

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.%20%20Introduction"></a></body></html><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   The OAuth 2.0 Authorization Framework [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>] enables third-party
   client applications to obtain delegated access to protected
   resources.  In the prototypical abstract OAuth flow, illustrated in
   Figure 1, the client obtains an access token from an entity known as
   an authorization server and then uses that token when accessing
   protected resources, such as HTTPS APIs.

     +--------+                                 +---------------+
     |        |                                 |               |
     |        |&lt;--(A)-- Get an access token ---&gt;| Authorization |
     |        |                                 |     Server    |
     |        |                                 |               |
     |        |                                 +---------------+
     |        |                                         ^
     |        |                                         |
     |        |
     |        |                               (C)       |
     | Client |                           Validate the
     |        |                           access token  |
     |        |
     |        |                                         |
     |        |                                         v
     |        |                                 +---------------+
     |        |                                 |      (C)      |
     |        |                                 |               |
     |        |&lt;--(B)-- Use the access token --&gt;|   Protected   |
     |        |                                 |    Resource   |
     |        |                                 |               |
     +--------+                                 +---------------+

                Figure 1: Abstract OAuth 2.0 Protocol Flow




<span class="grey">Campbell, et al.        Expires February 23, 2020               [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   The flow illustrated in Figure 1 includes the following steps:

   (A)  The client makes an HTTPS "POST" request to the authorization
        server and presents a credential representing the authorization
        grant.  For certain types of clients (those that have been
        issued or otherwise established a set of client credentials) the
        request must be authenticated.  In the response, the
        authorization server issues an access token to the client.

   (B)  The client includes the access token when making a request to
        access a protected resource.

   (C)  The protected resource validates the access token in order to
        authorize the request.  In some cases, such as when the token is
        self-contained and cryptographically secured, the validation can
        be done locally by the protected resource.  Other cases require
        that the protected resource call out to the authorization server
        to determine the state of the token and obtain meta-information
        about it.

   Layering on the abstract flow above, this document standardizes
   enhanced security options for OAuth 2.0 utilizing client-certificate-
   based mutual TLS.  <a href="#section-2">Section 2</a> provides options for authenticating the
   request in step (A).  Step (C) is supported with semantics to express
   the binding of the token to the client certificate for both local and
   remote processing in <a href="#section-3.1">Section 3.1</a> and <a href="#section-3.2">Section 3.2</a> respectively.  This
   ensures that, as described in <a href="#section-3">Section 3</a>, protected resource access in
   step (B) is only possible by the legitimate client using a
   certificate-bound token and holding the private key corresponding to
   the certificate.

   OAuth 2.0 defines a shared-secret method of client authentication but
   also allows for definition and use of additional client
   authentication mechanisms when interacting directly with the
   authorization server.  This document describes an additional
   mechanism of client authentication utilizing mutual-TLS certificate-
   based authentication, which provides better security characteristics
   than shared secrets.  While [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>] documents client authentication
   for requests to the token endpoint, extensions to OAuth 2.0 (such as
   Introspection [<a href="/doc/html/rfc7662" title='"OAuth 2.0 Token Introspection"'>RFC7662</a>], Revocation [<a href="/doc/html/rfc7009" title='"OAuth 2.0 Token Revocation"'>RFC7009</a>], and the Backchannel
   Authentication Endpoint in [<a href="#ref-OpenID.CIBA">OpenID.CIBA</a>]) define endpoints that also
   utilize client authentication and the mutual TLS methods defined
   herein are applicable to those endpoints as well.

   Mutual-TLS certificate-bound access tokens ensure that only the party
   in possession of the private key corresponding to the certificate can
   utilize the token to access the associated resources.  Such a
   constraint is sometimes referred to as key confirmation, proof-of-



<span class="grey">Campbell, et al.        Expires February 23, 2020               [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   possession, or holder-of-key and is unlike the case of the bearer
   token described in [<a href="/doc/html/rfc6750" title='"The OAuth 2.0 Authorization Framework: Bearer Token Usage"'>RFC6750</a>], where any party in possession of the
   access token can use it to access the associated resources.  Binding
   an access token to the client's certificate prevents the use of
   stolen access tokens or replay of access tokens by unauthorized
   parties.

   Mutual-TLS certificate-bound access tokens and mutual-TLS client
   authentication are distinct mechanisms, which are complementary but
   don't necessarily need to be deployed or used together.

   Additional client metadata parameters are introduced by this document
   in support of certificate-bound access tokens and mutual-TLS client
   authentication.  The authorization server can obtain client metadata
   via the Dynamic Client Registration Protocol [<a href="/doc/html/rfc7591" title='"OAuth 2.0 Dynamic Client Registration Protocol"'>RFC7591</a>], which defines
   mechanisms for dynamically registering OAuth 2.0 client metadata with
   authorization servers.  Also the metadata defined by <a href="/doc/html/rfc7591">RFC7591</a>, and
   registered extensions to it, imply a general data model for clients
   that is useful for authorization server implementations even when the
   Dynamic Client Registration Protocol isn't in play.  Such
   implementations will typically have some sort of user interface
   available for managing client configuration.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.1.%20%20Requirements%20Notation%20and%20Conventions"></a></body></html><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Requirements Notation and Conventions</span>

   The key words "<em>MUST</em>", "<em>MUST NOT</em>", "<em>REQUIRED</em>", "<em>SHALL</em>", "<em>SHALL NOT</em>",
   "<em>SHOULD</em>", "<em>SHOULD NOT</em>", "<em>RECOMMENDED</em>", "NOT <em>RECOMMENDED</em>", "<em>MAY</em>", and
   "<em>OPTIONAL</em>" in this document are to be interpreted as described in <a href="/doc/html/bcp14">BCP</a>
   <a href="/doc/html/bcp14">14</a> [<a href="/doc/html/rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] [<a href="/doc/html/rfc8174" title='"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"'>RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/1.2.%20%20Terminology"></a></body></html><a class="selflink" href="#section-1.2" id="section-1.2">1.2</a>.  Terminology</span>

   Throughout this document the term "mutual TLS" refers to the process
   whereby, in addition to the normal TLS server authentication with a
   certificate, a client presents its X.509 certificate and proves
   possession of the corresponding private key to a server when
   negotiating a TLS session.  In contemporary versions of TLS [<a href="/doc/html/rfc8446" title='"The Transport Layer Security (TLS) Protocol Version 1.3"'>RFC8446</a>]
   [<a href="/doc/html/rfc5246" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>] this requires that the client send the Certificate and
   CertificateVerify messages during the handshake and for the server to
   verify the CertificateVerify and Finished messages.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.%20%20Mutual%20TLS%20for%20OAuth%20Client%20Authentication"></a></body></html><a class="selflink" href="#section-2" id="section-2">2</a>.  Mutual TLS for OAuth Client Authentication</span>

   This section defines, as an extension of OAuth 2.0, <a href="/doc/html/rfc6749#section-2.3">Section 2.3
   [RFC6749]</a>, two distinct methods of using mutual-TLS X.509 client
   certificates as client credentials.  The requirement of mutual TLS
   for client authentication is determined by the authorization server



<span class="grey">Campbell, et al.        Expires February 23, 2020               [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   based on policy or configuration for the given client (regardless of
   whether the client was dynamically registered, statically configured,
   or otherwise established).

   In order to utilize TLS for OAuth client authentication, the TLS
   connection between the client and the authorization server <em>MUST</em> have
   been established or reestablished with mutual-TLS X.509 certificate
   authentication (i.e. the Client Certificate and Certificate Verify
   messages are sent during the TLS Handshake).

   For all requests to the authorization server utilizing mutual-TLS
   client authentication, the client <em>MUST</em> include the "client_id"
   parameter, described in OAuth 2.0, <a href="/doc/html/rfc6749#section-2.2">Section 2.2 [RFC6749]</a>.  The
   presence of the "client_id" parameter enables the authorization
   server to easily identify the client independently from the content
   of the certificate.  The authorization server can locate the client
   configuration using the client identifier and check the certificate
   presented in the TLS Handshake against the expected credentials for
   that client.  The authorization server <em>MUST</em> enforce the binding
   between client and certificate as described in either <a href="#section-2.1">Section 2.1</a> or
   <a href="#section-2.2">Section 2.2</a> below.  If no certificate is presented or that which is
   presented doesn't match that which is expected for the given
   "client_id", the authorization server returns a normal OAuth 2.0
   error response per <a href="/doc/html/rfc6749#section-5.2">Section 5.2 of RFC6749</a> [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>] with the
   "invalid_client" error code to indicate failed client authentication.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.1.%20%20PKI%20Mutual-TLS%20Method"></a></body></html><a class="selflink" href="#section-2.1" id="section-2.1">2.1</a>.  PKI Mutual-TLS Method</span>

   The PKI (public key infrastructure) method of mutual-TLS OAuth client
   authentication adheres to the way in which X.509 certificates are
   traditionally used for authentication.  It relies on a validated
   certificate chain [<a href="/doc/html/rfc5280" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>] and a single subject distinguished name
   (DN) or a single subject alternative name (SAN) to authenticate the
   client.  Only one subject name value of any type is used for each
   client.  The TLS handshake is utilized to validate the client's
   possession of the private key corresponding to the public key in the
   certificate and to validate the corresponding certificate chain.  The
   client is successfully authenticated if the subject information in
   the certificate matches the single expected subject configured or
   registered for that particular client (note that a predictable
   treatment of DN values, such as the distinguishedNameMatch rule from
   [<a href="/doc/html/rfc4517" title='"Lightweight Directory Access Protocol (LDAP): Syntaxes and Matching Rules"'>RFC4517</a>], is needed in comparing the certificate's subject DN to the
   client's registered DN).  Revocation checking is possible with the
   PKI method but if and how to check a certificate's revocation status
   is a deployment decision at the discretion of the authorization
   server.  Clients can rotate their X.509 certificates without the need
   to modify the respective authentication data at the authorization




<span class="grey">Campbell, et al.        Expires February 23, 2020               [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   server by obtaining a new certificate with the same subject from a
   trusted certificate authority (CA).

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.1.1.%20%20PKI%20Method%20Metadata%20Value"></a></body></html><a class="selflink" href="#section-2.1.1" id="section-2.1.1">2.1.1</a>.  PKI Method Metadata Value</span>

   For the PKI method of mutual-TLS client authentication, this
   specification defines and registers the following authentication
   method metadata value into the "OAuth Token Endpoint Authentication
   Methods" registry [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>].

   tls_client_auth
      Indicates that client authentication to the authorization server
      will occur with mutual TLS utilizing the PKI method of associating
      a certificate to a client.

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.1.2.%20%20Client%20Registration%20Metadata"></a></body></html><a class="selflink" href="#section-2.1.2" id="section-2.1.2">2.1.2</a>.  Client Registration Metadata</span>

   In order to convey the expected subject of the certificate, the
   following metadata parameters are introduced for the OAuth 2.0
   Dynamic Client Registration Protocol [<a href="/doc/html/rfc7591" title='"OAuth 2.0 Dynamic Client Registration Protocol"'>RFC7591</a>] in support of the PKI
   method of mutual-TLS client authentication.  A client using the
   "tls_client_auth" authentication method <em>MUST</em> use exactly one of the
   below metadata parameters to indicate the certificate subject value
   that the authorization server is to expect when authenticating the
   respective client.

   tls_client_auth_subject_dn
      An [<a href="/doc/html/rfc4514" title='"Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names"'>RFC4514</a>] string representation of the expected subject
      distinguished name of the certificate, which the OAuth client will
      use in mutual-TLS authentication.

   tls_client_auth_san_dns
      A string containing the value of an expected dNSName SAN entry in
      the certificate, which the OAuth client will use in mutual-TLS
      authentication.

   tls_client_auth_san_uri
      A string containing the value of an expected
      uniformResourceIdentifier SAN entry in the certificate, which the
      OAuth client will use in mutual-TLS authentication.

   tls_client_auth_san_ip
      A string representation of an IP address in either dotted decimal
      notation (for IPv4) or colon-delimited hexadecimal (for IPv6, as
      defined in [<a href="/doc/html/rfc5952" title='"A Recommendation for IPv6 Address Text Representation"'>RFC5952</a>]) that is expected to be present as an
      iPAddress SAN entry in the certificate, which the OAuth client
      will use in mutual-TLS authentication.  Per <a href="/doc/html/rfc5952#section-8">section 8 of [RFC5952]</a>




<span class="grey">Campbell, et al.        Expires February 23, 2020               [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


      the IP address comparison of the value in this parameter and the
      SAN entry in the certificate is to be done in binary format.

   tls_client_auth_san_email
      A string containing the value of an expected rfc822Name SAN entry
      in the certificate, which the OAuth client will use in mutual-TLS
      authentication.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.2.%20%20Self-Signed%20Certificate%20Mutual-TLS%20Method"></a></body></html><a class="selflink" href="#section-2.2" id="section-2.2">2.2</a>.  Self-Signed Certificate Mutual-TLS Method</span>

   This method of mutual-TLS OAuth client authentication is intended to
   support client authentication using self-signed certificates.  As a
   prerequisite, the client registers its X.509 certificates (using
   "jwks" defined in [<a href="/doc/html/rfc7591" title='"OAuth 2.0 Dynamic Client Registration Protocol"'>RFC7591</a>]) or a reference to a trusted source for
   its X.509 certificates (using "jwks_uri" from [<a href="/doc/html/rfc7591" title='"OAuth 2.0 Dynamic Client Registration Protocol"'>RFC7591</a>]) with the
   authorization server.  During authentication, TLS is utilized to
   validate the client's possession of the private key corresponding to
   the public key presented within the certificate in the respective TLS
   handshake.  In contrast to the PKI method, the client's certificate
   chain is not validated by the server in this case.  The client is
   successfully authenticated if the certificate that it presented
   during the handshake matches one of the certificates configured or
   registered for that particular client.  The Self-Signed Certificate
   method allows the use of mutual TLS to authenticate clients without
   the need to maintain a PKI.  When used in conjunction with a
   "jwks_uri" for the client, it also allows the client to rotate its
   X.509 certificates without the need to change its respective
   authentication data directly with the authorization server.

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.2.1.%20%20Self-Signed%20Method%20Metadata%20Value"></a></body></html><a class="selflink" href="#section-2.2.1" id="section-2.2.1">2.2.1</a>.  Self-Signed Method Metadata Value</span>

   For the Self-Signed Certificate method of mutual-TLS client
   authentication, this specification defines and registers the
   following authentication method metadata value into the "OAuth Token
   Endpoint Authentication Methods" registry [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>].

   self_signed_tls_client_auth
      Indicates that client authentication to the authorization server
      will occur using mutual TLS with the client utilizing a self-
      signed certificate.

<span class="h4"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/2.2.2.%20%20Client%20Registration%20Metadata"></a></body></html><a class="selflink" href="#section-2.2.2" id="section-2.2.2">2.2.2</a>.  Client Registration Metadata</span>

   For the Self-Signed Certificate method of binding a certificate with
   a client using mutual TLS client authentication, the existing
   "jwks_uri" or "jwks" metadata parameters from [<a href="/doc/html/rfc7591" title='"OAuth 2.0 Dynamic Client Registration Protocol"'>RFC7591</a>] are used to
   convey the client's certificates via JSON Web Key (JWK) in a JWK Set
   (JWKS) [<a href="/doc/html/rfc7517" title='"JSON Web Key (JWK)"'>RFC7517</a>].  The "jwks" metadata parameter is a JWK Set



<span class="grey">Campbell, et al.        Expires February 23, 2020               [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   containing the client's public keys as an array of JWKs while the
   "jwks_uri" parameter is a URL that references a client's JWK Set.  A
   certificate is represented with the "x5c" parameter of an individual
   JWK within the set.  Note that the members of the JWK representing
   the public key (e.g. "n" and "e" for RSA, "x" and "y" for EC) are
   required parameters per [<a href="/doc/html/rfc7518" title='"JSON Web Algorithms (JWA)"'>RFC7518</a>] so will be present even though they
   are not utilized in this context.  Also note that that <a href="/doc/html/rfc7517#section-4.7">Section 4.7 of
   [RFC7517]</a> requires that the key in the first certificate of the "x5c"
   parameter match the public key represented by those other members of
   the JWK.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.%20%20Mutual-TLS%20Client%20Certificate-Bound%20Access%20Tokens"></a></body></html><a class="selflink" href="#section-3" id="section-3">3</a>.  Mutual-TLS Client Certificate-Bound Access Tokens</span>

   When mutual TLS is used by the client on the connection to the token
   endpoint, the authorization server is able to bind the issued access
   token to the client certificate.  Such a binding is accomplished by
   associating the certificate with the token in a way that can be
   accessed by the protected resource, such as embedding the certificate
   hash in the issued access token directly, using the syntax described
   in <a href="#section-3.1">Section 3.1</a>, or through token introspection as described in
   <a href="#section-3.2">Section 3.2</a>.  Binding the access token to the client certificate in
   that fashion has the benefit of decoupling that binding from the
   client's authentication with the authorization server, which enables
   mutual TLS during protected resource access to serve purely as a
   proof-of-possession mechanism.  Other methods of associating a
   certificate with an access token are possible, per agreement by the
   authorization server and the protected resource, but are beyond the
   scope of this specification.

   In order for a resource server to use certificate-bound access
   tokens, it must have advance knowledge that mutual TLS is to be used
   for some or all resource accesses.  In particular, the access token
   itself cannot be used as input to the decision of whether or not to
   request mutual TLS, since from the TLS perspective those are
   "Application Data", only exchanged after the TLS handshake has been
   completed, and the initial CertificateRequest occurs during the
   handshake, before the Application Data is available.  Although
   subsequent opportunities for a TLS client to present a certificate
   may be available, e.g., via TLS 1.2 renegotiation [<a href="/doc/html/rfc5246" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>] or TLS
   1.3 post-handshake authentication [<a href="/doc/html/rfc8446" title='"The Transport Layer Security (TLS) Protocol Version 1.3"'>RFC8446</a>], this document makes no
   provision for their usage.  It is expected to be common that a
   mutual-TLS-using resource server will require mutual TLS for all
   resources hosted thereupon, or will serve mutual-TLS-protected and
   regular resources on separate hostname+port combinations, though
   other workflows are possible.  How resource server policy is
   synchronized with the AS is out of scope for this document.





<span class="grey">Campbell, et al.        Expires February 23, 2020               [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   Within the scope of an mutual-TLS-protected resource-access flow, the
   client makes protected resource requests as described in [<a href="/doc/html/rfc6750" title='"The OAuth 2.0 Authorization Framework: Bearer Token Usage"'>RFC6750</a>],
   however, those requests <em>MUST</em> be made over a mutually authenticated
   TLS connection using the same certificate that was used for mutual
   TLS at the token endpoint.

   The protected resource <em>MUST</em> obtain, from its TLS implementation
   layer, the client certificate used for mutual TLS and <em>MUST</em> verify
   that the certificate matches the certificate associated with the
   access token.  If they do not match, the resource access attempt <em>MUST</em>
   be rejected with an error per [<a href="/doc/html/rfc6750" title='"The OAuth 2.0 Authorization Framework: Bearer Token Usage"'>RFC6750</a>] using an HTTP 401 status code
   and the "invalid_token" error code.

   Metadata to convey server and client capabilities for mutual-TLS
   client certificate-bound access tokens is defined in <a href="#section-3.3">Section 3.3</a> and
   <a href="#section-3.4">Section 3.4</a> respectively.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.1.%20%20JWT%20Certificate%20Thumbprint%20Confirmation%20Method"></a></body></html><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  JWT Certificate Thumbprint Confirmation Method</span>

   When access tokens are represented as JSON Web Tokens (JWT)[<a href="/doc/html/rfc7519" title='"JSON Web Token (JWT)"'>RFC7519</a>],
   the certificate hash information <em>SHOULD</em> be represented using the
   "x5t#S256" confirmation method member defined herein.

   To represent the hash of a certificate in a JWT, this specification
   defines the new JWT Confirmation Method [<a href="/doc/html/rfc7800" title='"Proof-of- Possession Key Semantics for JSON Web Tokens (JWTs)"'>RFC7800</a>] member "x5t#S256"
   for the X.509 Certificate SHA-256 Thumbprint.  The value of the
   "x5t#S256" member is a base64url-encoded [<a href="/doc/html/rfc4648" title='"The Base16, Base32, and Base64 Data Encodings"'>RFC4648</a>] SHA-256 [<a href="#ref-SHS" title='"Secure Hash Standard (SHS)"'>SHS</a>] hash
   (a.k.a. thumbprint, fingerprint or digest) of the DER encoding [<a href="#ref-X690" title='"ASN.1 encoding rules: Specification of basic encoding Rules (BER), Canonical encoding rules (CER) and Distinguished encoding rules (DER)"'>X690</a>]
   of the X.509 certificate [<a href="/doc/html/rfc5280" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>].  The base64url-encoded value <em>MUST</em>
   omit all trailing pad '=' characters and <em>MUST NOT</em> include any line
   breaks, whitespace, or other additional characters.

   The following is an example of a JWT payload containing an "x5t#S256"
   certificate thumbprint confirmation method.  The new JWT content
   introduced by this specification is the "cnf" confirmation method
   claim at the bottom of the example that has the "x5t#S256"
   confirmation method member containing the value that is the hash of
   the client certificate to which the access token is bound.













<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


     {
       "iss": "https://server.example.com",
       "sub": "ty.webb@example.com",
       "exp": 1493726400,
       "nbf": 1493722800,
       "cnf":{
         "x5t#S256": "bwcK0esc3ACC3DB2Y5_lESsXE8o9ltc05O89jdN-dg2"
       }
     }

   Figure 2: Example JWT Claims Set with an X.509 Certificate Thumbprint
                            Confirmation Method

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.2.%20%20Confirmation%20Method%20for%20Token%20Introspection"></a></body></html><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  Confirmation Method for Token Introspection</span>

   OAuth 2.0 Token Introspection [<a href="/doc/html/rfc7662" title='"OAuth 2.0 Token Introspection"'>RFC7662</a>] defines a method for a
   protected resource to query an authorization server about the active
   state of an access token as well as to determine meta-information
   about the token.

   For a mutual-TLS client certificate-bound access token, the hash of
   the certificate to which the token is bound is conveyed to the
   protected resource as meta-information in a token introspection
   response.  The hash is conveyed using the same "cnf" with "x5t#S256"
   member structure as the certificate SHA-256 thumbprint confirmation
   method, described in <a href="#section-3.1">Section 3.1</a>, as a top-level member of the
   introspection response JSON.  The protected resource compares that
   certificate hash to a hash of the client certificate used for mutual-
   TLS authentication and rejects the request, if they do not match.

   The following is an example of an introspection response for an
   active token with an "x5t#S256" certificate thumbprint confirmation
   method.  The new introspection response content introduced by this
   specification is the "cnf" confirmation method at the bottom of the
   example that has the "x5t#S256" confirmation method member containing
   the value that is the hash of the client certificate to which the
   access token is bound.














<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


     HTTP/1.1 200 OK
     Content-Type: application/json

     {
       "active": true,
       "iss": "https://server.example.com",
       "sub": "ty.webb@example.com",
       "exp": 1493726400,
       "nbf": 1493722800,
       "cnf":{
         "x5t#S256": "bwcK0esc3ACC3DB2Y5_lESsXE8o9ltc05O89jdN-dg2"
       }
     }

     Figure 3: Example Introspection Response for a Certificate-Bound
                               Access Token

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.3.%20%20Authorization%20Server%20Metadata"></a></body></html><a class="selflink" href="#section-3.3" id="section-3.3">3.3</a>.  Authorization Server Metadata</span>

   This document introduces the following new authorization server
   metadata [<a href="/doc/html/rfc8414" title='"OAuth 2.0 Authorization Server Metadata"'>RFC8414</a>] parameter to signal the server's capability to
   issue certificate bound access tokens:

   tls_client_certificate_bound_access_tokens
      <em>OPTIONAL</em>.  Boolean value indicating server support for mutual-TLS
      client certificate-bound access tokens.  If omitted, the default
      value is "false".

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/3.4.%20%20Client%20Registration%20Metadata"></a></body></html><a class="selflink" href="#section-3.4" id="section-3.4">3.4</a>.  Client Registration Metadata</span>

   The following new client metadata parameter is introduced to convey
   the client's intention to use certificate bound access tokens:

   tls_client_certificate_bound_access_tokens
      <em>OPTIONAL</em>.  Boolean value used to indicate the client's intention
      to use mutual-TLS client certificate-bound access tokens.  If
      omitted, the default value is "false".

   Note that, if a client that has indicated the intention to use
   mutual-TLS client certificate-bound tokens makes a request to the
   token endpoint over a non-mutual-TLS connection, it is at the
   authorization server's discretion as to whether to return an error or
   issue an unbound token.








<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/4.%20%20Public%20Clients%20and%20Certificate-Bound%20Tokens"></a></body></html><a class="selflink" href="#section-4" id="section-4">4</a>.  Public Clients and Certificate-Bound Tokens</span>

   Mutual-TLS OAuth client authentication and certificate-bound access
   tokens can be used independently of each other.  Use of certificate-
   bound access tokens without mutual-TLS OAuth client authentication,
   for example, is possible in support of binding access tokens to a TLS
   client certificate for public clients (those without authentication
   credentials associated with the "client_id").  The authorization
   server would configure the TLS stack in the same manner as for the
   Self-Signed Certificate method such that it does not verify that the
   certificate presented by the client during the handshake is signed by
   a trusted CA.  Individual instances of a client would create a self-
   signed certificate for mutual TLS with both the authorization server
   and resource server.  The authorization server would not use the
   mutual-TLS certificate to authenticate the client at the OAuth layer
   but would bind the issued access token to that certificate, for which
   the client has proven possession of the corresponding private key.
   The access token is then bound to the certificate and can only be
   used by the client possessing the certificate and corresponding
   private key and utilizing them to negotiate mutual TLS on connections
   to the resource server.  When the authorization server issues a
   refresh token to such a client, it <em>SHOULD</em> also bind the refresh token
   to the respective certificate.  And check the binding when the
   refresh token is presented to get new access tokens.  The
   implementation details of the binding the refresh token are at the
   discretion of the authorization server.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/5.%20%20Metadata%20for%20Mutual-TLS%20Endpoint%20Aliases"></a></body></html><a class="selflink" href="#section-5" id="section-5">5</a>.  Metadata for Mutual-TLS Endpoint Aliases</span>

   The process of negotiating client certificate-based mutual TLS
   involves a TLS server requesting a certificate from the TLS client
   (the client does not provide one unsolicited).  Although a server can
   be configured such that client certificates are optional, meaning
   that the connection is allowed to continue when the client does not
   provide a certificate, the act of a server requesting a certificate
   can result in undesirable behavior from some clients.  This is
   particularly true of web browsers as TLS clients, which will
   typically present the end-user with an intrusive certificate
   selection interface when the server requests a certificate.

   Authorization servers supporting both clients using mutual TLS and
   conventional clients <em>MAY</em> chose to isolate the server side mutual-TLS
   behavior to only clients intending to do mutual TLS, thus avoiding
   any undesirable effects it might have on conventional clients.  The
   following authorization server metadata parameter is introduced to
   facilitate such separation:

   mtls_endpoint_aliases



<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


      <em>OPTIONAL</em>.  A JSON object containing alternative authorization
      server endpoints that, when present, an OAuth client intending to
      do mutual TLS uses in preference to the conventional endpoints.
      The parameter value itself consists of one or more endpoint
      parameters, such as "token_endpoint", "revocation_endpoint",
      "introspection_endpoint", etc., conventionally defined for the
      top-level of authorization server metadata.  An OAuth client
      intending to do mutual TLS (for OAuth client authentication and/or
      to acquire or use certificate-bound tokens) when making a request
      directly to the authorization server <em>MUST</em> use the alias URL of the
      endpoint within the "mtls_endpoint_aliases", when present, in
      preference to the endpoint URL of the same name at top-level of
      metadata.  When an endpoint is not present in
      "mtls_endpoint_aliases", then the client uses the conventional
      endpoint URL defined at the top-level of the authorization server
      metadata.  Metadata parameters within "mtls_endpoint_aliases" that
      do not define endpoints to which an OAuth client makes a direct
      request have no meaning and <em>SHOULD</em> be ignored.

   Below is an example of an authorization server metadata document with
   the "mtls_endpoint_aliases" parameter, which indicates aliases for
   the token, revocation, and introspection endpoints that an OAuth
   client intending to do mutual TLS would in preference to the
   conventional token, revocation, and introspection endpoints.  Note
   that the endpoints in "mtls_endpoint_aliases" use a different host
   than their conventional counterparts, which allows the authorization
   server (via TLS "server_name" extension [<a href="/doc/html/rfc6066" title='"Transport Layer Security (TLS) Extensions: Extension Definitions"'>RFC6066</a>] or actual distinct
   hosts) to differentiate its TLS behavior as appropriate.























<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   {
     "issuer": "https://server.example.com",
     "authorization_endpoint": "https://server.example.com/authz",
     "token_endpoint": "https://server.example.com/token",
     "introspection_endpoint": "https://server.example.com/introspect",
     "revocation_endpoint": "https://server.example.com/revo",
     "jwks_uri": "https://server.example.com/jwks",
     "response_types_supported": ["code"],
     "response_modes_supported": ["fragment","query","form_post"],
     "grant_types_supported": ["authorization_code", "refresh_token"],
     "token_endpoint_auth_methods_supported":
                     ["tls_client_auth","client_secret_basic","none"],
     "tls_client_certificate_bound_access_tokens": true
     "mtls_endpoint_aliases": {
       "token_endpoint": "https://mtls.example.com/token",
       "revocation_endpoint": "https://mtls.example.com/revo",
       "introspection_endpoint": "https://mtls.example.com/introspect"
     }
   }

      Figure 4: Example Authorization Server Metadata with Mutual-TLS
                             Endpoint Aliases

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.%20%20Implementation%20Considerations"></a></body></html><a class="selflink" href="#section-6" id="section-6">6</a>.  Implementation Considerations</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.1.%20%20Authorization%20Server"></a></body></html><a class="selflink" href="#section-6.1" id="section-6.1">6.1</a>.  Authorization Server</span>

   The authorization server needs to set up its TLS configuration
   appropriately for the OAuth client authentication methods it
   supports.

   An authorization server that supports mutual-TLS client
   authentication and other client authentication methods or public
   clients in parallel would make mutual TLS optional (i.e. allowing a
   handshake to continue after the server requests a client certificate
   but the client does not send one).

   In order to support the Self-Signed Certificate method alone, the
   authorization server would configure the TLS stack in such a way that
   it does not verify whether the certificate presented by the client
   during the handshake is signed by a trusted CA certificate.

   As described in <a href="#section-3">Section 3</a>, the authorization server binds the issued
   access token to the TLS client certificate, which means that it will
   only issue certificate-bound tokens for a certificate which the
   client has proven possession of the corresponding private key.





<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   The authorization server may also consider hosting the token
   endpoint, and other endpoints requiring client authentication, on a
   separate host name or port in order to prevent unintended impact on
   the TLS behavior of its other endpoints, e.g. the authorization
   endpoint.  As described in <a href="#section-5">Section 5</a>, it may further isolate any
   potential impact of the server requesting client certificates by
   offering a distinct set of endpoints on a separate host or port,
   which are aliases for the originals that a client intending to do
   mutual TLS will use in preference to the conventional endpoints.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.2.%20%20Resource%20Server"></a></body></html><a class="selflink" href="#section-6.2" id="section-6.2">6.2</a>.  Resource Server</span>

   OAuth divides the roles and responsibilities such that the resource
   server relies on the authorization server to perform client
   authentication and obtain resource owner (end-user) authorization.
   The resource server makes authorization decisions based on the access
   token presented by the client but does not directly authenticate the
   client per se.  The manner in which an access token is bound to the
   client certificate and how a protected resource verifies the proof-
   of-possession decouples that from the specific method that the client
   used to authenticate with the authorization server.  Mutual TLS
   during protected resource access can therefore serve purely as a
   proof-of-possession mechanism.  As such, it is not necessary for the
   resource server to validate the trust chain of the client's
   certificate in any of the methods defined in this document.  The
   resource server would therefore configure the TLS stack in a way that
   it does not verify whether the certificate presented by the client
   during the handshake is signed by a trusted CA certificate.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.3.%20%20Certificate%20Expiration%20and%20Bound%20Access%20Tokens"></a></body></html><a class="selflink" href="#section-6.3" id="section-6.3">6.3</a>.  Certificate Expiration and Bound Access Tokens</span>

   As described in <a href="#section-3">Section 3</a>, an access token is bound to a specific
   client certificate, which means that the same certificate must be
   used for mutual TLS on protected resource access.  It also implies
   that access tokens are invalidated when a client updates the
   certificate, which can be handled similar to expired access tokens
   where the client requests a new access token (typically with a
   refresh token) and retries the protected resource request.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.4.%20%20Implicit%20Grant%20Unsupported"></a></body></html><a class="selflink" href="#section-6.4" id="section-6.4">6.4</a>.  Implicit Grant Unsupported</span>

   This document describes binding an access token to the client
   certificate presented on the TLS connection from the client to the
   authorization server's token endpoint, however, such binding of
   access tokens issued directly from the authorization endpoint via the
   implicit grant flow is explicitly out of scope.  End users interact
   directly with the authorization endpoint using a web browser and the
   use of client certificates in user's browsers bring operational and



<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   usability issues, which make it undesirable to support certificate-
   bound access tokens issued in the implicit grant flow.
   Implementations wanting to employ certificate-bound access tokens
   should utilize grant types that involve the client making an access
   token request directly to the token endpoint (e.g. the authorization
   code and refresh token grant types).

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/6.5.%20%20TLS%20Termination"></a></body></html><a class="selflink" href="#section-6.5" id="section-6.5">6.5</a>.  TLS Termination</span>

   An authorization server or resource server <em>MAY</em> choose to terminate
   TLS connections at a load balancer, reverse proxy, or other network
   intermediary.  How the client certificate metadata is securely
   communicated between the intermediary and the application server in
   this case is out of scope of this specification.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.%20%20Security%20Considerations"></a></body></html><a class="selflink" href="#section-7" id="section-7">7</a>.  Security Considerations</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.1.%20%20Certificate-Bound%20Refresh%20Tokens"></a></body></html><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  Certificate-Bound Refresh Tokens</span>

   The OAuth 2.0 Authorization Framework [<a href="/doc/html/rfc6749" title='"The OAuth 2.0 Authorization Framework"'>RFC6749</a>] requires that an
   authorization server bind refresh tokens to the client to which they
   were issued and that confidential clients (those having established
   authentication credentials with the authorization server)
   authenticate to the AS when presenting a refresh token.  As a result,
   refresh tokens are indirectly certificate-bound by way of the client
   ID and the associated requirement for (certificate-based)
   authentication to the authorization server when issued to clients
   utilizing the "tls_client_auth" or "self_signed_tls_client_auth"
   methods of client authentication.  <a href="#section-4">Section 4</a> describes certificate-
   bound refresh tokens issued to public clients (those without
   authentication credentials associated with the "client_id").

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.2.%20%20Certificate%20Thumbprint%20Binding"></a></body></html><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  Certificate Thumbprint Binding</span>

   The binding between the certificate and access token specified in
   <a href="#section-3.1">Section 3.1</a> uses a cryptographic hash of the certificate.  It relies
   on the hash function having sufficient second-preimage resistance so
   as to make it computationally infeasible to find or create another
   certificate that produces to the same hash output value.  The SHA-256
   hash function was used because it meets the aforementioned
   requirement while being widely available.  If, in the future,
   certificate thumbprints need to be computed using hash function(s)
   other than SHA-256, it is suggested that additional related JWT
   confirmation methods members be defined for that purpose and
   registered in the IANA "JWT Confirmation Methods" registry
   [<a href="#ref-IANA.JWT.Claims">IANA.JWT.Claims</a>] for JWT "cnf" member values.





<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   Community knowledge about the strength of various algorithms and
   feasible attacks can change suddenly, and experience shows that a
   document about security is a point-in-time statement.  Readers are
   advised to seek out any errata or updates that apply to this
   document.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.3.%20%20TLS%20Versions%20and%20Best%20Practices"></a></body></html><a class="selflink" href="#section-7.3" id="section-7.3">7.3</a>.  TLS Versions and Best Practices</span>

   In the abstract this document is applicable with any TLS version
   supporting certificate-based client authentication.  Both TLS 1.3
   [<a href="/doc/html/rfc8446" title='"The Transport Layer Security (TLS) Protocol Version 1.3"'>RFC8446</a>] and TLS 1.2 [<a href="/doc/html/rfc5246" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>] are cited herein because, at the time
   of writing, 1.3 is the newest version while 1.2 is the most widely
   deployed.  General implementation and security considerations for
   TLS, including version recommendations, can be found in [<a href="#ref-BCP195" title='"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"'>BCP195</a>].

   TLS certificate validation (for both client and server certificates)
   requires a local database of trusted certificate authorities (CAs).
   Decisions about what CAs to trust and how to make such a
   determination of trust are out of scope for this document.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.4.%20%20X.509%20Certificate%20Spoofing"></a></body></html><a class="selflink" href="#section-7.4" id="section-7.4">7.4</a>.  X.509 Certificate Spoofing</span>

   If the PKI method of client authentication is used, an attacker could
   try to impersonate a client using a certificate with the same subject
   (DN or SAN) but issued by a different CA, which the authorization
   server trusts.  To cope with that threat, the authorization server
   <em>SHOULD</em> only accept as trust anchors a limited number of CAs whose
   certificate issuance policy meets its security requirements.  There
   is an assumption then that the client and server agree out of band on
   the set of trust anchors that the server uses to create and validate
   the certificate chain.  Without this assumption the use of a subject
   to identify the client certificate would open the server up to
   certificate spoofing attacks.

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/7.5.%20%20X.509%20Certificate%20Parsing%20and%20Validation%20Complexity"></a></body></html><a class="selflink" href="#section-7.5" id="section-7.5">7.5</a>.  X.509 Certificate Parsing and Validation Complexity</span>

   Parsing and validation of X.509 certificates and certificate chains
   is complex and implementation mistakes have previously exposed
   security vulnerabilities.  Complexities of validation include (but
   are not limited to) [<a href="#ref-CX5P" title='"Common x509 certificate validation/creation pitfalls"'>CX5P</a>] [<a href="#ref-DCW" title='"The Most Dangerous Code in the World: Validating SSL Certificates in Non-Browser Software"'>DCW</a>] [<a href="/doc/html/rfc5280" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>]:

   o  checking of Basic Constraints, basic and extended Key Usage
      constraints, validity periods, and critical extensions;

   o  handling of embedded NUL bytes in ASN.1 counted-length strings,
      and non-canonical or non-normalized string representations in
      subject names;




<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   o  handling of wildcard patterns in subject names;

   o  recursive verification of certificate chains and checking
      certificate revocation.

   For these reasons, implementors <em>SHOULD</em> use an established and well-
   tested X.509 library (such as one used by an established TLS library)
   for validation of X.509 certificate chains and <em>SHOULD NOT</em> attempt to
   write their own X.509 certificate validation procedures.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/8.%20%20Privacy%20Considerations"></a></body></html><a class="selflink" href="#section-8" id="section-8">8</a>.  Privacy Considerations</span>

   In TLS versions prior to 1.3, the client's certificate is sent
   unencrypted in the initial handshake and can potentially be used by
   third parties to monitor, track, and correlate client activity.  This
   is likely of little concern for clients that act on behalf of a
   significant number of end-users because individual user activity will
   not be discernible amidst the client activity as a whole.  However,
   clients that act on behalf of a single end-user, such as a native
   application on a mobile device, should use TLS version 1.3 whenever
   possible or consider the potential privacy implications of using
   mutual TLS on earlier versions.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.%20%20IANA%20Considerations"></a></body></html><a class="selflink" href="#section-9" id="section-9">9</a>.  IANA Considerations</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.1.%20%20JWT%20Confirmation%20Methods%20Registration"></a></body></html><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  JWT Confirmation Methods Registration</span>

   This specification requests registration of the following value in
   the IANA "JWT Confirmation Methods" registry [<a href="#ref-IANA.JWT.Claims">IANA.JWT.Claims</a>] for
   JWT "cnf" member values established by [<a href="/doc/html/rfc7800" title='"Proof-of- Possession Key Semantics for JSON Web Tokens (JWTs)"'>RFC7800</a>].

   o  Confirmation Method Value: "x5t#S256"
   o  Confirmation Method Description: X.509 Certificate SHA-256
      Thumbprint
   o  Change Controller: IESG
   o  Specification Document(s): <a href="#section-3.1">Section 3.1</a> of [[ this specification ]]

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.2.%20%20Authorization%20Server%20Metadata%20Registration"></a></body></html><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  Authorization Server Metadata Registration</span>

   This specification requests registration of the following values in
   the IANA "OAuth Authorization Server Metadata" registry
   [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>] established by [<a href="/doc/html/rfc8414" title='"OAuth 2.0 Authorization Server Metadata"'>RFC8414</a>].

   o  Metadata Name: "tls_client_certificate_bound_access_tokens"
   o  Metadata Description: Indicates authorization server support for
      mutual-TLS client certificate-bound access tokens.
   o  Change Controller: IESG
   o  Specification Document(s): <a href="#section-3.3">Section 3.3</a> of [[ this specification ]]



<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 19]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-20"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   o  Metadata Name: "mtls_endpoint_aliases"
   o  Metadata Description: JSON object containing alternative
      authorization server endpoints, which a client intending to do
      mutual TLS will use in preference to the conventional endpoints.
   o  Change Controller: IESG
   o  Specification Document(s): <a href="#section-5">Section 5</a> of [[ this specification ]]

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.3.%20%20Token%20Endpoint%20Authentication%20Method%20Registration"></a></body></html><a class="selflink" href="#section-9.3" id="section-9.3">9.3</a>.  Token Endpoint Authentication Method Registration</span>

   This specification requests registration of the following values in
   the IANA "OAuth Token Endpoint Authentication Methods" registry
   [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>] established by [<a href="/doc/html/rfc7591" title='"OAuth 2.0 Dynamic Client Registration Protocol"'>RFC7591</a>].

   o  Token Endpoint Authentication Method Name: "tls_client_auth"
   o  Change Controller: IESG
   o  Specification Document(s): <a href="#section-2.1.1">Section 2.1.1</a> of [[ this specification
      ]]

   o  Token Endpoint Authentication Method Name:
      "self_signed_tls_client_auth"
   o  Change Controller: IESG
   o  Specification Document(s): <a href="#section-2.2.1">Section 2.2.1</a> of [[ this specification
      ]]

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.4.%20%20Token%20Introspection%20Response%20Registration"></a></body></html><a class="selflink" href="#section-9.4" id="section-9.4">9.4</a>.  Token Introspection Response Registration</span>

   Proof-of-Possession Key Semantics for JSON Web Tokens [<a href="/doc/html/rfc7800" title='"Proof-of- Possession Key Semantics for JSON Web Tokens (JWTs)"'>RFC7800</a>]
   defined the "cnf" (confirmation) claim, which enables confirmation
   key information to be carried in a JWT.  However, the same proof-of-
   possession semantics are also useful for introspected access tokens
   whereby the protected resource obtains the confirmation key data as
   meta-information of a token introspection response and uses that
   information in verifying proof-of-possession.  Therefore this
   specification defines and registers proof-of-possession semantics for
   OAuth 2.0 Token Introspection [<a href="/doc/html/rfc7662" title='"OAuth 2.0 Token Introspection"'>RFC7662</a>] using the "cnf" structure.
   When included as a top-level member of an OAuth token introspection
   response, "cnf" has the same semantics and format as the claim of the
   same name defined in [<a href="/doc/html/rfc7800" title='"Proof-of- Possession Key Semantics for JSON Web Tokens (JWTs)"'>RFC7800</a>].  While this specification only
   explicitly uses the "x5t#S256" confirmation method member (see
   <a href="#section-3.2">Section 3.2</a>), it needs to define and register the higher level "cnf"
   structure as an introspection response member in order to define and
   use the more specific certificate thumbprint confirmation method.

   As such, this specification requests registration of the following
   value in the IANA "OAuth Token Introspection Response" registry
   [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>] established by [<a href="/doc/html/rfc7662" title='"OAuth 2.0 Token Introspection"'>RFC7662</a>].

   o  Claim Name: "cnf"



<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 20]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-21"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   o  Claim Description: Confirmation
   o  Change Controller: IESG
   o  Specification Document(s): [<a href="/doc/html/rfc7800" title='"Proof-of- Possession Key Semantics for JSON Web Tokens (JWTs)"'>RFC7800</a>] and [[ this specification ]]

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/9.5.%20%20Dynamic%20Client%20Registration%20Metadata%20Registration"></a></body></html><a class="selflink" href="#section-9.5" id="section-9.5">9.5</a>.  Dynamic Client Registration Metadata Registration</span>

   This specification requests registration of the following client
   metadata definitions in the IANA "OAuth Dynamic Client Registration
   Metadata" registry [<a href="#ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>] established by [<a href="/doc/html/rfc7591" title='"OAuth 2.0 Dynamic Client Registration Protocol"'>RFC7591</a>]:

   o  Client Metadata Name: "tls_client_certificate_bound_access_tokens"
   o  Client Metadata Description: Indicates the client's intention to
      use mutual-TLS client certificate-bound access tokens.
   o  Change Controller: IESG
   o  Specification Document(s): <a href="#section-3.4">Section 3.4</a> of [[ this specification ]]

   o  Client Metadata Name: "tls_client_auth_subject_dn"
   o  Client Metadata Description: String value specifying the expected
      subject DN of the client certificate.
   o  Change Controller: IESG
   o  Specification Document(s): <a href="#section-2.1.2">Section 2.1.2</a> of [[ this specification
      ]]

   o  Client Metadata Name: "tls_client_auth_san_dns"
   o  Client Metadata Description: String value specifying the expected
      dNSName SAN entry in the client certificate.
   o  Change Controller: IESG
   o  Specification Document(s): <a href="#section-2.1.2">Section 2.1.2</a> of [[ this specification
      ]]

   o  Client Metadata Name: "tls_client_auth_san_uri"
   o  Client Metadata Description: String value specifying the expected
      uniformResourceIdentifier SAN entry in the client certificate.
   o  Change Controller: IESG
   o  Specification Document(s): <a href="#section-2.1.2">Section 2.1.2</a> of [[ this specification
      ]]

   o  Client Metadata Name: "tls_client_auth_san_ip"
   o  Client Metadata Description: String value specifying the expected
      iPAddress SAN entry in the client certificate.
   o  Change Controller: IESG
   o  Specification Document(s): <a href="#section-2.1.2">Section 2.1.2</a> of [[ this specification
      ]]

   o  Client Metadata Name: "tls_client_auth_san_email"
   o  Client Metadata Description: String value specifying the expected
      rfc822Name SAN entry in the client certificate.
   o  Change Controller: IESG



<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 21]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-22"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   o  Specification Document(s): <a href="#section-2.1.2">Section 2.1.2</a> of [[ this specification
      ]]

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/10.%20%20References"></a></body></html><a class="selflink" href="#section-10" id="section-10">10</a>.  References</span>

<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/10.1.%20%20Normative%20References"></a></body></html><a class="selflink" href="#section-10.1" id="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-BCP195">BCP195</a>]   Sheffer, Y., Holz, R., and P. Saint-Andre,
              "Recommendations for Secure Use of Transport Layer
              Security (TLS) and Datagram Transport Layer Security
              (DTLS)", <a href="/doc/html/bcp195">BCP 195</a>, <a href="/doc/html/rfc7525">RFC 7525</a>, DOI 10.17487/RFC7525, May
              2015, &lt;<a href="http://www.rfc-editor.org/info/bcp195">http://www.rfc-editor.org/info/bcp195</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC4514">RFC4514</a>]  Zeilenga, K., Ed., "Lightweight Directory Access Protocol
              (LDAP): String Representation of Distinguished Names",
              <a href="/doc/html/rfc4514">RFC 4514</a>, DOI 10.17487/RFC4514, June 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4514">https://www.rfc-editor.org/info/rfc4514</a>&gt;.

   [<a id="ref-RFC4648">RFC4648</a>]  Josefsson, S., "The Base16, Base32, and Base64 Data
              Encodings", <a href="/doc/html/rfc4648">RFC 4648</a>, DOI 10.17487/RFC4648, October 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;.

   [<a id="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="/doc/html/rfc5246">RFC 5246</a>,
              DOI 10.17487/RFC5246, August 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;.

   [<a id="ref-RFC5280">RFC5280</a>]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", <a href="/doc/html/rfc5280">RFC 5280</a>, DOI 10.17487/RFC5280, May 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;.

   [<a id="ref-RFC6749">RFC6749</a>]  Hardt, D., Ed., "The OAuth 2.0 Authorization Framework",
              <a href="/doc/html/rfc6749">RFC 6749</a>, DOI 10.17487/RFC6749, October 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;.

   [<a id="ref-RFC6750">RFC6750</a>]  Jones, M. and D. Hardt, "The OAuth 2.0 Authorization
              Framework: Bearer Token Usage", <a href="/doc/html/rfc6750">RFC 6750</a>,
              DOI 10.17487/RFC6750, October 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6750">https://www.rfc-editor.org/info/rfc6750</a>&gt;.





<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 22]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-23"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   [<a id="ref-RFC7517">RFC7517</a>]  Jones, M., "JSON Web Key (JWK)", <a href="/doc/html/rfc7517">RFC 7517</a>,
              DOI 10.17487/RFC7517, May 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7517">https://www.rfc-editor.org/info/rfc7517</a>&gt;.

   [<a id="ref-RFC7519">RFC7519</a>]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
              (JWT)", <a href="/doc/html/rfc7519">RFC 7519</a>, DOI 10.17487/RFC7519, May 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;.

   [<a id="ref-RFC7591">RFC7591</a>]  Richer, J., Ed., Jones, M., Bradley, J., Machulak, M., and
              P. Hunt, "OAuth 2.0 Dynamic Client Registration Protocol",
              <a href="/doc/html/rfc7591">RFC 7591</a>, DOI 10.17487/RFC7591, July 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7591">https://www.rfc-editor.org/info/rfc7591</a>&gt;.

   [<a id="ref-RFC7662">RFC7662</a>]  Richer, J., Ed., "OAuth 2.0 Token Introspection",
              <a href="/doc/html/rfc7662">RFC 7662</a>, DOI 10.17487/RFC7662, October 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7662">https://www.rfc-editor.org/info/rfc7662</a>&gt;.

   [<a id="ref-RFC7800">RFC7800</a>]  Jones, M., Bradley, J., and H. Tschofenig, "Proof-of-
              Possession Key Semantics for JSON Web Tokens (JWTs)",
              <a href="/doc/html/rfc7800">RFC 7800</a>, DOI 10.17487/RFC7800, April 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7800">https://www.rfc-editor.org/info/rfc7800</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words", <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8414">RFC8414</a>]  Jones, M., Sakimura, N., and J. Bradley, "OAuth 2.0
              Authorization Server Metadata", <a href="/doc/html/rfc8414">RFC 8414</a>,
              DOI 10.17487/RFC8414, June 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;.

   [<a id="ref-RFC8446">RFC8446</a>]  Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", <a href="/doc/html/rfc8446">RFC 8446</a>, DOI 10.17487/RFC8446, August 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;.

   [<a id="ref-SHS">SHS</a>]      National Institute of Standards and Technology, "Secure
              Hash Standard (SHS)", FIPS PUB 180-4, March 2012,
              &lt;<a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf">http://csrc.nist.gov/publications/fips/fips180-4/</a>
              <a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf">fips-180-4.pdf</a>&gt;.

   [<a id="ref-X690">X690</a>]     International Telephone and Telegraph Consultative
              Committee, "ASN.1 encoding rules: Specification of basic
              encoding Rules (BER), Canonical encoding rules (CER) and
              Distinguished encoding rules (DER)", CCITT Recommendation
              X.690, July 2015.






<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 23]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-24"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


<span class="h3"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/10.2.%20%20Informative%20References"></a></body></html><a class="selflink" href="#section-10.2" id="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-CX5P">CX5P</a>]     Wong, D., "Common x509 certificate validation/creation
              pitfalls", September 2016,
              &lt;<a href="https://www.cryptologie.net/article/374/common-x509-certificate-validationcreation-pitfalls">https://www.cryptologie.net/article/374/</a>
              <a href="https://www.cryptologie.net/article/374/common-x509-certificate-validationcreation-pitfalls">common-x509-certificate-validationcreation-pitfalls</a>&gt;.

   [<a id="ref-DCW">DCW</a>]      Georgiev, M., Iyengar, S., Jana, S., Anubhai, R., Boneh,
              D., and V. Shmatikov, "The Most Dangerous Code in the
              World: Validating SSL Certificates in Non-Browser
              Software",
              &lt;<a href="http://www.cs.utexas.edu/~shmat/shmat_ccs12.pdf">http://www.cs.utexas.edu/~shmat/shmat_ccs12.pdf</a>&gt;.

   [<a id="ref-I-D.ietf-oauth-token-binding">I-D.ietf-oauth-token-binding</a>]
              Jones, M., Campbell, B., Bradley, J., and W. Denniss,
              "OAuth 2.0 Token Binding", <a href="/doc/html/draft-ietf-oauth-token-binding-06">draft-ietf-oauth-token-</a>
              <a href="/doc/html/draft-ietf-oauth-token-binding-06">binding-06</a> (work in progress), March 2018.

   [<a id="ref-IANA.JWT.Claims">IANA.JWT.Claims</a>]
              IANA, "JSON Web Token Claims",
              &lt;<a href="http://www.iana.org/assignments/jwt">http://www.iana.org/assignments/jwt</a>&gt;.

   [<a id="ref-IANA.OAuth.Parameters">IANA.OAuth.Parameters</a>]
              IANA, "OAuth Parameters",
              &lt;<a href="http://www.iana.org/assignments/oauth-parameters">http://www.iana.org/assignments/oauth-parameters</a>&gt;.

   [<a id="ref-OpenID.CIBA">OpenID.CIBA</a>]
              Fernandez, G., Walter, F., Nennker, A., Tonge, D., and B.
              Campbell, "OpenID Connect Client Initiated Backchannel
              Authentication Flow - Core 1.0", January 2019,
              &lt;<a href="https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html">https://openid.net/specs/openid-client-initiated-</a>
              <a href="https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html">backchannel-authentication-core-1_0.html</a>&gt;.

   [<a id="ref-RFC4517">RFC4517</a>]  Legg, S., Ed., "Lightweight Directory Access Protocol
              (LDAP): Syntaxes and Matching Rules", <a href="/doc/html/rfc4517">RFC 4517</a>,
              DOI 10.17487/RFC4517, June 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4517">https://www.rfc-editor.org/info/rfc4517</a>&gt;.

   [<a id="ref-RFC5952">RFC5952</a>]  Kawamura, S. and M. Kawashima, "A Recommendation for IPv6
              Address Text Representation", <a href="/doc/html/rfc5952">RFC 5952</a>,
              DOI 10.17487/RFC5952, August 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5952">https://www.rfc-editor.org/info/rfc5952</a>&gt;.

   [<a id="ref-RFC6066">RFC6066</a>]  Eastlake 3rd, D., "Transport Layer Security (TLS)
              Extensions: Extension Definitions", <a href="/doc/html/rfc6066">RFC 6066</a>,
              DOI 10.17487/RFC6066, January 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;.




<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 24]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-25"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   [<a id="ref-RFC7009">RFC7009</a>]  Lodderstedt, T., Ed., Dronia, S., and M. Scurtescu, "OAuth
              2.0 Token Revocation", <a href="/doc/html/rfc7009">RFC 7009</a>, DOI 10.17487/RFC7009,
              August 2013, &lt;<a href="https://www.rfc-editor.org/info/rfc7009">https://www.rfc-editor.org/info/rfc7009</a>&gt;.

   [<a id="ref-RFC7518">RFC7518</a>]  Jones, M., "JSON Web Algorithms (JWA)", <a href="/doc/html/rfc7518">RFC 7518</a>,
              DOI 10.17487/RFC7518, May 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/Appendix%20A.%20%20Example%20%22cnf%22%20Claim%2C%20Certificate%20and%20JWK"></a></body></html><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  Example "cnf" Claim, Certificate and JWK</span>

   For reference, an "x5t#S256" value and the X.509 Certificate from
   which it was calculated are provided in the following examples,
   Figure 5 and Figure 6 respectively.  A JWK representation of the
   certificate's public key along with the "x5c" member is also provided
   in Figure 7.

   "cnf":{"x5t#S256":"A4DtL2JmUMhAsvJj5tKyn64SqzmuXbMrJa0n761y5v0"}

                   Figure 5: x5t#S256 Confirmation Claim

   -----BEGIN CERTIFICATE-----
   MIIBBjCBrAIBAjAKBggqhkjOPQQDAjAPMQ0wCwYDVQQDDARtdGxzMB4XDTE4MTAx
   ODEyMzcwOVoXDTIyMDUwMjEyMzcwOVowDzENMAsGA1UEAwwEbXRsczBZMBMGByqG
   SM49AgEGCCqGSM49AwEHA0IABNcnyxwqV6hY8QnhxxzFQ03C7HKW9OylMbnQZjjJ
   /Au08/coZwxS7LfA4vOLS9WuneIXhbGGWvsDSb0tH6IxLm8wCgYIKoZIzj0EAwID
   SQAwRgIhAP0RC1E+vwJD/D1AGHGzuri+hlV/PpQEKTWUVeORWz83AiEA5x2eXZOV
   bUlJSGQgjwD5vaUaKlLR50Q2DmFfQj1L+SY=
   -----END CERTIFICATE-----

               Figure 6: PEM Encoded Self-Signed Certificate

   {
    "kty":"EC",
    "x":"1yfLHCpXqFjxCeHHHMVDTcLscpb07KUxudBmOMn8C7Q",
    "y":"8_coZwxS7LfA4vOLS9WuneIXhbGGWvsDSb0tH6IxLm8",
    "crv":"P-256",
    "x5c":[
     "MIIBBjCBrAIBAjAKBggqhkjOPQQDAjAPMQ0wCwYDVQQDDARtdGxzMB4XDTE4MTA
      xODEyMzcwOVoXDTIyMDUwMjEyMzcwOVowDzENMAsGA1UEAwwEbXRsczBZMBMGBy
      qGSM49AgEGCCqGSM49AwEHA0IABNcnyxwqV6hY8QnhxxzFQ03C7HKW9OylMbnQZ
      jjJ/Au08/coZwxS7LfA4vOLS9WuneIXhbGGWvsDSb0tH6IxLm8wCgYIKoZIzj0E
      AwIDSQAwRgIhAP0RC1E+vwJD/D1AGHGzuri+hlV/PpQEKTWUVeORWz83AiEA5x2
      eXZOVbUlJSGQgjwD5vaUaKlLR50Q2DmFfQj1L+SY="
      ]
    }

                          Figure 7: JSON Web Key




<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 25]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-26"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/Appendix%20B.%20%20Relationship%20to%20Token%20Binding"></a></body></html><a class="selflink" href="#appendix-B" id="appendix-B">Appendix B</a>.  Relationship to Token Binding</span>

   OAuth 2.0 Token Binding [<a href="#ref-I-D.ietf-oauth-token-binding">I-D.ietf-oauth-token-binding</a>] enables the
   application of Token Binding to the various artifacts and tokens
   employed throughout OAuth.  That includes binding of an access token
   to a Token Binding key, which bears some similarities in motivation
   and design to the mutual-TLS client certificate-bound access tokens
   defined in this document.  Both documents define what is often called
   a proof-of-possession security mechanism for access tokens, whereby a
   client must demonstrate possession of cryptographic keying material
   when accessing a protected resource.  The details differ somewhat
   between the two documents but both have the authorization server bind
   the access token that it issues to an asymmetric key pair held by the
   client.  The client then proves possession of the private key from
   that pair with respect to the TLS connection over which the protected
   resource is accessed.

   Token Binding uses bare keys that are generated on the client, which
   avoids many of the difficulties of creating, distributing, and
   managing certificates used in this specification.  However, at the
   time of writing, Token Binding is fairly new and there is relatively
   little support for it in available application development platforms
   and tooling.  Until better support for the underlying core Token
   Binding specifications exists, practical implementations of OAuth 2.0
   Token Binding are infeasible.  Mutual TLS, on the other hand, has
   been around for some time and enjoys widespread support in web
   servers and development platforms.  As a consequence, OAuth 2.0
   Mutual-TLS Client Authentication and Certificate-Bound Access Tokens
   can be built and deployed now using existing platforms and tools.  In
   the future, the two specifications are likely to be deployed in
   parallel for solving similar problems in different environments.
   Authorization servers may even support both specifications
   simultaneously using different proof-of-possession mechanisms for
   tokens issued to different clients.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/Appendix%20C.%20%20Acknowledgements"></a></body></html><a class="selflink" href="#appendix-C" id="appendix-C">Appendix C</a>.  Acknowledgements</span>

   Scott "not Tomlinson" Tomilson and Matt Peterson were involved in
   design and development work on a mutual-TLS OAuth client
   authentication implementation, which predates this document.
   Experience and learning from that work informed some of the content
   of this document.

   This specification was developed within the OAuth Working Group under
   the chairmanship of Hannes Tschofenig and Rifaat Shekh-Yusef with
   Eric Rescorla, Benjamin Kaduk, and Roman Danyliw serving as Security
   Area Directors.  Additionally, the following individuals contributed
   ideas, feedback, and wording that helped shape this specification:



<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 26]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-27"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   Vittorio Bertocci, Sergey Beryozkin, Ralph Bragg, Sophie Bremer,
   Roman Danyliw, Vladimir Dzhuvinov, Samuel Erdtman, Evan Gilman, Leif
   Johansson, Michael Jones, Phil Hunt, Benjamin Kaduk, Takahiko
   Kawasaki, Sean Leonard, Kepeng Li, Neil Madden, James Manger, Jim
   Manico, Nov Matake, Sascha Preibisch, Eric Rescorla, Justin Richer,
   Vincent Roca, Filip Skokan, Dave Tonge, and Hannes Tschofenig.

<span class="h2"><html><body><a class="dashAnchor" name="//apple_ref/cpp/Shortcut/Appendix%20D.%20%20Document%28s%29%20History"></a></body></html><a class="selflink" href="#appendix-D" id="appendix-D">Appendix D</a>.  Document(s) History</span>

   [[ to be removed by the RFC Editor before publication as an RFC ]]

   <a href="/doc/html/draft-ietf-oauth-mtls-17">draft-ietf-oauth-mtls-17</a>

   o  Updates from IESG ballot position comments.

   <a href="/doc/html/draft-ietf-oauth-mtls-16">draft-ietf-oauth-mtls-16</a>

   o  Editorial updates from last call review.

   <a href="/doc/html/draft-ietf-oauth-mtls-15">draft-ietf-oauth-mtls-15</a>

   o  Editorial updates from second AD review.

   <a href="/doc/html/draft-ietf-oauth-mtls-14">draft-ietf-oauth-mtls-14</a>

   o  Editorial clarifications around there being only a single subject
      registered/configured per client for the tls_client_auth method.
   o  Add a brief explanation about how, with tls_client_auth and
      self_signed_tls_client_auth, refresh tokens are certificate-bound
      indirectly via the client authentication.
   o  Add mention of refresh tokens in the abstract.

   <a href="/doc/html/draft-ietf-oauth-mtls-13">draft-ietf-oauth-mtls-13</a>

   o  Add an abstract protocol flow and diagram to serve as an overview
      of OAuth in general and baseline to describe the various ways in
      which the mechanisms defined herein are intended to be used.
   o  A little bit less of that German influence.
   o  Rework the TLS references a bit and, in the Terminology section,
      clean up the description of what messages are sent and verified in
      the handshake to do 'mutual TLS'.
   o  Move the explanation about "cnf" introspection registration into
      the IANA Considerations.
   o  Add CIBA as an informational reference and additional example of
      an OAuth extension that defines an endpoint that utilizes client
      authentication.
   o  Shorten a few of the section titles.




<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 27]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-28"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   o  Add new client metadata values to allow for the use of a SAN in
      the PKI MTLS client authentication method.
   o  Add privacy considerations attempting to discuss the implications
      of the client cert being sent in the clear in TLS 1.2.
   o  Changed the 'Certificate Bound Access Tokens Without Client
      Authentication' section to 'Public Clients and Certificate-Bound
      Tokens' and moved it up to be a top level section while adding
      discussion of binding refresh tokens for public clients.
   o  Reword/restructure the main PKI method section somewhat to
      (hopefully) improve readability.
   o  Reword/restructure the Self-Signed method section a bit to
      (hopefully) make it more comprehensible.
   o  Reword the AS and RS Implementation Considerations somewhat to
      (hopefully) improve readability.
   o  Clarify that the protected resource obtains the client certificate
      used for mutual TLS from its TLS implementation layer.
   o  Add Security Considerations section about the certificate
      thumbprint binding that includes the hash algorithm agility
      recommendation.
   o  Add an "mtls_endpoint_aliases" AS metadata parameter that is a
      JSON object containing alternative authorization server endpoints,
      which a client intending to do mutual TLS will use in preference
      to the conventional endpoints.
   o  Minor editorial updates.

   <a href="/doc/html/draft-ietf-oauth-mtls-12">draft-ietf-oauth-mtls-12</a>

   o  Add an example certificate, JWK, and confirmation method claim.
   o  Minor editorial updates based on implementer feedback.
   o  Additional Acknowledgements.

   <a href="/doc/html/draft-ietf-oauth-mtls-11">draft-ietf-oauth-mtls-11</a>

   o  Editorial updates.
   o  Mention/reference TLS 1.3 <a href="/doc/html/rfc8446">RFC8446</a> in the TLS Versions and Best
      Practices section.

   <a href="/doc/html/draft-ietf-oauth-mtls-10">draft-ietf-oauth-mtls-10</a>

   o  Update <a href="/doc/html/draft-ietf-oauth-discovery">draft-ietf-oauth-discovery</a> reference to <a href="/doc/html/rfc8414">RFC8414</a>

   <a href="/doc/html/draft-ietf-oauth-mtls-09">draft-ietf-oauth-mtls-09</a>

   o  Change "single certificates" to "self-signed certificates" in the
      Abstract

   <a href="/doc/html/draft-ietf-oauth-mtls-08">draft-ietf-oauth-mtls-08</a>




<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 28]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-29"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   o  Incorporate clarifications and editorial improvements from Justin
      Richer's WGLC review
   o  Drop the use of the "sender constrained" terminology per WGLC
      feedback from Neil Madden (including changing the metadata
      parameters from mutual_tls_sender_constrained_access_tokens to
      tls_client_certificate_bound_access_tokens)
   o  Add a new security considerations section on X.509 parsing and
      validation per WGLC feedback from Neil Madden and Benjamin Kaduk
   o  Note that a server can terminate TLS at a load balancer, reverse
      proxy, etc. but how the client certificate metadata is securely
      communicated to the backend is out of scope per WGLC feedback
   o  Note that revocation checking is at the discretion of the AS per
      WGLC feedback
   o  Editorial updates and clarifications
   o  Update <a href="/doc/html/draft-ietf-oauth-discovery">draft-ietf-oauth-discovery</a> reference to -10 and <a href="/doc/html/draft-ietf-oauth-token-binding">draft-ietf-</a>
      <a href="/doc/html/draft-ietf-oauth-token-binding">oauth-token-binding</a> to -06
   o  Add folks involved in WGLC feedback to the acknowledgements list

   <a href="/doc/html/draft-ietf-oauth-mtls-07">draft-ietf-oauth-mtls-07</a>

   o  Update to use the boilerplate from <a href="/doc/html/rfc8174">RFC 8174</a>

   <a href="/doc/html/draft-ietf-oauth-mtls-06">draft-ietf-oauth-mtls-06</a>

   o  Add an appendix section describing the relationship of this
      document to OAuth Token Binding as requested during the Singapore
      meeting <a href="https://datatracker.ietf.org/doc/minutes-100-oauth/">https://datatracker.ietf.org/doc/minutes-100-oauth/</a>
   o  Add an explicit note that the implicit flow is not supported for
      obtaining certificate bound access tokens as discussed at the
      Singapore meeting <a href="https://datatracker.ietf.org/doc/minutes-100-oauth/">https://datatracker.ietf.org/doc/minutes-</a>
      <a href="https://datatracker.ietf.org/doc/minutes-100-oauth/">100-oauth/</a>
   o  Add/incorporate text to the Security Considerations on Certificate
      Spoofing as suggested <a href="https://mailarchive.ietf.org/arch/msg/oauth/V26070X-6OtbVSeUz_7W2k94vCo">https://mailarchive.ietf.org/arch/msg/oauth/</a>
      <a href="https://mailarchive.ietf.org/arch/msg/oauth/V26070X-6OtbVSeUz_7W2k94vCo">V26070X-6OtbVSeUz_7W2k94vCo</a>
   o  Changed the title to be more descriptive
   o  Move the Security Considerations section to before the IANA
      Considerations
   o  Elaborated on certificate-bound access tokens a bit more in the
      Abstract
   o  Update <a href="/doc/html/draft-ietf-oauth-discovery">draft-ietf-oauth-discovery</a> reference to -08

   <a href="/doc/html/draft-ietf-oauth-mtls-05">draft-ietf-oauth-mtls-05</a>

   o  Editorial fixes

   <a href="/doc/html/draft-ietf-oauth-mtls-04">draft-ietf-oauth-mtls-04</a>





<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 29]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-30"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   o  Change the name of the 'Public Key method' to the more accurate
      'Self-Signed Certificate method' and also change the associated
      authentication method metadata value to
      "self_signed_tls_client_auth".
   o  Removed the "tls_client_auth_root_dn" client metadata field as
      discussed in <a href="https://mailarchive.ietf.org/arch/msg/oauth/swDV2y0be6o8czGKQi1eJV-g8qc">https://mailarchive.ietf.org/arch/msg/oauth/</a>
      <a href="https://mailarchive.ietf.org/arch/msg/oauth/swDV2y0be6o8czGKQi1eJV-g8qc">swDV2y0be6o8czGKQi1eJV-g8qc</a>
   o  Update <a href="/doc/html/draft-ietf-oauth-discovery">draft-ietf-oauth-discovery</a> reference to -07
   o  Clarify that MTLS client authentication isn't exclusive to the
      token endpoint and can be used with other endpoints, e.g.  <a href="/doc/html/rfc7009">RFC</a>
      <a href="/doc/html/rfc7009">7009</a> revocation and 7662 introspection, that utilize client
      authentication as discussed in
      <a href="https://mailarchive.ietf.org/arch/msg/oauth/bZ6mft0G7D3ccebhOxnEYUv4puI">https://mailarchive.ietf.org/arch/msg/oauth/</a>
      <a href="https://mailarchive.ietf.org/arch/msg/oauth/bZ6mft0G7D3ccebhOxnEYUv4puI">bZ6mft0G7D3ccebhOxnEYUv4puI</a>
   o  Reorganize the document somewhat in an attempt to more clearly
      make a distinction between mTLS client authentication and
      certificate-bound access tokens as well as a more clear
      delineation between the two (PKI/Public key) methods for client
      authentication
   o  Editorial fixes and clarifications

   <a href="/doc/html/draft-ietf-oauth-mtls-03">draft-ietf-oauth-mtls-03</a>

   o  Introduced metadata and client registration parameter to publish
      and request support for mutual TLS sender constrained access
      tokens
   o  Added description of two methods of binding the cert and client,
      PKI and Public Key.
   o  Indicated that the "tls_client_auth" authentication method is for
      the PKI method and introduced "pub_key_tls_client_auth" for the
      Public Key method
   o  Added implementation considerations, mainly regarding TLS stack
      configuration and trust chain validation, as well as how to to do
      binding of access tokens to a TLS client certificate for public
      clients, and considerations around certificate-bound access tokens
   o  Added new section to security considerations on cert spoofing
   o  Add text suggesting that a new cnf member be defined in the
      future, if hash function(s) other than SHA-256 need to be used for
      certificate thumbprints

   <a href="/doc/html/draft-ietf-oauth-mtls-02">draft-ietf-oauth-mtls-02</a>

   o  Fixed editorial issue <a href="https://mailarchive.ietf.org/arch/msg/oauth/U46UMEh8XIOQnvXY9pHFq1MKPns">https://mailarchive.ietf.org/arch/msg/oauth/</a>
      <a href="https://mailarchive.ietf.org/arch/msg/oauth/U46UMEh8XIOQnvXY9pHFq1MKPns">U46UMEh8XIOQnvXY9pHFq1MKPns</a>
   o  Changed the title (hopefully "Mutual TLS Profile for OAuth 2.0" is
      better than "Mutual TLS Profiles for OAuth Clients").

   <a href="/doc/html/draft-ietf-oauth-mtls-01">draft-ietf-oauth-mtls-01</a>



<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 30]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-31"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   o  Added more explicit details of using <a href="/doc/html/rfc7662">RFC 7662</a> token introspection
      with mutual TLS sender constrained access tokens.
   o  Added an IANA OAuth Token Introspection Response Registration
      request for "cnf".
   o  Specify that tls_client_auth_subject_dn and
      tls_client_auth_root_dn are <a href="/doc/html/rfc4514">RFC 4514</a> String Representation of
      Distinguished Names.
   o  Changed tls_client_auth_issuer_dn to tls_client_auth_root_dn.
   o  Changed the text in the <a href="#section-3">Section 3</a> to not be specific about using a
      hash of the cert.
   o  Changed the abbreviated title to 'OAuth Mutual TLS' (previously
      was the acronym MTLSPOC).

   <a href="/doc/html/draft-ietf-oauth-mtls-00">draft-ietf-oauth-mtls-00</a>

   o  Created the initial working group version from <a href="/doc/html/draft-campbell-oauth-mtls">draft-campbell-</a>
      <a href="/doc/html/draft-campbell-oauth-mtls">oauth-mtls</a>

   <a href="/doc/html/draft-campbell-oauth-mtls-01">draft-campbell-oauth-mtls-01</a>

   o  Fix some typos.
   o  Add to the acknowledgements list.

   <a href="/doc/html/draft-campbell-oauth-mtls-00">draft-campbell-oauth-mtls-00</a>

   o  Add a Mutual TLS sender constrained protected resource access
      method and a x5t#S256 cnf method for JWT access tokens (concepts
      taken in part from <a href="/doc/html/draft-sakimura-oauth-jpop-04">draft-sakimura-oauth-jpop-04</a>).
   o  Fixed "token_endpoint_auth_methods_supported" to
      "token_endpoint_auth_method" for client metadata.
   o  Add "tls_client_auth_subject_dn" and "tls_client_auth_issuer_dn"
      client metadata parameters and mention using "jwks_uri" or "jwks".
   o  Say that the authentication method is determined by client policy
      regardless of whether the client was dynamically registered or
      statically configured.
   o  Expand acknowledgements to those that participated in discussions
      around <a href="/doc/html/draft-campbell-oauth-tls-client-auth-00">draft-campbell-oauth-tls-client-auth-00</a>
   o  Add Nat Sakimura and Torsten Lodderstedt to the author list.

   <a href="/doc/html/draft-campbell-oauth-tls-client-auth-00">draft-campbell-oauth-tls-client-auth-00</a>

   o  Initial draft.

Authors' Addresses







<span class="grey">Campbell, et al.        Expires February 23, 2020              [Page 31]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-32"></span>
<span class="grey">Internet-Draft              OAuth Mutual TLS                 August 2019</span>


   Brian Campbell
   Ping Identity

   Email: brian.d.campbell@gmail.com


   John Bradley
   Yubico

   Email: ve7jtb@ve7jtb.com
   URI:   <a href="http://www.thread-safe.com/">http://www.thread-safe.com/</a>


   Nat Sakimura
   Nomura Research Institute

   Email: n-sakimura@nri.co.jp
   URI:   <a href="https://nat.sakimura.org/">https://nat.sakimura.org/</a>


   Torsten Lodderstedt
   YES.com AG

   Email: torsten@lodderstedt.net



























Campbell, et al.        Expires February 23, 2020              [Page 32]
</pre>
</div>
</div>
</div>
<script>$(".visible-nojs").removeClass("visible-nojs");</script>
<script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
<script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>
</body>
</html>
